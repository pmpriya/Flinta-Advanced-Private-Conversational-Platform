<style>
  @-moz-document url-prefix() {
    .fireboxweb {
      overflow: hidden !important;
    }
  }
</style>

<ion-router-outlet id="main"></ion-router-outlet>

<ion-menu side="end" menuId="first" contentId="main">
  <ion-header>
    <!-- <ion-toolbar color="primary">
      <ion-title>{{groupname}}</ion-title>
    </ion-toolbar> -->
    <ion-toolbar>
      <ion-title>
        <ion-title style="">{{groupname}}</ion-title>
      </ion-title>
      <ion-buttons slot="end">
        <ion-button (click)="closeModal()">
          <ion-icon slot="icon-only" style="color:#fff" title="Close" name="close"></ion-icon>
        </ion-button>
      </ion-buttons>


    </ion-toolbar>

  </ion-header>
  <ion-content>
    <div *ngIf="groupImage!=undefined" class="profile-image" style="text-align: center;margin-top: 10px;">
      <img [src]="sanitizer.bypassSecurityTrustUrl(groupImage)" *ngIf="groupImage!='default'" class="webprofile"
        (click)="updateImage(groupImage)">
      <img src="assets/imgs/groupIcon.png" *ngIf="groupImage=='default'" class="webprofile"
        (click)="updateImage(groupImage)">
      <input type="file" id="filedata1" onclick="this.value=null;" style="display: none"
        (change)="onUploadChange2($event)" *ngIf="!mobileicon" accept=".png, .jpg, .jpeg" />

    </div>


    <div style="display: flex;">

      <br />
      <span style="width: 250px;min-height:38px;font-size: 17px;font-weight: bold;text-align:center;"
        (click)="changeGroupName()">{{groupname}} </span>&nbsp;&nbsp;
      <ion-icon name="create" style="font-size: 25px;" (click)="changeGroupName()"></ion-icon>
    </div>
    <ion-list>
      <!-- <ion-item>
        <img *ngIf="groupImage!='default'" [src]="sanitizer.bypassSecurityTrustUrl(groupImage)" class="profileimage1">
        <img class="profileimage1" *ngIf="groupImage=='default'" src="assets/imgs/groupIcon.png">

      </ion-item> -->
      <ion-item *ngIf="owner" (click)="addMember()">
        <ion-icon name="person-add" [ngStyle]="{'color': colorCode}" class="ionicon"></ion-icon>
        <span class="menuslide">&nbsp;Add member </span>

      </ion-item>
      <ion-item (click)="showGroupMember()">
        <ion-icon name="person" [ngStyle]="{'color': colorCode}" class="ionicon"></ion-icon>

        <span class="menuslide">&nbsp;Group Members

        </span>
      </ion-item>
      <ion-item *ngIf="owner" (click)="deleteGroup()">
        <ion-icon name="trash" [ngStyle]="{'color': colorCode}" class="ionicon"></ion-icon>

        <span class="menuslide">&nbsp;Delete Group

        </span>
      </ion-item>

      <ion-item *ngIf="!owner" (click)="exitGroup()">
        <ion-icon name="log-out" [ngStyle]="{'color': colorCode}" class="ionicon"></ion-icon>

        <span class="menuslide">&nbsp;Exit Group

        </span>
      </ion-item>

    </ion-list>
  </ion-content>
</ion-menu>
<ion-menu side="end" menuId="second" contentId="main">
  <ion-header *ngIf="buddydetails!=undefined">
    <!-- <ion-toolbar>
      <ion-title style="text-transform: capitalize;">{{buddydetails.username}}</ion-title>

    </ion-toolbar> -->

    <ion-toolbar>
      <ion-title>
        <ion-title style="text-transform: capitalize;">{{buddydetails.username}}</ion-title>
      </ion-title>
      <ion-buttons slot="end">
        <ion-button (click)="closeModal1()">
          <ion-icon slot="icon-only" style="color: #fff;" title="Close" name="close"></ion-icon>
        </ion-button>
      </ion-buttons>
    </ion-toolbar>

  </ion-header>
  <ion-content *ngIf="buddydetails!=undefined">
    <ion-list style="font-size: 14px;">
      <ion-item><span style="color: #0c84b4;">Employee Code :</span>{{buddydetails.employee}}</ion-item>
      <ion-item><span style="color: #0c84b4;">Gender :</span>{{buddydetails.gender}}</ion-item>
    
      <ion-item><span style="color: #0c84b4;">Mobile :</span>{{buddydetails.mobile}}</ion-item>
      <ion-item><span style="color: #0c84b4;">Email :</span>{{buddydetails.email}}</ion-item>
      <ion-item><span style="color: #0c84b4;">Designation :</span>{{buddydetails.designation}}</ion-item>
      <ion-item><span style="color: #0c84b4;">Department :</span>{{buddydetails.department}}</ion-item>
      <!-- <ion-item> Block :{{buddydetails.department}}</ion-item> -->
      <ion-item>
        <ion-label><span style="color: #0c84b4;">Self Destruct :</span></ion-label>
        <ion-toggle [(ngModel)]="self_destruct"></ion-toggle>
      </ion-item>



      <!-- <ion-item>Menu Item</ion-item>
      <ion-item>Menu Item</ion-item>
      <ion-item>Menu Item</ion-item> -->
    </ion-list>
  </ion-content>
</ion-menu>
<!--  
 <ion-menu  id="authenticated" *ngIf="!grp && buddy!=undefined" side="right" [content]="mycontent">
 
   <div style="text-align:center;margin-top: 10px;">
     <img class="profileimage1" src="{{buddy.photoURL}}">
     <br />
     <p style="height:38px;font-size: 17px;font-weight: bold;text-align:center;">{{buddy.displayName}}</p>
 
   </div>
 
   <ion-item>
     <span style="width:120px;">Date of birth</span>
     {{buddy.DOB}}
   </ion-item>
 
   <ion-item>
     <span style="width:120px;">Gender</span>
     {{buddy.gender}}
   </ion-item>
   <ion-item>
     <span style="width:120px;">Phone number</span>
     {{buddy.mobilenumber}}
   </ion-item>
   <ion-item>
     <ion-label>Block this person</ion-label>
 
     <ion-toggle (ionChange)="blockperson()" [(ngModel)]="block"></ion-toggle>
 
 
   </ion-item>
   <ion-item>
     <ion-label>Self Destruct Message</ion-label>
 
     <ion-toggle (ionChange)="selfDestruction()" [(ngModel)]="selfdestruct"></ion-toggle>
 
   </ion-item>
   <ion-item  (click)="clearChathistory()">
     <ion-label>Clear chat history</ion-label>
 
   </ion-item>
 </ion-menu> -->

<ion-content padding (click)="dissmissPop()" [scrollEvents]="true" (ionScroll)="onScroll($event)">
  <div style="display:flex;    height: 100%;
  overflow: hidden;
  position: relative;
  top: 0;
  width: 100%;">
    <div *ngIf="buddies" class="leftcontact">
      <div class="leftside">
        <header class="leftheader" style="background-color: #eeeeee;" (click)="dissmissPop()">

          <div class="headimage">
            <div class="dbimage headimage" (click)="dissmissPop()">

              <ion-avatar item-left>
                <img (click)="myprofile()" class="profileimage" *ngIf="profileImg=='default'"
                  style="position: absolute;" src="assets/imgs/profile.png" />

                <img (click)="myprofile()" class="profileimage" *ngIf="profileImg!='default'"
                  style="position: absolute;" [src]="sanitizer.bypassSecurityTrustUrl(profileImg)">
              </ion-avatar>
              <ion-title text-left style="margin-left: 34px;margin-top: -25px;">
                <span (click)="myprofile()" class="devname"> {{UserName}}</span><br>
                <span (click)="myprofile()" class="desgname"> {{designation}}</span>
                <span style="width:160px;position:relative;top:10px">

                  <span class="chaticon" (click)="mainMenupopover($event,item);$event.stopPropagation()">
                    <ion-icon title="Menu" name="ellipsis-vertical-outline"></ion-icon>
                  </span>

                  <span class="chaticon1" (click)="allContacts()">
                    <ion-icon title="New Chat" name="person-outline"></ion-icon>
                  </span>

                  <span class="grpicon" (click)="gotoGroup()">
                    <ion-icon title="Groups" name="people-circle-outline"></ion-icon>
                  </span>
                </span>


              </ion-title>


            </div>

          </div>

          <!-- <ul *ngIf="showdraghome=='true'" class="list listdata">
            <li (click)="aboutus()" class="item dropitem">
              <img src="assets/imgs/about.png" class="listimageicon" />
              About
            </li>
            <li (click)="myprofile()" class="item dropitem">
              <img src="assets/imgs/profile.png" class="listimageicon" />
              My Profile
            </li>
            <li (click)="opencalendar()" class="item dropitem">
              <img src="assets/imgs/profile.png" class="listimageicon" />
              My Calendar
            </li>

            <li (click)="tasks()" class="item dropitem">
              <img src="assets/imgs/task.png" class="listimageicon" />
              My Tasks
            </li>
            <li (click)="openshelf()" class="item dropitem">
              <img src="assets/imgs/profile.png" class="listimageicon" />
              My Shelf
            </li>
            <li (click)="openmom()" class="item dropitem">
              <img src="assets/imgs/profile.png" class="listimageicon" />
              MOM
            </li>
            <li (click)="openBirthdays()" class="item dropitem">
              <img src="assets/imgs/profile.png" class="listimageicon" />
              Birthdays
            </li>
            <li (click)="openProjects()" class="item dropitem">
              <img src="assets/imgs/profile.png" class="listimageicon" />
              Project Milestone
            </li>
            <li (click)="changepassword()" class="item dropitem">
              <img src="assets/imgs/password.png" class="listimageicon" />
              Change Password
            </li>
            <li (click)="logout()" class="item dropitem">
              <img src="assets/imgs/logout.png" class="listimageicon" />
              Logout
            </li>

          </ul> -->
        </header>


        <div class="webscreen">

          <ion-list no-lines style="margin-bottom: 10px;">
            <!-- *ngIf="myfriends!=null && myfriends.length!=0 " -->
            <ion-searchbar id="stay-cancel" (input)="searchuser($event)" (ionCancel)="onCancel2($event)"
              (ionClear)="onCancel2($event)" placeholder="Search">
            </ion-searchbar>
            <!-- <ion-searchbar [showCancelButton]="true" (input)="searchuser($event)"  (ionCancel)="onCancel($event)" placeholder="Search"> -->

            <!-- </ion-searchbar> -->


            <ion-list-header style="text-align: center;" *ngIf="myfriends!=null && myfriends.length==0 ">
              <ion-row style="width: 100%;">
                <div style="    width: 100%;
                  text-align: center;">
                  <h6> No data found
                  </h6>
                </div>

              </ion-row>
            </ion-list-header>
            <div *ngFor="let item of myfriends;let i = index;">

              <ion-item class="itemselect"
                [ngClass]="buddydetails!=undefined && {'highlighted' : (item.username == userName || item.username == groupname)}"
                style="border-bottom: 1px solid lightgrey;"
                style="cursor: pointer; border-bottom: 1px solid lightgrey;border-style: initial;">

                <!-- <ion-avatar item-left>
  
              </ion-avatar> -->

                <ion-avatar slot="start" style=" width: 45px !important;height: 45px !important;">

                  <img (click)="zoomImage(item.buddyimage)"
                    *ngIf="item.buddyimage!='default' && item.buddyimage!='undefined'"
                    [src]="sanitizer.bypassSecurityTrustUrl(item.buddyimage)" onerror="assets/imgs/chatterplace.png">
                  <img *ngIf="item.chatType=='1'   &&(item.buddyimage=='default' || item.buddyimage=='undefined')"
                    src='assets/imgs/chatterplace.png'>
                  <img *ngIf="item.chatType=='2'  && (item.buddyimage=='default' || item.buddyimage=='undefined')"
                    src='assets/imgs/groupIcon.png' onerror="assets/imgs/groupIcon.png">

                  <p *ngIf="item.empstatus=='offline'" class="offline recentimgstatus"></p>
                  <p *ngIf="item.empstatus=='online'" class="online recentimgstatus"></p>
                  <div *ngIf="item.selected" class="hightlighttick">
                    <ion-icon style="color:#fff" name="checkmark"></ion-icon>
                  </div>
                </ion-avatar>
                <ion-label (click)="buddychat(item)">
                  <!-- <h2 *ngIf="item.groupName!=null || item.groupName!=undefined" style="text-transform: capitalize">
                      {{item.groupName}}</h2> -->
                  <h2 *ngIf="item.username!=null" style="font-weight: bold; font-size: 14px;text-transform: capitalize;"
                    [ngStyle]="{'color': colorCode}">
                    {{item.username}}</h2>
                  <div item-right>
                    <i *ngIf="item.count!=undefined && item.count!='undefined' && item.count!=0"
                      class="icon ion-ios7-telephone-outline"><span class="badge badge-assertive icon-badge"
                        [ngStyle]="{'background-color': colorCode}">{{item.count}}</span></i>
                    <span *ngIf="item.dateString==''"
                      style="float: right;font-size: 12px;color: gray;position:relative;top:-22px">
                      {{item.timestamp | date: "hh:mm a" }}</span>
                    <span *ngIf="item.dateString!=null"
                      style="float: right;font-size: 12px;color: gray;position:relative;top:-22px">{{item.dateString}}</span>
                    <ion-icon name="chevron-down-outline" (click)="recentPopover($event,item);$event.stopPropagation()"
                      class="recentdropdown"></ion-icon>
                  </div>

                  <!-- <h6 style="color:gray;text-overflow: ellipsis;overflow: hidden;width: 192px;white-space: nowrap;"
                      *ngIf="item.filetype!='map' && item.filetype!='image'  && item.filetype!='JPG' && item.filetype!='jpg' && item.filetype!='png' && item.filetype!='PNG' && item.filetype!='JPEG' && item.filetype!='jpeg' && item.filetype!='gif' && item.filetype!='GIF' && item.filetype!='application' && item.filetype!='audio' && item.filetype!='mp3' && item.filetype!='video' && item.filetype!='mp4' && item.filetype!='avi' && item.filetype!='flv' 
                      && item.filetype!='dotx' && item.filetype!='doc' && item.filetype!='dot' && item.filetype!='docx' && item.filetype!='xls' && item.filetype!='xlsx' && item.filetype!='xlt' && item.filetype!='xla' && item.filetype!='pdf' && item.filetype!='PDF' && item.filetype!='pps' && item.filetype!='ppa'  && item.filetype!='pptx' && item.filetype!='potx' && item.filetype!='txt' && item.filetype!='TXT'">
                      {{item.message}}</h6> -->

                  <span title='{{item.titlemessage}}'
                    style="font-size: 13px;color:gray;text-overflow: ellipsis;overflow: hidden;width: 192px;white-space: nowrap;"
                    *ngIf="item.filetype!='video text' && item.filetype!='call text' && item.filetype!='map' && item.filetype!='map live' && item.filetype!='image'  && item.filetype!='JPG' && item.filetype!='jpg' && item.filetype!='png' && item.filetype!='PNG' && item.filetype!='JPEG' && item.filetype!='jpeg' && item.filetype!='gif' && item.filetype!='GIF' && item.filetype!='application' && item.filetype!='audio' && item.filetype!='mp3' && item.filetype!='video' && item.filetype!='mp4' && item.filetype!='avi' && item.filetype!='flv' 
                      && item.filetype!='dotx' && item.filetype!='doc' && item.filetype!='dot' && item.filetype!='docx' && item.filetype!='xls' && item.filetype!='xlsx' && item.filetype!='xlt' && item.filetype!='xla' && item.filetype!='pdf' && item.filetype!='PDF' && item.filetype!='pps' && item.filetype!='ppa'  && item.filetype!='pptx' && item.filetype!='potx' && item.filetype!='txt' && item.filetype!='TXT'&& item.filetype!='mom' && item.filetype!='event' "
                    text-wrap [innerHTML]="item.message">
                  </span>


                  <span *ngIf="item.filetype=='call text'" text-wrap
                    style="color: red;font-size: 13px;overflow: hidden;width: 192px;white-space: nowrap;"
                    data-testid="miss" data-icon="miss" class="tooltip1 _25zst">
                    <ion-icon style="color: red;font-size: 13px;pointer-events:none" name="call-outline"></ion-icon>
                    &nbsp;<span
                      style="font-size: 13px;color:gray;overflow: hidden;width: 192px;white-space: nowrap;">{{item.message}}</span>

                  </span>

                  <span *ngIf="item.filetype=='video text'" text-wrap
                    style="color: red;font-size: 13px;overflow: hidden;width: 192px;white-space: nowrap;"
                    data-testid="miss" data-icon="miss" class="tooltip1 _25zst">
                    <ion-icon style="color: red;font-size: 13px;pointer-events:none" name="videocam-outline"></ion-icon>
                    &nbsp;<span
                      style="font-size: 13px;color:gray;overflow: hidden;width: 192px;white-space: nowrap;">{{item.message}}</span>

                  </span>



                  <!-- <i *ngIf="item.count!=undefined && item.count!='undefined'"
                      class="icon ion-ios7-telephone-outline"><span
                          class="badge badge-assertive icon-badge">{{item.count}}</span></i> -->
                  <!--Image div-->
                  <h3
                    *ngIf="item.filetype=='image'  || item.filetype=='JPG' || item.filetype=='jpg' || item.filetype=='png' || item.filetype=='PNG' || item.filetype=='JPEG' || item.filetype=='jpeg' || item.filetype=='gif' || item.filetype=='GIF'">
                    <span style="color:gray">📷 Photo</span>
                  </h3>

                  <!--Map div-->
                  <h3 *ngIf="item.filetype=='map' || item.filetype=='map live'">
                    <img style="height:20px" src="assets/imgs/location.png" />
                    <span style="color:gray">Location</span>
                  </h3>

                  <!--File div-->
                  <h3
                    *ngIf="item.filetype=='application' || item.filetype=='dotx' || item.filetype=='doc' || item.filetype=='dot' || item.filetype=='docx' || item.filetype=='xls' || item.filetype=='xlsx' || item.filetype=='xlt'|| item.filetype=='xla'|| item.filetype=='pdf' || item.filetype=='PDF' || item.filetype=='pps' || item.filetype=='ppa'  || item.filetype=='pptx' || item.filetype=='potx' || item.filetype=='txt' || item.filetype=='TXT'">
                    <img style="height:20px;margin-bottom: -5px;" src="assets/imgs/document.png" />
                    <span style="color:gray;">{{item.fileExtension}}</span>
                  </h3>

                  <!--Video file-->
                  <h3
                    *ngIf="item.filetype=='video' || item.filetype=='mp4' || item.filetype=='avi' || item.filetype=='flv'">
                    <span style="color:gray">🎥 Video</span>
                  </h3>

                  <!--Audio div-->
                  <h3 *ngIf="item.filetype=='audio' ||  item.filetype=='mp3'">
                    <span style="color:gray">🔊 Audio</span>
                  </h3>

                  <h3 *ngIf="item.filetype=='mom'">
                    <span style="color:gray"><i class="far fa-handshake"></i>&nbsp; MOM</span>
                  </h3>

                  <h3 *ngIf="item.filetype=='event'">
                    <span style="color:gray"><i class="fa fa-calendar" aria-hidden="true"></i>&nbsp; Invitation</span>
                  </h3>


                </ion-label>






              </ion-item>
            </div>
           
          </ion-list>
          <!-- <div>
            Flinta version 0.0.1
          </div> -->
        </div>

        <footer style="
        background: #eeeeee;"> 
          <div style="color: #736666;text-transform: capitalize;margin-left: 5px;">
            Licence to @SunSmart Global (Version 0.0.1)
          </div>
        </footer>
      </div>
    </div>

    <div *ngIf="totalcontacts" class="leftcontact">
      <div class="leftside">
        <header class="leftheader backgroundheader">
          <ion-title text-left>
            <span>
              <ion-icon name="arrow-back-outline" style="left: 0px;" class="navigateback" (click)="backbutton()">
              </ion-icon>
            </span>
            <span style="text-transform: capitalize; margin-left: 35px;font-size: 16px;position: relative;top:-6px;">
              Contact List</span><br>

          </ion-title>

        </header>


        <div class="webscreen fireboxweb">

          <ion-row style="    text-align: center;
        margin-top: 25px;">
            <ion-col col-12 col-md-12 col-lg-12 col-xl-12>
              <div class="contacts">
                <a class="button live allcontact" [ngStyle]="{'background-color': backgroundAll, 'color': fontcolorall}"
                  (click)="filterContacts(0)">
                  <span></span> <span>All</span>
                </a>
                <a class="button live livecontact"
                  [ngStyle]="{'background-color': backgroundLive, 'color': fontcolorlive}" (click)="filterContacts(1)">
                  <span></span> <span>Live</span>
                </a>

                <span *ngIf="status==0" style="text-align: center;margin-top: 15px;"> &nbsp; &nbsp;All Contacts:
                  {{contacts.length}}</span>
                <span *ngIf="status==1" style="text-align: center;margin-top: 15px;"> &nbsp; &nbsp;Live Contacts:
                  {{contacts.length}}</span>

              </div>

            </ion-col>
          </ion-row>

          <ion-list style="margin-top: 10px;cursor: pointer;">
            <ion-searchbar (input)="searchcontacts($event)" placeholder="Search" (ionClear)="onCancel1($event)">
            </ion-searchbar>
            <h6 style="text-align: center;" *ngIf="contacts.length==0">Please wait...</h6>
            <div *ngFor="let contact of contacts;let i = index;">
              <ion-item no-lines
                [ngClass]="buddydetails!=undefined && {'highlighted' : (contact.username == buddydetails.username)}">
                <ion-avatar slot="start" style=" width: 45px !important;height: 45px !important;">
                  <img *ngIf="contact.photourl=='default'" src="assets/imgs/chatterplace.png">
                  <img (click)="zoomImage1(contact.photourl)" *ngIf="contact.photourl!='default'"
                    [src]="sanitizer.bypassSecurityTrustUrl(contact.photourl)">
                </ion-avatar>
                <ion-label (click)="chat(contact)">
                  <!-- <h2>Finn</h2> -->
                  <h3 style="text-transform: capitalize;font-weight: bold;" [ngStyle]="{'color': colorCode}">
                    {{contact.username}}</h3>
                  <div>
                    <p style="text-transform: capitalize;float: left;font-size: 13px;color: gray;">
                      {{contact.designation}}</p>
                    <p class="online" *ngIf="contact.status=='online'"></p>
                    <p class="offline" *ngIf="contact.status!='online'"></p>

                  </div>

                </ion-label>
              </ion-item>
            </div>
          </ion-list>
        </div>

      </div>
    </div>


    <div *ngIf="totalgroups" class="leftcontact">
      <div class="leftside">
        <header class="leftheader backgroundheader">
          <ion-title text-left>
            <span>
              <ion-icon name="arrow-back-outline" style="left: 0px;" class="navigateback" (click)="backbutton()">
              </ion-icon>
            </span>
            <span style="text-transform: capitalize; margin-left: 35px;font-size: 16px;position: relative;top:-6px;">
              Groups</span><br>

          </ion-title>

        </header>


        <div class="webscreen fireboxweb">
          <ion-list>
            <!-- <ion-item>GROUPS</ion-item> -->
            <ion-item><a class="item item-icon-left" style="color:#98a2a7" (click)="addgroup()">
                <ion-icon class="ionicon" name="add-circle" style="position: relative;
              top: 10px;font-size: 30px !important;"></ion-icon>
                <span>Create New Group</span>
              </a></ion-item>

          </ion-list>

          <ion-list no-lines style="cursor: pointer;">
            <!-- <div class="group1" *ngIf="allmygroups!=null && allmygroups.length!=0">
            <span>Joined groups</span>
          </div> -->
            <!-- <hr *ngIf="allmygroups!=null && allmygroups.length!=0" class="grphr"/> -->

            <ion-item *ngFor="let item of allmygroups" [ngClass]="{'highlighted' : (item.groupname == groupname)}"
              style="border-bottom: 1px solid lightgrey;border-style: initial;" (click)="openchat(item)">
              <ion-avatar item-left style=" width: 45px !important;height: 45px !important;">

                <img *ngIf="item.groupimage=='default'" src="assets/imgs/groupIcon.png">
                <img *ngIf="item.groupimage!='default'" [src]="sanitizer.bypassSecurityTrustUrl(item.groupimage)">
              </ion-avatar>

              <ion-label style="margin-left: 10px;">
                <h4 style="
        font-size: 14px;
        font-weight: bold; margin-bottom: -4px;text-transform: capitalize;" [ngStyle]="{'color': colorCode}">&nbsp;{{item.groupname}}</h4>
                <span style="text-transform: capitalize;
       color: gray;
       font-size: 12px;
       ">&nbsp;{{item.groupcreated}} &nbsp; {{item.timestamp | date: "MMM d, y" | lowercase}}</span>
              </ion-label>


            </ion-item>
            <!-- <ion-list-header class="group">
          Open groups
        </ion-list-header>
        <ion-item *ngFor="let item of opengrps">
            <ion-avatar item-left>
              <img src="{{item.groupimage}}">
            </ion-avatar>
            <h3 (click)="openchat(item)" style="text-transform :capitalize">{{item.groupName}}</h3>
          </ion-item> -->
          </ion-list>

        </div>

      </div>
    </div>

    <div *ngIf="aboutuskey" class="leftcontact">
      <div class="leftside">
        <header class="leftheader backgroundheader">
          <ion-title text-left>
            <span>
              <ion-icon name="arrow-back-outline" style="left: 0px;" class="navigateback" (click)="backbutton()">
              </ion-icon>
            </span>
            <span style="text-transform: capitalize; margin-left: 35px;font-size: 16px;position: relative;top:-6px;">
              About Us
            </span><br>

          </ion-title>

        </header>


        <div class="webscreen fireboxweb">

          <img src="assets/imgs/flintalogo.png" class="logo">

          <b>Features & Instructions</b>
          <a>
            <ion-item text-wrap>


              <ul class="aboutlist">
                <li>Real Time Messaging</li>
                <li>Share Photo, Document and Video</li>
                <li>Share your Location</li>
                <li>Task Allocation</li>
                <li>Group Creation</li>
                <li> Open Group Creation</li>
                <li>100 % Privacy(Private Server)</li>
                <li>Archive</li>
                <li>Offline Messaging</li>
                <li>Flinta Web log in</li>
              </ul>


            </ion-item>
          </a>
          <a target="_blank" href="https://play.google.com/store/apps/details?id=io.ssg.ssgflintachat">
            <ion-item text-wrap>
              Check for new version
            </ion-item>
          </a>
          <a target="_blank" href="https://play.google.com/store/apps/details?id=io.ssg.ssgflintachat">
            <ion-item text-wrap>
              Review
            </ion-item>
          </a>

          <a target="_blank" href="https://www.facebook.com/flinta.technologies/">
            <ion-item text-wrap>
              Follow us on Facebook
            </ion-item>
          </a>
          <a target="_blank" href="http://www.flintaglobal.com">
            <ion-item text-wrap>
              Website: http://www.flintaglobal.com
            </ion-item>
          </a>
          <a>
            <ion-item text-wrap>
              Email customer service: feedback@flintaglobal.com
            </ion-item>
          </a>

          <a target="_blank" href="http://192.168.0.127/flinta/#">
            <ion-item text-wrap>
              Online support
            </ion-item>
          </a>
        </div>

      </div>
    </div>

    <div *ngIf="myprofilekey" class="leftcontact">
      <div class="leftside">
        <header class="leftheader backgroundheader">
          <ion-title text-left>
            <span>
              <ion-icon name="arrow-back-outline" style="left: 0px;" class="navigateback" (click)="backbutton()">
              </ion-icon>
            </span>
            <span style="text-transform: capitalize; margin-left: 35px;font-size: 16px;position: relative;top:-6px;"> My
              Profile
            </span><br>

          </ion-title>

        </header>


        <div class="webscreen fireboxweb">

          <div *ngIf="profileInfo!=undefined" class="profile-image"
            style="text-align: center;margin-top: 52px;margin-bottom:26px;margin-right: 55px;">
            <img style="border-color: gainsboro;" [src]="sanitizer.bypassSecurityTrustUrl(profileInfo.photourl)"
              *ngIf="profileInfo.photourl!='default'" class="webprofile" (click)="updateImage1()">
            <img style="border-color: gainsboro;" src="assets/imgs/chatterplace.png"
              *ngIf="profileInfo.photourl=='default'" class="webprofile" (click)="updateImagedefault()">

          </div>
          <input type="file" id="filedata" onclick="this.value=null;" style="display: none"
            (change)="onUploadChange1($event)" *ngIf="!mobileicon" accept=".png, .jpg, .jpeg" />

          <ion-list *ngIf="profileInfo!=undefined" style="    font-size: 14px;">
            <!-- <ion-item>
            <div (click)="updateImage()">
              <img *ngIf="profileInfo.photourl!='default'" [src]="sanitizer.bypassSecurityTrustUrl(profileInfo.photourl)" class="profileimage1">
              <img class="profileimage1" *ngIf="profileInfo.photourl=='default'" src="assets/imgs/chatterplace.png">
            </div>
      
          </ion-item> -->
            <ion-item><span style="{{colorCode}}">Employee Code :&nbsp; </span> {{profileInfo.employee}}</ion-item>
            <ion-item style="text-transform: capitalize;"><span style="{{colorCode}}">Name :&nbsp; </span>
              {{profileInfo.username}}</ion-item>
            <ion-item> <span style="{{colorCode}}">Gender : &nbsp;</span> {{profileInfo.gender}}</ion-item>
            <ion-item><span style="{{colorCode}}">Marital Status :&nbsp; </span> 
              <select class="form-control" [(ngModel)]="profileInfo.marital"  placeholder="select"  
              (change)='profileUpdate(profileInfo)' style="width: 50% !important;">
                    <option [ngValue]="Select">Select</option>
                    <option value ="Married">Married  </option>
                    <option value ="UnMarried"> UnMarried</option>
                    <option value ="Divorced"> Divorced</option>
                    
                  </select>
              
           
            </ion-item>
            <ion-item> <span style="">Mobile : &nbsp;</span> {{profileInfo.mobile}}</ion-item>
            <ion-item> <span style="">Email :&nbsp; </span>
              <ion-input [(ngModel)]="profileInfo.email"></ion-input>
               
              </ion-item>
            <ion-item> <span style="">Designation : &nbsp;</span>
              <ion-input [(ngModel)]="profileInfo.designation"></ion-input>
               </ion-item>
            <ion-item> <span style="">Department : &nbsp;</span> 
              <ion-input [(ngModel)]="profileInfo.department"></ion-input>
</ion-item>
            <ion-item><span style="">Branch Name :&nbsp; </span>
              <ion-input [(ngModel)]="profileInfo.branchname"></ion-input>
              
              </ion-item>
            <!-- <ion-item>
            <label style="">Change Tone :</label>
            <ion-select [(ngModel)]="calltone" style="text-transform: capitalize;"  (ionChange)="playtone(calltone)"  interface="popover">
                <ion-select-option *ngFor="let tone of tones;let i = index;" [value]="tone.value">{{tone.name}}</ion-select-option>      
            </ion-select>
          </ion-item> -->

            <!-- <ion-item>Menu Item</ion-item>
          <ion-item>Menu Item</ion-item>
          <ion-item>Menu Item</ion-item> -->
          </ion-list>
         
          <!-- <ion-button *ngIf="profileInfo!=undefined" style="--background:#00bfa5"  (click)='profileUpdate(profileInfo)'>Update</ion-button> -->
          <br/>
        </div>

      </div>
    </div>
    <div *ngIf="mytaskpage" class="leftcontact">
      <div class="leftside">
        <header class="leftheader backgroundheader">
          <ion-title text-left>
            <span>
              <ion-icon name="arrow-back-outline" style="left: 0px;" class="navigateback" (click)="backbutton()">
              </ion-icon>
            </span>
            <span style="text-transform: capitalize; margin-left: 35px;font-size: 16px;position: relative;top:-6px;">My
              Task
            </span><br>

          </ion-title>

        </header>


        <div class="webscreen fireboxweb">
          <div>
            <label style="    margin-top: 10px;">Filter by Date</label>
            <ion-input style="    width: 60%;
          float: right;" type="date" placeholder="Select date" (ionChange)="getmytask()" [(ngModel)]="date">
            </ion-input>

            <!-- <ion-datetime placeholder="Select date" displayFormat="DD/M/YYYY" pickerFormat="DD/M/YYYY" (ionChange)="getmytask()"
            [(ngModel)]="date"></ion-datetime> -->
          </div>

          <!-- <ion-searchbar style="margin-top:0px !important;" [(ngModel)]="searchstring" showCancelButton="never" placeholder="Search" animated="true">
        </ion-searchbar> -->
          <h4 style="text-align: center;text-transform: capitalize;">{{day | date:'mediumDate'}} Task</h4>
          <h5 style="text-align:center;margin:10px;" *ngIf="notask">You Don't Have any Task Now!</h5>
          <!-- <ion-list-header style="text-align: center;" *ngIf="mytask!=null && mytask.length==0 ">
                <ion-row style="width: 100%;"> -->

          <!-- <div style="width: 100%;text-align: center;" *ngIf="mytask!=null && mytask.length==0 ">
                        <h6> No data found
                        </h6>
                    </div> -->

          <!-- </ion-row>
            </ion-list-header> -->

          <div style="    border: 1.5px solid #7a62fe;
        margin-left: 5px;margin-bottom: 10px;
        margin-right: 5px;" *ngFor="let task of mytask| filter:searchstring;let i = index;">
            <ion-card-header>
              <ion-card-title>Task {{i+1}}</ion-card-title>
              <ion-card-subtitle style="margin:10px 15px;font-size: medium;text-transform: capitalize;">{{task.message}}
              </ion-card-subtitle>
            </ion-card-header>
            <ion-card-content>
              <ion-grid>
                <!-- <ion-row>
              <div>
                <h4>Task: <br> <span>{{taskmsg}}</span></h4>
              </div>
            </ion-row> -->
                <ion-row>
                  <ion-col size="6">

                    <label style="color: #0496d0;"> Assigned By :</label>

                  </ion-col>
                  <ion-col size="6" style="text-align: center;">
                    {{task.assigned_by}}
                  </ion-col>
                </ion-row>
                <ion-row>
                  <ion-col size="6">

                    <label style="color: #0496d0;"> Assigned To :</label>

                  </ion-col>
                  <ion-col size="6" style="text-align: center;">
                    {{task.assigned_to}}
                  </ion-col>
                </ion-row>
                <ion-row>
                  <ion-col size="6">

                    <label style="color: #0496d0;"> Assigned On:</label>

                  </ion-col>
                  <ion-col size="6" style="text-align: center;">
                    {{task.assigned_at | date: "dd-MM-yyyy"}}
                  </ion-col>
                </ion-row>
                <ion-row>
                  <ion-col size="6">
                    <label style="color: #0496d0;"> Estimated From Date:</label>

                  </ion-col>
                  <ion-col size="6" style="text-align: center;">
                    {{task.from_date | date: "dd-MM-yyyy"}}
                  </ion-col>
                </ion-row>
                <ion-row>
                  <ion-col size="6">

                    <label style="color: #0496d0;"> Estimated Due Date:</label>

                  </ion-col>
                  <ion-col size="6" style="text-align: center;">
                    {{task.due_at | date: "dd-MM-yyyy"}}
                  </ion-col>
                </ion-row>
                <ion-row>
                  <ion-col size="6">

                    <label style="color: #0496d0;"> Estimated Hours:</label>

                  </ion-col>
                  <ion-col size="6" style="text-align: center;">
                    {{task.esti_time}}
                  </ion-col>
                </ion-row>
                <ion-row *ngIf="task.taskstatus=='4'||task.taskstatus=='5'">
                  <ion-col size="6">
                    <label style="color: #0496d0;"> Completed Date:</label>

                  </ion-col>
                  <ion-col size="6" style="text-align: center;">
                    {{task.completed_at | date: "dd-MM-yyyy"}}
                  </ion-col>
                </ion-row>
                <ion-row>
                  <ion-col size="6">
                    <label style="color: #0496d0;">Status</label>
                  </ion-col>
                  <ion-col *ngIf="!clicked[i]" size="6"
                    style="display: flex;text-align: center;justify-content: center;">
                    <p *ngIf="task.taskstatus=='1'" class="stattext" style="color: darkviolet;">Assigned</p>
                    <p *ngIf="task.taskstatus=='2'" class="stattext" style="color: red;">Reopened</p>
                    <p *ngIf="task.taskstatus=='3'" class="stattext" style="color: orange;">Accepted</p>
                    <p *ngIf="task.taskstatus=='4'" class="stattext" style="color: blue;">Resolved</p>
                    <p *ngIf="task.taskstatus=='5'" class="stattext" style="color: green;">Closed</p>
                    <ion-icon name="pencil" *ngIf="owenertask==false && task.taskstatus!='5'" name="pencil" (click)="edit(i)"></ion-icon>

                    <ion-icon name="pencil" *ngIf="owenertask && task.taskstatus!='5' && task.taskstatus!='1'" name="pencil" (click)="edit(i)"></ion-icon>
                  </ion-col>

                  <ion-col *ngIf="clicked[i]" size="6"
                    style="display: flex;text-align: center;justify-content: center;">
                    <ion-select placeholder="Select" *ngIf="clicked[i]" [(ngModel)]="status">
                      <div *ngFor="let status of task.statusopt">
                        <ion-select-option value="{{status.value}}">{{status.name}}</ion-select-option>
                      </div>
                    </ion-select>
                  </ion-col>
                </ion-row>
                <ion-row>
                  <ion-col size="12">

                    <label style="color: #0496d0;"
                      *ngIf="task.taskstatus!='1' && clicked[i] ||((status=='4' || task.taskstatus=='4' || task.taskstatus=='5'))">Description</label>
                  </ion-col>
                  <!-- <ion-textarea type="text"  [(ngModel)]="emp_description"   value={{task.emp_description}}></ion-textarea> -->
                  <ion-col size="12" style="text-align: center;">

                    <textarea
                      *ngIf=" task.taskstatus!='1' && (clicked[i] ||((status=='4' || task.taskstatus=='4' || task.taskstatus=='5')))"
                      style="padding: 8px;border-radius: 5px;margin: 5px 0;width: 100%;background-color: transparent;"
                      maxlength="500" id="desk{{i}}" value={{task.emp_description}} name="esti_time"
                      type="text"></textarea>
                  </ion-col>
                </ion-row>
                <ion-row *ngIf="clicked[i] && task.taskstatus!='5'">
                  <ion-col>
                    <div style="text-align: end;">
                      <ion-button color="success" (click)="save(task,i,task.taskstatus)">Save</ion-button>
                    </div>
                  </ion-col>
                  <ion-col>
                    <div style="text-align: left;">
                      <ion-button color="danger" (click)="cancel(task,i)">Cancel</ion-button>
                    </div>
                  </ion-col>
                </ion-row>
              </ion-grid>
            </ion-card-content>
          </div>

        </div>

      </div>
    </div>

    <div *ngIf="calendarpage" class="leftcontact">
      <div class="leftside">
        <header class="leftheader backgroundheader">
          <ion-title text-left>
            <span>
              <ion-icon name="arrow-back-outline" style="left: 0px;" class="navigateback" (click)="backbutton()">
              </ion-icon>
            </span>
            <span style="text-transform: capitalize; margin-left: 35px;font-size: 16px;position: relative;top:-6px;">
              {{ viewTitle }}
            </span>
            <span>
              <ion-button class="todaybtn" (click)="today()">Today</ion-button>
            </span>

          </ion-title>
        </header>


        <div class="webscreen fireboxweb">
          <div >
            New Event
          </div>
          <div >
            <ion-item>
              <ion-input type="text" placeholder="Title" maxlength="50" [(ngModel)]="event.title"></ion-input>
            </ion-item>
            <ion-item>
              <ion-textarea type="text" placeholder="Description" maxlength="500" [(ngModel)]="event.desc">
              </ion-textarea>
            </ion-item>
            <ion-item>
              <ion-label>Start</ion-label>
              <ion-input type="datetime-local" [(ngModel)]="event.startTime"></ion-input>

              <!-- <ion-datetime displayFormat="DD/MM/YYYY hh:mm A" pickerFormat="MMM D:hh:mm A" [(ngModel)]="event.startTime"></ion-datetime> -->
            </ion-item>
            <ion-item>
              <ion-label>End</ion-label>
              <ion-input type="datetime-local" [(ngModel)]="event.endTime"></ion-input>

              <!-- <ion-datetime displayFormat="DD/MM/YYYY hh:mm A" pickerFormat="MMM D:hh:mm A" [(ngModel)]="event.endTime" ></ion-datetime> -->
            </ion-item>
            <!-- <ion-item>
            <ion-label>All Day?</ion-label>
            <ion-checkbox [(ngModel)]="event.allDay"></ion-checkbox>
          </ion-item> -->
            <ion-button style="margin: 15px 0;" expand="block" (click)="addEvent()" [disabled]="event.title == ''">Add
              Event</ion-button>

          </div>


          <ion-row>
            <!-- Change the displayed calendar mode -->
            <ion-col size="4">
              <ion-button expand="block" [color]="calendar.mode == 'month' ? 'primary' : 'secondary'"
                (click)="changeMode('month')">Month</ion-button>
            </ion-col>
            <ion-col size="4">
              <ion-button expand="block" [color]="calendar.mode == 'week' ? 'primary' : 'secondary'"
                (click)="changeMode('week')">Week</ion-button>
            </ion-col>
            <ion-col size="4">
              <ion-button expand="block" [color]="calendar.mode == 'day' ? 'primary' : 'secondary'"
                (click)="changeMode('day')">Day</ion-button>
            </ion-col>

            <!-- Move back one screen of the slides -->
            <ion-col size="6" text-left>
              <ion-button fill="clear" (click)="back()">
                <ion-icon name="arrow-back" slot="icon-only"></ion-icon>
              </ion-button>
            </ion-col>

            <!-- Move forward one screen of the slides -->
            <ion-col size="6" text-right>
              <ion-button style="float: right;" fill="clear" (click)="next()">
                <ion-icon name="arrow-forward" slot="icon-only"></ion-icon>
              </ion-button>
            </ion-col>
          </ion-row>

          <calendar 
          [eventSource]="eventSource" 
          [calendarMode]="calendar.mode" 
          [currentDate]="calendar.currentDate"
          (onEventSelected)="onEventSelected($event)"
          (onTitleChanged)="onViewTitleChanged($event)"
          (onTimeSelected)="onTimeSelected($event)" 
          startHour="0"
          endHour="24"
          step="30"
          startingDayWeek="1">
          </calendar>
        </div>

      </div>
    </div>

    <div *ngIf="myshelfpage" class="leftcontact">
      <div class="leftside">
        <header class="leftheader backgroundheader">
          <ion-title text-left>
            <span>
              <ion-icon name="arrow-back-outline" style="left: 0px;" class="navigateback" (click)="backbutton()">
              </ion-icon>
            </span>
            <span style="text-transform: capitalize; margin-left: 35px;font-size: 16px;position: relative;top:-6px;"> My
              Shelf
            </span>


          </ion-title>
        </header>


        <div class="webscreen fireboxweb">

          <ion-searchbar [(ngModel)]="searchstring" style="margin-top:1px;" (input)="searchusershelf($event)"
            placeholder="Search" (ionClear)="onCancelshelf($event)" showCancelButton="never" placeholder="Search"
            animated="true">
          </ion-searchbar>
          <h5 style="text-align:center;margin:20px;" *ngIf="nofiles">You Don't Have any File to Show!</h5>
          <ion-grid>
            <ion-row>
              <ion-col>
                <h5><i class="fa fa-file" style="color: yellow;" aria-hidden="true"></i> &nbsp;Sent Files:<br></h5>
                <p style="text-align: center;" *ngIf="sent_files.length==0">No Sent Files!</p>
              </ion-col>
            </ion-row>
            <ion-row>
              <!-- <ion-col   > -->
              <div style="width: 100%;border-bottom:1px solid #ddd;padding:10px"
                *ngFor="let file of sent_files;let i = index;" (click)="openaction(file)">
                <img style="    float: left;height: 40px;" src='assets/imgs/wordDoc.png'
                  *ngIf="file.filetype=='doc'||file.filetype=='docx'">
                <img style="    float: left;height: 40px;" src='assets/imgs/txtFormat.png' *ngIf="file.filetype=='txt'">
                <img style="    float: left;height: 40px;" src='assets/imgs/pdfDoc.png' *ngIf="file.filetype=='pdf'">
                <img style="    float: left;height: 40px;" src='assets/imgs/ppt.png'
                  *ngIf="file.filetype=='ppt'||file.filetype=='pptx'">
                <img style="    float: left;height: 40px;" src='assets/imgs/excelDoc.png'
                  *ngIf="file.filetype=='xls'||file.filetype=='xlsx'">
                  <img style="    float: left;height: 40px;" *ngIf="file.filetype=='jpg'|| file.filetype=='JPEG' || file.filetype=='JPG'
                  || file.filetype=='image' ||file.filetype=='png' ||file.filetype=='PNG' ||file.filetype=='bmp'"
                    src="assets/imgs/gallery.jpg">
                <p style="text-align: center;font-size: 14px;margin-top: 8px;
              float: left;">{{file.fileextension}} &nbsp;({{file.timestamp | date: "MMM d, y" | lowercase}})</p>

              </div>

              <!-- </ion-col> -->
            </ion-row>

            <ion-row>
              <ion-col>
                <h5><i class="fa fa-file" style="color: yellow;" aria-hidden="true"></i> &nbsp;Received Files:<br></h5>
                <p style="text-align: center;" *ngIf="received_files.length==0">No Received Files!</p>
              </ion-col>
            </ion-row>
            <ion-row>
              <!-- <ion-col  *ngFor="let file of received_files;let i = index;" (click)="openaction(file)"> -->



              <div style="width: 100%;border-bottom:1px solid #ddd;padding:10px"
                *ngFor="let file of received_files;let i = index;" (click)="openaction(file)">
                <img style="    float: left;height: 40px;" src='assets/imgs/wordDoc.png'
                  *ngIf="file.filetype=='doc'||file.filetype=='docx'">
                <img style="    float: left;height: 40px;" src='assets/imgs/txtFormat.png' *ngIf="file.filetype=='txt'">
                <img style="    float: left;height: 40px;" src='assets/imgs/pdfDoc.png' *ngIf="file.filetype=='pdf'">
                <img style="    float: left;height: 40px;" src='assets/imgs/ppt.png'
                  *ngIf="file.filetype=='ppt'||file.filetype=='pptx'">
                <img style="    float: left;height: 40px;" src='assets/imgs/excelDoc.png'
                  *ngIf="file.filetype=='xls'||file.filetype=='xlsx'">
                  <img style="    float: left;height: 40px;" *ngIf="file.filetype=='jpg'|| file.filetype=='JPEG' || file.filetype=='JPG'
                  || file.filetype=='image' ||file.filetype=='png' ||file.filetype=='PNG' ||file.filetype=='bmp'"
                    src="assets/imgs/gallery.jpg">
                <p style="text-align: center;font-size: 14px;margin-top: 15px;
              float: left;">{{file.fileextension}} &nbsp;({{file.timestamp | date: "MMM d, y" | lowercase}})</p>

              </div>

              <!-- </ion-col> -->
            </ion-row>
          </ion-grid>
        </div>

      </div>
    </div>
    <div *ngIf="mompage" class="leftcontact">
      <div class="leftside">
        <header class="leftheader backgroundheader">
          <ion-title text-left>
            <span>
              <ion-icon name="arrow-back-outline" style="left: 0px;" class="navigateback" (click)="backbutton()">
              </ion-icon>
            </span>
            <span style="text-transform: capitalize; margin-left: 35px;font-size: 16px;position: relative;top:-6px;">
              Minutes of Meeting
            </span>


          </ion-title>
        </header>


        <div class="webscreen fireboxweb">

          <ion-list>
            <ion-item (click)="momopencontacts1()">
              <ion-label><b>Meeting Called By</b></ion-label>
              <ion-input [(ngModel)]="calledby" title={{calledby}} placeholder="Please Select"></ion-input>
            </ion-item>

            <ion-item>
              <ion-label><b>Agenda</b></ion-label>
              <ion-input [(ngModel)]="agenda"></ion-input>
            </ion-item>


            <ion-item (click)="momopencontacts()">
              <ion-label><b>Attendees</b></ion-label>
              <ion-input [(ngModel)]="tot_attendes" title="tot_attendes" placeholder="Please Select"></ion-input>
              <!-- <ion-select multiple="true" [(ngModel)]="attendes">
              <div *ngFor="let contact of contacts">
              <ion-select-option *ngIf="contact.userstatus=='A'&&contact.username!='undefined'&&contact.username!=''" value={{contact.username}}>{{contact.username}}</ion-select-option>
            </div>
            </ion-select> -->
              <!-- <ionic-selectable
            [(ngModel)]="port"
            [items]="contacts"
            itemValueField="id"
            itemTextField="name"
            [canSearch]="true"
            (onChange)="portChange($event)">
          </ionic-selectable> -->
            </ion-item>


            <ion-item>
              <ion-label style="margin-top: 10px;"><b>Discussion</b></ion-label>
              <ion-textarea [(ngModel)]="discussion"></ion-textarea>
            </ion-item>

            <ion-item>
              <ion-label style="margin-top: 10px;"><b>Conclusion</b></ion-label>
              <ion-textarea [(ngModel)]="conclusion"></ion-textarea>
            </ion-item>
          </ion-list>

          <p style="margin: 15px;"><b>Action Plan:</b> <span *ngIf="employee_details.length=='0'">Please add Employee and
              POA</span></p>

          <div *ngFor="let att of employee_details; let i = index" class="carddiv">
            <h3 style="text-align: center;margin:0;">Employee {{i+1}} <ion-icon name="close-circle"
                (click)="remove_app(i)"
                style="font-size: 25px;vertical-align: middle;float: right;position: absolute;right: 10px;"></ion-icon>
            </h3>

            <!-- <ion-label class="card-label">Employee Name</ion-label>
                <ion-input style="border: 1px solid var(--ion-card-title-color);border-radius: 7px;text-align: left;" type="text" [(ngModel)]="employee_details[i].name"></ion-input> -->
            <!-- <ion-item> -->
            <ion-label>Employee Name</ion-label>
            <br />
            <select [(ngModel)]="employee_details[i].name"
              style="border: 1px solid var(--ion-card-title-color);border-radius: 7px;text-align: left;color:rgb(175, 60, 60);width:100%;height:40px">
              <option *ngFor="let contact of contact_res" value="{{contact.username}}">{{contact.username}}</option>
            </select>
            <!-- <ion-select [(ngModel)]="employee_details[i].name" style="border: 1px solid var(--ion-card-title-color);border-radius: 7px;text-align: left;">
                    <div *ngFor="let contact of contact_res">
                    <ion-select-option *ngIf="contact.userstatus=='A'&&contact.username!='undefined'&&contact.username!=''" value={{contact.username}}>{{contact.username}}</ion-select-option>
                  </div>
                  </ion-select> -->
            <!-- </ion-item> -->
            <ion-label class="card-label">Assigned Task/Action</ion-label>
            <ion-textarea style="border: 1px solid var(--ion-card-title-color);border-radius: 7px;text-align: left;"
              autoGrow=true [(ngModel)]="employee_details[i].task"></ion-textarea>
            <ion-label class="card-label">Deadline</ion-label>
            <ion-input type="date"
              style="border: 1px solid var(--ion-card-title-color);border-radius: 7px;text-align: left;"
              [(ngModel)]="employee_details[i].deadline"></ion-input>
            <!-- <ion-datetime style="border: 1px solid var(--ion-card-title-color);border-radius: 7px;text-align: left;" displayFormat="D MMM YYYY H:mm" [(ngModel)]="employee_details[i].deadline"></ion-datetime> -->
            <!-- <input style="width: 100%;padding: 5px;" type="datetime-local"/> -->
          </div>
          <div style="text-align: center;margin: 10px 0;">
            <ion-button (click)="add_employee()">Add</ion-button>
            <ion-button color="success" (click)="momsave()" [disabled]="employee_details.length==0">Save & Share
            </ion-button>
          </div>
        </div>

      </div>
    </div>


    <div *ngIf="birthdaypage" class="leftcontact">
      <div class="leftside">
        <header class="leftheader backgroundheader">
          <ion-title text-left>
            <span>
              <ion-icon name="arrow-back-outline" style="left: 0px;" class="navigateback" (click)="backbutton()">
              </ion-icon>
            </span>
            <span style="text-transform: capitalize; margin-left: 35px;font-size: 16px;position: relative;top:-6px;">
              Birthdays
            </span>


          </ion-title>
        </header>


        <div class="webscreen fireboxweb">

          <p style="text-align: center;margin:10px 0;" *ngIf="showloading">Please Wait..</p>


          <ion-list>
            <ion-searchbar (input)="searchuserbirthday($event)" placeholder="Search"
              (ionClear)="onCancelbirthday($event)">
            </ion-searchbar>
            <div *ngFor="let buddy of mycontacts;let i = index;" (click)="sendwishes(buddy)">
              <ion-item no-lines>
                <ion-avatar slot="start" style=" width: 45px !important;height: 45px !important;">
                  <img *ngIf="buddy.photourl=='default'" src="assets/imgs/chatterplace.png">
                  <img *ngIf="buddy.photourl!='default'" [src]="sanitizer.bypassSecurityTrustUrl(buddy.photourl)">
                </ion-avatar>
                <ion-label>
                  <!-- <h2>Finn</h2> -->
                  <h3 style="text-transform: capitalize;font-weight: bold;color: #0c84b4;">{{buddy.username}}</h3>
                  <div>
                    <p *ngIf="buddy.advbday!=true&&buddy.belatedbday!=true">{{buddy.dob | date: "dd-MM-yyyy"}}</p>
                    <p *ngIf="buddy.advbday==true" style="color: limegreen;font-weight: bold;">
                      {{buddy.dob | date: "dd-MM-yyyy"}}</p>
                    <p *ngIf="buddy.belatedbday==true" style="color: orangered;font-weight: bold;">
                      {{buddy.dob | date: "dd-MM-yyyy"}}</p>
                    <img src="assets/imgs/bday.png" *ngIf="buddy.bday==true" style="height: 25px;" />

                  </div>

                </ion-label>
              </ion-item>
            </div>
          </ion-list>

        </div>

      </div>
    </div>

    <div *ngIf="projectmilestonepage" class="leftcontact">
      <div class="leftside">
        <header class="leftheader backgroundheader">
          <ion-title text-left>
            <span>
              <ion-icon name="arrow-back-outline" style="left: 0px;" class="navigateback" (click)="backbutton()">
              </ion-icon>
            </span>
            <span style="text-transform: capitalize; margin-left: 35px;font-size: 16px;position: relative;top:-6px;">
              Project Milestone
            </span>


          </ion-title>
        </header>


        <div class="webscreen fireboxweb createmilestone">

          <div>

            <button class="btn" expand="block" (click)="toggle_create()"><i class="fa fa-plus-circle"
                aria-hidden="true"></i>
              &nbsp; Create Milestone</button>
            <button class="btn" expand="block" (click)="toggle_view()"><i class="fa fa-eye" aria-hidden="true"></i>
              &nbsp; View Milestone</button>
          </div>


          <div style="margin: 10px; background: #dadada;
        border-radius: 8px;" *ngIf="tcreate==true">
            <!-- <ion-icon name="close-circle" (click)="toggle_view()" class="close"></ion-icon> -->
            <!-- <div style="padding: 5px;">  -->

            <ion-grid>
              <ion-row>
                <ion-col>
                  <div style="text-align: left;color: #0c84b4;">Project Name &nbsp;<span style="color: red;">*</span>
                  </div>
                  <ion-input type="text" [(ngModel)]="projectname"></ion-input>
                </ion-col>
              </ion-row>
              <ion-row>
                <ion-col>
                  <div style="text-align: left;color: #0c84b4;">Project ID &nbsp;<span style="color: red;">*</span>
                  </div>
                  <ion-input type="text" [(ngModel)]="projectid"></ion-input>
                </ion-col>
              </ion-row>

              <div *ngFor="let att of milestones; let i = index">
                <ion-row>
                  <ion-col size="10">
                    <div style="text-align: left;color: #0c84b4;">Module Name {{i+1}}&nbsp;<span
                        style="color: red;">*</span></div>
                    <ion-input type="text" [(ngModel)]="milestones[i].text"></ion-input>
                    <!-- placeholder="Module {{i+1}}" -->
                  </ion-col>
                  <ion-col size="2">
                    <ion-button style="margin-top: 25px;" color="danger" (click)="remove_milestone(i)">
                      <ion-icon name="close" title="Close"></ion-icon>
                    </ion-button>
                  </ion-col>
                </ion-row>
                <ion-row>
                  <ion-col>
                    <div style="text-align: left;color: #0c84b4;">Description &nbsp;<span style="color: red;">*</span>
                    </div>
                    <ion-textarea style="text-align: left;" [(ngModel)]="milestones[i].description">
                    </ion-textarea>

                  </ion-col>
                </ion-row>
                <ion-row>
                  <ion-col col=6>
                    <div style="text-align: left;color: #0c84b4;">Start Date &nbsp;<span style="color: red;">*</span>
                    </div>

                    <ion-input type="date" [(ngModel)]="milestones[i].startdate"></ion-input>
                  </ion-col>
                  <ion-col col=6>
                    <div style="text-align: left;color: #0c84b4;">End Date &nbsp;<span style="color: red;">*</span>
                    </div>
                    <ion-input type="date" [(ngModel)]="milestones[i].deadline"></ion-input>

                  </ion-col>
                </ion-row>
              </div>


              <!-- </ion-row> -->

              <!-- <ion-row>
              
            </ion-row>
            <ion-row>
            </ion-row> -->

            </ion-grid>
            <div style="text-align: center;padding: 10px 0;">
              <ion-button (click)="add_milestone()"> Add</ion-button>
              <ion-button color="success" (click)="submit()">Submit</ion-button>
            </div>
            <!-- </div> -->
          </div>

          <div *ngIf="tcreate!=undefined &&tcreate==false">

            <ion-searchbar [(ngModel)]="project" style="border-radius: 5px;position:relative;top:10px;" (input)="SearchValue($event)"
            placeholder="Search" (ionClear)="onCancel($event)" showCancelButton="never" placeholder="Search Project"
            animated="true">
          </ion-searchbar>
        
              <!-- List Items -->
              <ion-list *ngIf="projectlist1.length!=0" style="    border: 1px solid #7a62fe;
              position: fixed;
              z-index: 1000;
              width: 300px;
              border-radius: 10px;top:150px">
                <ion-item *ngFor="let item of projectlist1 " no-lines>
                  <ion-label style="    color: black;" (click)="selectedvalue(item.projectid,item.projectname)">{{item.projectname}}</ion-label>
                </ion-item>
              </ion-list>
            <div class="ion-padding">
              <div *ngIf="projectstat&&projectstat.length>0">
                <ion-progress-bar style="height: 20px;border-radius: 10px;" color="secondary" [value]="progress1">
                </ion-progress-bar>
                <p style="text-align: end;font-weight: 600;margin: 10px 0;"> Completion Status : <span
                    [style.color]="progress*100==100?'green':'red'">{{progress*100}} %</span></p>

              </div>
              <ion-grid *ngIf="projectstat&&projectstat.length>0">
                <ion-row class="titlerow">
                  <ion-col size="2">No</ion-col>
                  <ion-col size="10">Milestone</ion-col>
                  <!-- <ion-col size="4">Status</ion-col> -->
                </ion-row>
                <ion-row class="gridbody" *ngFor="let status of projectstat;let i = index;" (click)="showstatus(i)">
                  <ion-col size="2">{{i+1}}</ion-col>
                  <ion-col size="10" style="text-align: left;text-transform: capitalize;">{{status.milestone}} <br>
                    <span style="font-size: 12px;" *ngIf="status.description!='undefined'"><span
                        style="color: #0c84b4;">Description: </span> {{status.description}}</span> <br>
                    <span style="font-size: 12px;" *ngIf="status.description!='undefined'"><span
                        style="color: #0c84b4;">From Date:</span> {{status.startdate1}}</span><br>
                    <span style="font-size: 12px;" *ngIf="status.description!='undefined'"><span
                        style="color: #0c84b4;">To Date:</span> {{status.duedate1}}</span><br>
                    <span style="font-size: 12px;" *ngIf="status.description!='undefined'"><span
                        style="color: #0c84b4;">Days :</span> {{status.Difference_In_Days}}</span>



                  </ion-col>
                  <ion-col class="statcol" [style.background-color]="status.status==1?'#ffc300':'lime'"
                    style="margin-left: 55px;">
                    <!-- *ngIf="statusview[i]" -->

                    <ion-select placeholder="Select" [disabled]="admin!='1'" style="height: 40px;"
                      (ionChange)="changestat(status,status.status)" [(ngModel)]="status.status">
                      <!-- <ion-select-option value="0">Not Started</ion-select-option> -->
                      <ion-select-option value="1">In Progress</ion-select-option>
                      <ion-select-option value="2">Completed</ion-select-option>
                    </ion-select>
                  </ion-col>
                </ion-row>
              </ion-grid>
            </div>
          </div>

        </div>

      </div>
    </div>

    <div *ngIf="starredmessage" class="leftcontact">
      <div class="leftside">
        <header class="leftheader backgroundheader">
          <ion-title text-left>
            <span>
              <ion-icon name="arrow-back-outline" style="left: 0px;" class="navigateback" (click)="backbutton()">
              </ion-icon>
            </span>
            <span style="text-transform: capitalize; margin-left: 35px;font-size: 16px;position: relative;top:-6px;">
              Starred Messages
            </span>


          </ion-title>
        </header>


        <div class="webscreen fireboxweb" style="background-color:#ddd;">

          <p style="text-align: center;margin:10px 0;" *ngIf="showloading">Please Wait..</p>

          <ion-grid>
            <div *ngFor="let item of starredallmessages;let i = index;">
        
              <ion-row id="chatrow{{i}}" (press)="onPress($event,item,i)" (pressup)="onPressUp($event)"
                [style.touch-action]="'pan-y'" [ngStyle]="{'background-color': item.selectedColor}">
        
                <ion-row style="width: 100%;" *ngIf="item.timeset!=null && item.timeset!=undefined ">
                  <div class="timestampdate">{{item.timeset}}</div><br />
                </ion-row>
                <!--Forward selection-->
                <ion-checkbox color="dark" *ngIf="forwardClick==true || deleteFlag==true" [(ngModel)]="item.selected"
                  item-right checked="false">
                </ion-checkbox>
                <ion-row style="width: 100%;" *ngIf="item.unreadMessageCount!=null && item.unreadMessageCount!=''">
                  <div class="timestampdate">{{item.unreadMessageCount}}</div><br />
                </ion-row>
                <ion-row style="width: 100%;" *ngIf="item.filetype=='call text'">
                  <div class="timestampdate"><span style="color: red;" data-testid="miss" data-icon="miss" class="_25zst">
                      <!-- <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 17" width="20" height="17"><path fill="currentColor" d="M18.2 12.1c-1.5-1.8-5-2.7-8.2-2.7s-6.7 1-8.2 2.7c-.7.8-.3 2.3.2 2.8.2.2.3.3.5.3 1.4 0 3.6-.7 3.6-.7.5-.2.8-.5.8-1v-1.3c.7-1.2 5.4-1.2 6.4-.1l.1.1v1.3c0 .2.1.4.2.6.1.2.3.3.5.4 0 0 2.2.7 3.6.7.2 0 1.4-2 .5-3.1zM5.4 3.2l4.7 4.6 5.8-5.7-.9-.8L10.1 6 6.4 2.3h2.5V1H4.1v4.8h1.3V3.2z"></path></svg></span> -->
                      <ion-icon style="color: red;font-size: 12.5px;" name="call-outline"></ion-icon>
                    </span><span style="font-size: 12.5px;">&nbsp; {{item.message}}</span> </div><br />
                </ion-row>
        
                <ion-row style="width: 100%;" *ngIf="item.filetype=='video text'">
                  <div class="timestampdate"><span style="color: red;" data-testid="miss" data-icon="miss" class="_25zst">
                      <!-- <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 17" width="20" height="17"><path fill="currentColor" d="M18.2 12.1c-1.5-1.8-5-2.7-8.2-2.7s-6.7 1-8.2 2.7c-.7.8-.3 2.3.2 2.8.2.2.3.3.5.3 1.4 0 3.6-.7 3.6-.7.5-.2.8-.5.8-1v-1.3c.7-1.2 5.4-1.2 6.4-.1l.1.1v1.3c0 .2.1.4.2.6.1.2.3.3.5.4 0 0 2.2.7 3.6.7.2 0 1.4-2 .5-3.1zM5.4 3.2l4.7 4.6 5.8-5.7-.9-.8L10.1 6 6.4 2.3h2.5V1H4.1v4.8h1.3V3.2z"></path></svg></span> -->
                      <ion-icon style="color: red;font-size: 12.5px;" name="videocam-outline"></ion-icon>
                    </span> <span style="font-size: 12.5px;"> &nbsp;&nbsp;{{item.message}}</span></div><br />
                </ion-row>
        
        
                <div *ngIf="item.filetype=='title'" class="timestampdate">{{item.message}}</div><br />
        
                <!--friend-->
               
               
                <ion-col size="9"
                  *ngIf="item.sentby !== currentUser&& item.filetype!='title' && item.filetype!='video text' && item.filetype!='call text'"
                  class="message other-message">
                  <p *ngIf="item.sentby != currentUser" style="font-size: 14px;margin-left:13px;"> {{item.username}} to You {{item.timestamp | date: "dd/MM/yyyy"}}</p>
                  <div class="chatbubble-left">
        
                 
                    <div
                      *ngIf="item.forwardmsg!=null && item.forwardmsg!='undefined' && item.forwardmsg!='null'"
                      style="    font-size: 13px;
                    font-style: italic;
                color: lightgray;">
                      <i class="fa fa-share" aria-hidden="true"></i> Forwarded
                    </div>
                    <!--Reply Tag text-->
                    <span
                      *ngIf="item.tagmessage!='' && item.tagmessage!=null && item.tagmessage!='undefined' && item.tagmessage!='null'"
                      >
        
                      <span *ngIf="item.tagfiletype=='text'" style="white-space: pre-line !important;" text-wrap
                        [innerHTML]="item.tagmessage "></span>
        
                      <!--Image file-->
                      <div
                        *ngIf="item.tagfiletype=='image' || item.tagfiletype=='JPG' || item.tagfiletype=='jpg' || item.tagfiletype=='png' || item.tagfiletype=='PNG' || item.tagfiletype=='JPEG' || item.tagfiletype=='jpeg' || item.tagfiletype=='gif' || item.tagfiletype=='GIF'">
                        <img src="{{item.tagmessage}}">
                      </div>
                      <!--Any document-->
        
                      <div>
        
                        <a
                          *ngIf="item.tagfiletype=='dotx' ||item.tagfiletype=='doc' || item.tagfiletype=='dot' || item.tagfiletype=='docx'">
        
                          <p text-wrap class="fileexten">{{item.tagfileextension}}</p>
                        </a>
                        <a
                          *ngIf="item.tagfiletype=='xls' || item.tagfiletype=='xlsx' || item.tagfiletype=='xlt'|| item.tagfiletype=='xla' ">
        
                          <p text-wrap class="fileexten">{{item.tagfileextension}}</p>
                        </a>
        
                        <a *ngIf="item.tagfiletype=='txt' || item.tagfiletype=='TXT'">
        
                          <p text-wrap class="fileexten">{{item.tagfileextension}}</p>
                        </a>
        
                        <a *ngIf="item.tagfiletype=='pdf' || item.tagfiletype=='PDF'">
        
                          <p text-wrap class="fileexten">{{item.tagfileextension}}</p>
                        </a>
                        <a
                          *ngIf="item.tagfiletype=='pps' || item.tagfiletype=='ppa'  || item.tagfiletype=='pptx' || item.tagfiletype=='potx'">
        
                          <p text-wrap class="fileexten">{{item.tagfileextension}}</p>
                        </a>
        
                      </div>
        
        
                      <!--Location-->
                      <a *ngIf="item.Taglocation=='true'">
                        <img
                          src="{{getMap}}center={{item.latitude}}&zoom=18&size=300x300&markers=color:red%7Clabel:S%7C{{item.latitude}}">
                      </a>
        
                      <!--Audio file-->
                      <audio style="max-width: 100%;" *ngIf="item.tagfiletype=='audio' || item.tagfiletype=='mp3'" controls controlsList="nodownload">
                        <source [src]="sanitizer.bypassSecurityTrustUrl(item.tagmessage)" type="audio/ogg">
                        <source [src]="sanitizer.bypassSecurityTrustUrl(item.tagmessage)" type="audio/mpeg">
                      </audio>
                      <!--Video file-->
                      <video style="max-width: 100%;"  *ngIf="item.tagfiletype=='mp4' || item.tagfiletype=='avi' || item.tagfiletype=='flv'" width="200"
                        preload="none" height="125" controls controlsList="nodownload">
                        <source [src]="sanitizer.bypassSecurityTrustUrl(item.tagmessage)" type="video/mp4">
                        <source [src]="sanitizer.bypassSecurityTrustUrl(item.tagmessage)" type="video/ogg">
                      </video>
        
                      <p class="stable singleTick" *ngIf="item.tagtime!='undefined' && item.tagtime!=''">{{item.tagtime | date: "hh:mm a"  }} </p>
                      <!--| lowercase-->
                      <h6></h6>
                    </span>
                    <div>
                      <!-- [hidden]="selfdestruct" -->
        
                      <!-- <span *ngIf="!item.showMore"> -->
        
                      <span *ngIf=" !item.showMore && item.filetype=='text' && item.message!=''"
                        style="white-space: pre-line !important;color: black;margin-right: 15px;max-width: 100%;" text-wrap
                        [innerHTML]="trimString(item.message,150)"></span>
        
                      <!-- </div> -->
                      <!-- <div *ngIf="item.showMore"> -->
        
                      <span *ngIf="item.showMore &&item.filetype=='text' && item.message!='' && hidetext(item)"
                        style="white-space: pre-line !important;color: black;max-width: 100%;" text-wrap
                        [innerHTML]="item.message"></span>
        
                      <!-- </div> -->
                      <a *ngIf="item.message.length>150 &&  item.filetype=='text'" style="color: #039be5;cursor: pointer;font-size: 14px;"
                        (click)="item.showMore = !item.showMore">Read <span [innerHtml]="item.showMore ? 'less' : 'More'">
                        </span>
                      </a>
        
        
        
        
                      <img style="object-fit: cover;width:245px;height:245px;margin-bottom: 10px;"
                        [src]="sanitizer.bypassSecurityTrustUrl(item.message)"
                        *ngIf="item.filetype=='image' || item.filetype=='JPG' || item.filetype=='jpg' || item.filetype=='png' || item.filetype=='PNG' || item.filetype=='JPEG' || item.filetype=='jpeg' || item.filetype=='gif' || item.filetype=='GIF'"
                        >
        
                      <!--Doc format-->
                      <a *ngIf="item.filetype=='dotx' ||item.filetype=='doc' || item.filetype=='dot' || item.filetype=='docx'"
                        >
                        <img style="height:35px;" src="assets/imgs/wordDoc.png">
                        <h6 text-wrap class="fileexten">{{item.fileextension}}</h6>
                      </a>
        
                      <!--XLS format-->
                      <div
                        *ngIf="item.filetype=='xls' || item.filetype=='xlsx' || item.filetype=='xlt'|| item.filetype=='xla'"
                        >
                        <img style="height:35px;" src="assets/imgs/excelDoc.png">
                        <h6 text-wrap class="fileexten">{{item.fileextension}}</h6>
                      </div>
                      <!--PDF Format-->
                      <div *ngIf="item.filetype=='pdf' || item.filetype=='PDF'"
                        >
                        <img style="height:35px;" src="assets/imgs/pdfDoc.png">
                        <h6 text-wrap class="fileexten">{{item.fileextension}}</h6>
                      </div>
        
                      <!--Txt Format-->
                      <a *ngIf="item.filetype=='txt' || item.filetype=='TXT'"
                        >
                        <img style="height:35px;" src="assets/imgs/txtFormat.png">
                        <span text-wrap class="fileexten">{{item.fileextension}}</span>
                      </a>
        
                      <!--PPT format-->
                      <a *ngIf="item.filetype=='pps' || item.filetype=='ppa'  || item.filetype=='pptx' || item.filetype=='potx'"
                        >
                        <img style="height:35px;" src="assets/imgs/ppt.png">
                        <h6 text-wrap class="fileexten">{{item.fileextension}}</h6>
                      </a>
        
                      <!--google location file-->
                      <a *ngIf="item.filetype=='map'" >
                        <img
                          src="{{getMap}}center={{latitude}}&zoom=18&size=300x300&markers=color:red%7Clabel:S%7C{{item.message}}">
                      </a>
        
                      <!-- <a *ngIf="item.filetype=='map live'">
                      <img style="width: 100% !important;"
                        src="{{getMap}}center={{latitude}}&zoom=18&size=300x300&markers=color:red%7Clabel:S%7C{{item.message}}">
                        
                    </a> -->
                      <p *ngIf="item.filetype=='map live'" >
                        <img style="width: 100% !important;"
                          src="{{getMap}}center={{latitude}}&zoom=18&size=300x300&markers=color:red%7Clabel:S%7C{{item.message}}">
        
                      </p>
                      <!-- <p *ngIf="item.livelocation!='undefined' &&(item.livelocation=='false' || item.livelocation==false)"
                        style="font-size: 14px;text-align:center;height: 0px;color: #b3aea8;">Live Location Ended</p>
         -->
                      <!-- <button *ngIf="item.filetype=='map live' && item.livelocation=='true' || item.livelocation==true" style="border-radius: 10px;width: 100%;background: #ff656c !important;
                    color: white;" ion-button full >
                        <ion-icon style="position: relative;
                      top: 3px;" name="navigate-outline"></ion-icon>&nbsp;live location
                      </button> -->
        
                      <!-- <br/> -->
        
                      <!--Audio file-->
                      <audio style="max-width: 100%;"  *ngIf="item.filetype=='audio' || item.filetype=='mp3'" controls controlsList="nodownload">
        
                        <source [src]="sanitizer.bypassSecurityTrustUrl(item.message)" type="audio/ogg">
                        <source [src]="sanitizer.bypassSecurityTrustUrl(item.message)" type="audio/mpeg">
                      </audio>
        
        
                      <!--Video file-->
                      <video style="max-width: 100%;"  *ngIf="item.filetype=='mp4' || item.filetype=='avi' || item.filetype=='flv'" width="200"
                        height="125" preload="none" controls controlsList="nodownload">
                        <source [src]="sanitizer.bypassSecurityTrustUrl(item.message)" type="video/mp4">
                        <source [src]="sanitizer.bypassSecurityTrustUrl(item.message)" type="video/ogg">
        
                      </video>
        
                      <!-- <div> -->
                      <span class="time" text-right style="margin-top: 8px;">
                        {{item.timestamp | date: "hh:mm a"  }}
                      </span>
                      <!-- </div> -->
        
                    </div>
                    <!-- Event message -->
                    <div *ngIf="item.filetype=='event'">
                      <p class="chatbubble-left">
                        <span style="margin: 0 auto;display: block;">
                          <ion-icon class="calendar" name="calendar"></ion-icon> <br>
                        </span>
                        <span style="max-width: 100%;" class="eventmsg">{{ item.message }}</span><br>
                        <!-- <span *ngIf="item.status == '1'" class="invitebtn"
                        (click)="save_event(item.message,item)">Accept & Save</span> -->
                        <ion-button expand="block">Accept
                        </ion-button>
                      </p>
                    </div>
                  
                    <ion-icon class="favouriteicon" *ngIf="item.favourite==1" name="star"></ion-icon>
                  </div>
                </ion-col>
        
        
                <!--me-->
                <ion-col  size="9"
                  *ngIf="item.sentby === currentUser&& item.filetype!='title' &&  item.filetype!='video text' && item.filetype!='call text'"
                  class="message my-message">
                  <p *ngIf="item.sentby == currentUser" style="font-size: 14px;margin-left:13px;"> You to {{item.username}} {{item.timestamp | date: "dd/MM/yyyy"}}</p>
                  <br/>
                  <div class="chatbubble-right" style="float:inherit;margin-top:-35px;">
        
                    <div
                      *ngIf="item.forwardmsg!=null && item.forwardmsg!='null' && item.forwardmsg!='undefined' && item.forwardmsg!=currentUser"
                      style="    font-size: 13px;
                    font-style: italic;
                color: lightgray;">
                      <i class="fa fa-share" aria-hidden="true"></i> Forwarded
        
                    </div>
        
                    <!--Reply Tag text-->
                    <span
                      *ngIf="item.tagmessage!='' && item.tagmessage!=null && item.tagmessage!='undefined' && item.tagmessage!='null'"
                      >
        
                      <span *ngIf="item.tagfiletype=='text'" style="white-space: pre-line !important;" text-wrap
                        [innerHTML]="item.tagmessage "></span>
        
                      <!--Image file-->
                      <div
                        *ngIf="item.tagfiletype=='image' || item.tagfiletype=='JPG' || item.tagfiletype=='jpg' || item.tagfiletype=='png' || item.tagfiletype=='PNG' || item.tagfiletype=='JPEG' || item.tagfiletype=='jpeg' || item.tagfiletype=='gif' || item.tagfiletype=='GIF'">
                        <img src="{{item.tagmessage}}">
                      </div>
                      <!--Any document-->
        
                      <div>
        
                        <a
                          *ngIf="item.tagfiletype=='dotx' ||item.tagfiletype=='doc' || item.tagfiletype=='dot' || item.tagfiletype=='docx'">
        
                          <p text-wrap class="fileexten">{{item.tagfileextension}}</p>
                        </a>
                        <a
                          *ngIf="item.tagfiletype=='xls' || item.tagfiletype=='xlsx' || item.tagfiletype=='xlt'|| item.tagfiletype=='xla' ">
        
                          <p text-wrap class="fileexten">{{item.tagfileextension}}</p>
                        </a>
        
                        <a *ngIf="item.tagfiletype=='txt' || item.tagfiletype=='TXT'">
        
                          <p text-wrap class="fileexten">{{item.tagfileextension}}</p>
                        </a>
        
                        <a *ngIf="item.tagfiletype=='pdf' || item.tagfiletype=='PDF'">
        
                          <p text-wrap class="fileexten">{{item.tagfileextension}}</p>
                        </a>
                        <a
                          *ngIf="item.tagfiletype=='pps' || item.tagfiletype=='ppa'  || item.tagfiletype=='pptx' || item.tagfiletype=='potx'">
        
                          <p text-wrap class="fileexten">{{item.tagfileextension}}</p>
                        </a>
        
                      </div>
        
        
                      <!--Location-->
                      <a *ngIf="item.Taglocation=='true'">
                        <img
                          src="{{getMap}}center={{item.latitude}}&zoom=18&size=300x300&markers=color:red%7Clabel:S%7C{{item.latitude}}">
                      </a>
        
                      <!--Audio file-->
                      <audio style="max-width: 100%;"  *ngIf="item.tagfiletype=='audio' || item.tagfiletype=='mp3'" controls controlsList="nodownload">
                        <source [src]="sanitizer.bypassSecurityTrustUrl(item.tagmessage)" type="audio/ogg">
                        <source [src]="sanitizer.bypassSecurityTrustUrl(item.tagmessage)" type="audio/mpeg">
                      </audio>
                      <!--Video file-->
                      <video style="max-width: 100%;"  *ngIf="item.tagfiletype=='mp4' || item.tagfiletype=='avi' || item.tagfiletype=='flv'" width="200"
                        preload="none" height="125" controls controlsList="nodownload">
                        <source [src]="sanitizer.bypassSecurityTrustUrl(item.tagmessage)" type="video/mp4">
                        <source [src]="sanitizer.bypassSecurityTrustUrl(item.tagmessage)" type="video/ogg">
                      </video>
        
                      <p class="stable singleTick" *ngIf="item.tagtime!='undefined' && item.tagtime!=''">{{item.tagtime | date: "hh:mm a"  }} </p>
                      <h6></h6>
                    </span>
        
        
                    <!-- {{ item.message }} -->
        
                    <div>
                      <!-- <span *ngIf="item.filetype=='text' && item.message!='' && hidetext(item)"
                        style="white-space: pre-line !important;color: black;" text-wrap
                        [innerHTML]="item.message "></span> -->
                        <div></div>
        
                      <div *ngIf="!item.showMore">
                        <span *ngIf="item.filetype=='text' && item.message!='' && hidetext(item)"
                          style="white-space: pre-line !important;color: black;max-width:100%;" text-wrap
                          [innerHTML]="trimString(item.message,200)">
                          </span>
                         
                          
                      </div>
                      <div *ngIf="item.showMore">
        
                        <span *ngIf="item.filetype=='text' && item.message!='' && hidetext(item)"
                          style="white-space: pre-line !important;color: black;max-width:100%;" text-wrap
                          [innerHTML]="item.message">
                          
                        </span>
                        
                        
                          
                      </div>
                      <a *ngIf="item.message.length>200  && item.filetype=='text'" style="color: #039be5;cursor: pointer;font-size: 14px;"
                        (click)="item.showMore = !item.showMore">Read <span [innerHtml]="item.showMore ? 'less' : 'More'">
                        </span>
                      </a>
        
                      <!-- <span *ngIf="item.filetype=='text' && item.message!='' && hidetext(item)"
                        style="white-space: pre-line !important;color: black;" text-wrap >{{item.message}}</span>
                      -->
                      <!-- 
                    <div *ngIf="item.filetype=='text' && item.message!=''">
                      <span *ngIf="hidetext(item)" [hidden]="selfdestruct"
                        style="white-space: pre-line !important;color: black;margin-right: 15px;" text-wrap
                        [innerHTML]="item.message"></span>
                    </div> -->
        
        
                      <img style="object-fit: cover;width:245px;height:245px;margin-bottom: 10px;"
                        [src]="sanitizer.bypassSecurityTrustUrl(item.message)"
                        *ngIf="item.filetype=='image' || item.filetype=='JPG' || item.filetype=='jpg' || item.filetype=='png' || item.filetype=='PNG' || item.filetype=='JPEG' || item.filetype=='jpeg' || item.filetype=='gif' || item.filetype=='GIF'"
                        >
        
                      <!--Doc format-->
                      <a *ngIf="item.filetype=='dotx' ||item.filetype=='doc' || item.filetype=='dot' || item.filetype=='docx'"
                        >
                        <img style="height:35px;" src="assets/imgs/wordDoc.png">
                        <h6 text-wrap class="fileexten">{{item.fileextension}}</h6>
                      </a>
        
                      <!--XLS format-->
                      <div
                        *ngIf="item.filetype=='xls' || item.filetype=='xlsx' || item.filetype=='xlt'|| item.filetype=='xla'"
                        >
                        <img style="height:35px;" src="assets/imgs/excelDoc.png">
                        <h6 text-wrap class="fileexten">{{item.fileextension}}</h6>
                      </div>
                      <!--PDF Format-->
                      <div *ngIf="item.filetype=='pdf' || item.filetype=='PDF'"
                        >
                        <img style="height:35px;" src="assets/imgs/pdfDoc.png">
                        <h6 text-wrap class="fileexten">{{item.fileextension}}</h6>
                      </div>
        
                      <!--Txt Format-->
                      <a *ngIf="item.filetype=='txt' || item.filetype=='TXT'"
                        >
                        <img style="height:35px;" src="assets/imgs/txtFormat.png">
                        <span text-wrap class="fileexten">{{item.fileextension}}</span>
                      </a>
        
                      <!--PPT format-->
                      <a *ngIf="item.filetype=='pps' || item.filetype=='ppa'  || item.filetype=='pptx' || item.filetype=='potx'"
                        >
                        <img style="height:35px;" src="assets/imgs/ppt.png">
                        <h6 text-wrap class="fileexten">{{item.fileextension}}</h6>
                      </a>
        
                      <!--google location file-->
                      <a *ngIf="item.filetype=='map'">
                        <img style="width: 100% !important;"
                          src="{{getMap}}center={{latitude}}&zoom=18&size=300x300&markers=color:red%7Clabel:S%7C{{item.message}}">
                      </a>
                      <p *ngIf="item.filetype=='map live'" >
                        <img style="width: 100% !important;"
                          src="{{getMap}}center={{latitude}}&zoom=18&size=300x300&markers=color:red%7Clabel:S%7C{{item.message}}">
                      </p>
        
                      <!-- <p *ngIf="item.livelocation!='undefined' &&(item.livelocation=='false' || item.livelocation==false)"
                        style="font-size: 14px;text-align:center;height: 0px;color: #b3aea8;">Live Location Ended</p> -->
        
                      <div *ngIf="item.filetype=='map live' && (item.livelocation=='true' || item.livelocation==true)">
                      
        
                      
                        <br />
                      </div>
        
        
                      <!-- <br/> -->
        
                      <!--Audio file-->
                      <audio style="    max-width: 100%;" *ngIf="item.filetype=='audio' || item.filetype=='mp3'" controls controlsList="nodownload">
        
                        <source [src]="sanitizer.bypassSecurityTrustUrl(item.message)" type="audio/ogg">
                        <source [src]="sanitizer.bypassSecurityTrustUrl(item.message)" type="audio/mpeg">
                      </audio>
        
        
                      <!--Video file-->
                      <video style="    max-width: 100%;" *ngIf="item.filetype=='mp4' || item.filetype=='avi' || item.filetype=='flv'" width="200"
                        height="125" preload="none" controls controlsList="nodownload">
                        <source [src]="sanitizer.bypassSecurityTrustUrl(item.message)" type="video/mp4">
                        <source [src]="sanitizer.bypassSecurityTrustUrl(item.message)" type="video/ogg">
        
                      </video>
        
        
                      <!--Document's-->
                      <span class="time" text-right style="float:right;right:7px;"
                        *ngIf="item.status=='0' && item.message!='' && (item.filetype=='pptx' || item.filetype=='ppa' || item.filetype=='pps' || item.filetype=='xlsx' || item.filetype=='xls' || item.filetype=='PDF' || item.filetype=='pdf' || item.filetype=='dotx' ||item.filetype=='doc' || item.filetype=='dot' || item.filetype=='docx')"
                        class="stable singleTick">{{item.timestamp | date: "hh:mm a"  }}<span style="color: gray !important;">
                        
        
                        </span></span>
                      <span class="time" text-right style="float:right;right:7px;"
                        *ngIf=" item.filetype!='video text' && item.filetype!='call text' && item.status=='1' && item.message!='' && (item.filetype=='pptx' || item.filetype=='ppa' || item.filetype=='pps' || item.filetype=='xlsx' || item.filetype=='xls' || item.filetype=='PDF' || item.filetype=='pdf' || item.filetype=='dotx' ||item.filetype=='doc' || item.filetype=='dot' || item.filetype=='docx')"
                        class="stable singleTick">{{item.timestamp | date: "hh:mm a"  }} <span
                          style="color: gray !important;">
                        
                        </span></span>
                      <span class="time" text-right style="float:right;right:7px;"
                        *ngIf=" item.filetype!='video text' && item.filetype!='call text' && item.status=='2' && item.message!='' && (item.filetype=='pptx' || item.filetype=='ppa' || item.filetype=='pps' || item.filetype=='xlsx' || item.filetype=='xls' || item.filetype=='PDF' || item.filetype=='pdf' || item.filetype=='dotx' ||item.filetype=='doc' || item.filetype=='dot' || item.filetype=='docx')"
                        class="stable singleTick">{{item.timestamp | date: "hh:mm a"  }} <span
                          style="color: #4fc3f7 !important; ">
                        
        
                        </span></span>
        
                      <!--Chat status tick-->
        
                      <span class="time" text-right style="float:right;right:7px;"
                        *ngIf="item.filetype!='video text' && item.filetype!='call text' && item.status=='0' && item.message!='' && (item.filetype=='mp4' || item.filetype=='avi' || item.filetype=='flv' || item.filetype=='mp3' || item.filetype=='audio' || item.location=='true' || item.filetype=='image' || item.filetype=='JPG' || item.filetype=='jpg' || item.filetype=='png' || item.filetype=='PNG' || item.filetype=='JPEG' || item.filetype=='jpeg' || item.filetype=='gif' || item.filetype=='GIF')"
                        class="stable singleTick">{{item.timestamp | date: "hh:mm a"  }} <span
                          style="color: gray !important;">
                        
        
                        </span></span>
                      <span class="time" text-right style="float:right;right:7px;"
                        *ngIf="item.filetype!='video text' && item.filetype!='call text' && item.status=='1' && item.message!='' && (item.filetype=='mp4' || item.filetype=='avi' || item.filetype=='flv' ||  item.filetype=='mp3' || item.filetype=='audio' || item.location=='true' || item.filetype=='image' || item.filetype=='JPG' || item.filetype=='jpg' || item.filetype=='png' || item.filetype=='PNG' || item.filetype=='JPEG' || item.filetype=='jpeg' || item.filetype=='gif' || item.filetype=='GIF')"
                        class="stable singleTick">{{item.timestamp | date: "hh:mm a"  }} <span
                          style="color: gray !important;">
                          
                        </span></span>
                      <span class="time" text-right style="float:right;right:7px;"
                        *ngIf="item.filetype!='video text' && item.filetype!='call text' && item.status=='2' && item.message!='' && (item.filetype=='mp4' || item.filetype=='avi' || item.filetype=='flv' || item.filetype=='mp3' || item.filetype=='audio' || item.location=='true'  || item.filetype=='image' || item.filetype=='JPG' || item.filetype=='jpg' || item.filetype=='png' || item.filetype=='PNG' || item.filetype=='JPEG' || item.filetype=='jpeg' || item.filetype=='gif' || item.filetype=='GIF')"
                        class="stable singleTick">{{item.timestamp | date: "hh:mm a"  }} <span
                          style="color: #4fc3f7 !important; ">
                          
                        </span></span>
        
                      <!--Text ststus-->
                      <span class="time" text-right style="float:right"
                        *ngIf="item.filetype!='video text' && item.filetype!='call text' && item.status=='0' && item.message!='' && item.filetype!='mp4' && item.filetype!='avi' && item.filetype!='flv' && item.filetype!='mp3'  && item.filetype!='audio' && item.location!='true' && item.filetype!='pptx' && item.filetype!='ppa' && item.filetype!='pps' && item.filetype!='xlsx' && item.filetype!='xls' && item.filetype!='PDF' && item.filetype!='pdf' && item.filetype!='dotx' && item.filetype!='doc' && item.filetype!='dot' && item.filetype!='docx' && item.filetype!='image' && item.filetype!='JPG' && item.filetype!='jpg' && item.filetype!='png' && item.filetype!='PNG' && item.filetype!='JPEG' && item.filetype!='jpeg' && item.filetype!='gif' && item.filetype!='GIF'"
                        class="stable singleTick">{{item.timestamp | date: "hh:mm a"  }}
                       
                      </span>
                      <span text-right
                        *ngIf="item.filetype!='video text' && item.filetype!='call text' && item.status=='1' && item.message!='' && item.filetype!='mp4' && item.filetype!='avi' && item.filetype!='flv' &&  item.filetype!='mp3' && item.filetype!='audio' && item.location!='true' && item.filetype!='pptx' && item.filetype!='ppa' && item.filetype!='pps' && item.filetype!='xlsx' && item.filetype!='xls' && item.filetype!='PDF' && item.filetype!='pdf' && item.filetype!='dotx' && item.filetype!='doc' && item.filetype!='dot' && item.filetype!='docx' && item.filetype!='image' && item.filetype!='JPG' && item.filetype!='jpg' && item.filetype!='png' && item.filetype!='PNG' && item.filetype!='JPEG' && item.filetype!='jpeg' && item.filetype!='gif' && item.filetype!='GIF'"
                        class="stable singleTick">{{item.timestamp | date: "hh:mm a"  }} <span
                          style="color: gray !important;">
                         
                        </span></span>
                      <span class="time" text-right style="float:right"
                        *ngIf="item.filetype!='video text' && item.filetype!='call text' && item.status=='2' && item.message!='' && item.filetype!='mp4' && item.filetype!='avi' && item.filetype!='flv' && item.filetype!='mp3' && item.filetype!='audio' && item.location!='true' && item.filetype!='pptx' && item.filetype!='ppa' && item.filetype!='pps' && item.filetype!='xlsx' && item.filetype!='xls' && item.filetype!='PDF' && item.filetype!='pdf' && item.filetype!='dotx' && item.filetype!='doc' && item.filetype!='dot' && item.filetype!='docx' && item.filetype!='image' && item.filetype!='JPG' && item.filetype!='jpg' && item.filetype!='png' && item.filetype!='PNG' && item.filetype!='JPEG' && item.filetype!='jpeg' && item.filetype!='gif' && item.filetype!='GIF'"
                        class="stable singleTick">{{item.timestamp | date: "hh:mm a"  }}
                      
                      </span>
                    </div>
                    <!-- Event Message -->
                    <div *ngIf="item.filetype=='event'">
                      <p class="chatbubble-right">
                        <span style="margin: 0 auto;display: block;">
                          <ion-icon class="calendar" name="calendar"></ion-icon> <br>
                        </span>
                        <span style="max-width: 100%;" class="eventmsg">{{item.message}}</span>
                        <!-- <span class="time" text-right><br>{{ item.timestamp | date:'shortTime' }}</span> -->
                      </p>
                    </div>
                    <ion-icon class="favouriteicon" *ngIf="item.favourite==1" name="star"></ion-icon>
                  </div>
                </ion-col>
        
        
                <!-- <ion-col size="9" *ngIf="item.sentby !== currentUser&&item.filetype=='event'" class="message my-message">
                <p class="chatbubble-left">
                  <span style="margin: 0 auto;display: block;">
                    <ion-icon class="calendar" name="calendar"></ion-icon> <br>
                  </span>
                  <span class="eventmsg">{{ item.message }}</span><br> <span class="invitebtn"
                    (click)="save_event(item.message)">Accept & Save</span><span class="time"
                    text-right><br>{{ item.timestamp | date:'shortTime' }}</span></p>
              </ion-col>
        
              <ion-col offset="3" size="9" *ngIf="item.sentby === currentUser&&item.filetype=='event'"
                style="margin-left: 0 !important;" class="message my-message">
                <p class="chatbubble-right">
                  <span style="margin: 0 auto;display: block;">
                    <ion-icon class="calendar" name="calendar"></ion-icon> <br>
                  </span>
                  <span class="eventmsg">{{ item.message }}</span> <span class="time"
                    text-right><br>{{ item.timestamp | date:'shortTime' }}</span></p>
              </ion-col> -->
              </ion-row>
            </div>
          </ion-grid>
        </div>

      </div>
    </div>
    <div *ngIf="nodata" class="rightcontact">
      <div class="rightdiv">
        <div class="holechat"></div>


        <div class="chatwindow" style="margin: 0 auto;position: relative;left: 10%; ">


          <!-- <img class="flintahand" style="margin:0 auto" src="assets/imgs/hand.jpg" />
          <p class="welcome" style="margin:0 auto;position: relative;left:-100px">Flinta</p>
          <p
            style="font-size: 20px; margin-left: 1%;color:gray;margin-top: -6px;margin:0 auto;position: relative;left:-100px">
            Flinta helps you to chat the peoples</p> -->
        </div>

      </div>
    </div>


    <div *ngIf="buddychatright" class="rightcontact">


      <div #content class="rightdiv">
        <!-- <div class="holechat"></div> -->
        <div>
          <header class="rightheader">

            <div text-left style="width: auto !important;">

              <img
                *ngIf="buddydetails!=undefined && buddydetails.photourl!=undefined && buddydetails.photourl!='default'"
                (click)="viewPhoto(buddydetails.photourl)"
                [src]="sanitizer.bypassSecurityTrustUrl(buddydetails.photourl)" class="profileimage">
              <img *ngIf="buddydetails.photourl==undefined || buddydetails.photourl=='default'"
                (click)="singleclickEVent()" src="assets/imgs/chatterplace.png" class="profileimage">

              <div style="margin-top: -37px;
                margin-left: 40px;">

                <div *ngIf="searchinput==false" (click)="singleclickEVent()">
                  <span class="buddyusername"
                    style="margin-left: 30px;font-size: 14px;text-transform: capitalize;">{{buddydetails.username}}</span><br />
                  <span class="buddyusername" *ngIf="BuddyTyping==false && buddydetails!=undefined && buddydetails.status=='offline'"
                    style="margin-left: 30px;font-size: 12px;font-weight: normal;">last seen
                    {{buddydetails.last_changed | date: "MMM dd, y hh:mm a"}}</span>

                  <span class="buddyusername" *ngIf="BuddyTyping==false && buddydetails!=undefined && buddydetails.status=='Offline'"
                    style="margin-left: 30px;font-size: 12px;font-weight: normal;">offline</span>

                  <span class="buddyusername" *ngIf="BuddyTyping==false && buddydetails!=undefined && buddydetails.status=='online'"
                    style="margin-left: 30px;font-size: 12px;">{{buddydetails.status}}</span>
                  <span class="buddyusername" *ngIf="BuddyTyping==true" style="margin-left: 31px;font-size: 15px;">typing...</span>
                  <span class="buddyusername" *ngIf="buddydetails.status==undefined"
                    style="margin-left: 30px;font-size: 12px;">loading...</span>


                </div>

                <div style="margin-top: -7px;position: relative;right:100px">

                  <!-- <img *ngIf=" searchinput==false && forwardFlag==false && deleteFlag==false && deleteFlag1==false" style="float: right;display:-webkit-inline-box !important;margin-right: 15px; margin-top: -35px;
                      height: 36px;" src="assets/call.png" (click)="audioCall()" />
            
                      <img *ngIf="searchinput==false && forwardFlag==false && deleteFlag==false && deleteFlag1==false" style="float: right;display:-webkit-inline-box !important;margin-right: 30px; margin-top: -35px;
                 height: 32px;;" src="assets/video.png" (click)="videoCall()" /> -->

                 <ion-icon *ngIf=" searchinput==false && forwardFlag==false && deleteFlag==false && deleteFlag1==false && buddydetails.status=='online'" style="float: right;display:-webkit-inline-box !important;margin-right: 15px; margin-top: -35px;
                 height: 36px;font-size:26px;cursor:pointer;color:#fff" name="call" (click)="audioCall()"></ion-icon>
                
                <ion-icon name="videocam" *ngIf="searchinput==false && forwardFlag==false && deleteFlag==false && deleteFlag1==false && buddydetails.status=='online'" style="float: right;display:-webkit-inline-box !important;margin-right: 30px; margin-top: -35px;
                height: 32px;font-size:26px;cursor:pointer;color:#fff" (click)="videoCall()"></ion-icon>

                  <ion-searchbar #inputId style='margin-left:130px;width:80%;background-color:transparent' *ngIf="searchinput==true" [(ngModel)]="searchTerms"
                    [showCancelButton]="false" (keyup)="filteritems($event)" (ionClear)="onCancel($event)"></ion-searchbar>




                </div>
                <span *ngIf=" searchinput==false && forwardFlag==false && deleteFlag==false && deleteFlag1==false" class="ellipseicon" style="float: right;display:-webkit-inline-box !important;margin-right: 15px; margin-top: -35px;
                    height: 36px;">
                  <ion-icon (click)="menuCLick()" title="Menu" name="ellipsis-vertical"></ion-icon>

                </span>

                <button *ngIf="forwardFlag==true" ion-button style="float: right;
                    display: -webkit-inline-box !important;
                    margin-right: 57px;
                    margin-top: -35px;
                    height: 28px;
                    border-radius: 15px;background:none" (click)="forward()">
                  <ion-icon style="font-size:36px" class="buddyusername" title="Forward" name="return-up-forward-outline"></ion-icon>
                </button>
           
                <button *ngIf="deleteFlag==true" ion-button style="float: right;
                    display: -webkit-inline-box !important;
                    margin-right: 0px;
                    margin-top: -28px;
                    height: 28px;
                    border-radius: 15px;background:none" (click)="deleteFunction()">
                  <ion-icon style="font-size: 25px;" class="buddyusername" title="Delete" name="trash-outline"></ion-icon>
                </button>
                <button *ngIf="deleteFlag1==true" ion-button style="float: right;
                display: -webkit-inline-box !important;
                margin-right: 0px;
                margin-top: -28px;
                height: 28px;
                border-radius: 15px;background:none" (click)="deleteFunction1()">
              <ion-icon style="font-size: 25px;" class="buddyusername" title="Delete" name="trash-outline"></ion-icon>
            </button>

              </div>
            </div>


          </header>
          <!-- <ion-refresher slot="fixed" (ionRefresh)="getUsersList($event)">
            <ion-refresher-content></ion-refresher-content>

          </ion-refresher> -->

          <div id="messagesContent" #scrollMe style="overflow-y:scroll" (scroll)="myFunction($event)" [scrollEvents]="true">


            <ion-grid>
              <div *ngFor="let item of allmessages;let i = index;">

                <ion-row id="chatrow{{i}}" (press)="onPress($event,item,i)" (pressup)="onPressUp($event)"
                  [style.touch-action]="'pan-y'" [ngStyle]="{'background-color': item.selectedColor}">

                  <ion-row style="width: 100%;" *ngIf="item.timeset!=null && item.timeset!=undefined ">
                    <div class="timestampdate">{{item.timeset}}</div><br />
                  </ion-row>
                  <!--Forward selection-->
                  <ion-checkbox color="dark" *ngIf="forwardClick==true || deleteFlag==true || deleteFlag1==true" [(ngModel)]="item.selected"
                    (ionChange)="forwardSelection(item.selected,item)" item-right checked="false">
                  </ion-checkbox>
                  <ion-row style="width: 100%;" *ngIf="item.unreadMessageCount!=null && item.unreadMessageCount!=''">
                    <div class="timestampdate">{{item.unreadMessageCount}}</div><br />
                  </ion-row>
                  <ion-row style="width: 100%;" *ngIf="item.filetype=='call text'">
                    <div class="timestampdate"><span style="color: red;" data-testid="miss" data-icon="miss"
                        class="_25zst">
                        <!-- <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 17" width="20" height="17"><path fill="currentColor" d="M18.2 12.1c-1.5-1.8-5-2.7-8.2-2.7s-6.7 1-8.2 2.7c-.7.8-.3 2.3.2 2.8.2.2.3.3.5.3 1.4 0 3.6-.7 3.6-.7.5-.2.8-.5.8-1v-1.3c.7-1.2 5.4-1.2 6.4-.1l.1.1v1.3c0 .2.1.4.2.6.1.2.3.3.5.4 0 0 2.2.7 3.6.7.2 0 1.4-2 .5-3.1zM5.4 3.2l4.7 4.6 5.8-5.7-.9-.8L10.1 6 6.4 2.3h2.5V1H4.1v4.8h1.3V3.2z"></path></svg></span> -->
                        <ion-icon style="color: red;font-size: 12.5px;pointer-events:none" name="call-outline"></ion-icon>
                      </span><span style="font-size: 12.5px;">&nbsp; {{item.message}}</span> </div><br />
                  </ion-row>

                  <ion-row style="width: 100%;" *ngIf="item.filetype=='video text'">
                    <div class="timestampdate"><span style="color: red;" data-testid="miss" data-icon="miss"
                        class="_25zst">
                        <!-- <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 17" width="20" height="17"><path fill="currentColor" d="M18.2 12.1c-1.5-1.8-5-2.7-8.2-2.7s-6.7 1-8.2 2.7c-.7.8-.3 2.3.2 2.8.2.2.3.3.5.3 1.4 0 3.6-.7 3.6-.7.5-.2.8-.5.8-1v-1.3c.7-1.2 5.4-1.2 6.4-.1l.1.1v1.3c0 .2.1.4.2.6.1.2.3.3.5.4 0 0 2.2.7 3.6.7.2 0 1.4-2 .5-3.1zM5.4 3.2l4.7 4.6 5.8-5.7-.9-.8L10.1 6 6.4 2.3h2.5V1H4.1v4.8h1.3V3.2z"></path></svg></span> -->
                        <ion-icon style="color: red;font-size: 12.5px;pointer-events:none" name="videocam-outline"></ion-icon>
                      </span> <span style="font-size: 12.5px;"> &nbsp;&nbsp;{{item.message}}</span></div><br />
                  </ion-row>


                  <div *ngIf="item.filetype=='title'" class="timestampdate">{{item.message}}</div><br />

                  <!--friend-->
                  <ion-col size="9"
                    *ngIf="item.sentby !== currentUser&& item.filetype!='title' && item.filetype!='video text' && item.filetype!='call text'"
                    class="message other-message">
                    <div class="chatbubble-left">


                      <div>
                        <span style="display: none;" id=singlechat{{i}}>{{ item.message }}</span>
                        <i style="float: right;" (click)="singlechatcopyPopover($event,i);$event.stopPropagation()"
                          class="fa fa-angle-down recentdropdown2" aria-hidden="true">
                        </i>
                      </div>
                      <div
                        *ngIf="item.forwardmsg!=null && item.forwardmsg!='undefined' && item.forwardmsg!='null' && item.forwardmsg!=buddydetails.mobile"
                        style="    font-size: 13px;
                        font-style: italic;
                    color: lightgray;">
                        <i class="fa fa-share" aria-hidden="true"></i> Forwarded
                      </div>
                      <!--Reply Tag text-->
                      <span *ngIf="item.filetype == 'mom'" [innerHTML]="item.message | highlightPipe:searchTerms"></span>

                      <span
                        *ngIf="item.tagmessage!='' && item.tagmessage!=null && item.tagmessage!='undefined' && item.tagmessage!='null'"
                        style="color: #E91E63;  background-color: #cfe9ba;
                          width: 100%;max-width: 100%;">

                        <span *ngIf="item.tagfiletype=='text'" style="max-width: 100%;white-space: pre-line !important;"
                          text-wrap [innerHTML]="item.tagmessage | highlightPipe:searchTerms"></span>

                        <!--Image file-->
                        <div
                          *ngIf="item.filetype=='image' || item.filetype=='JPG' || item.filetype=='jpg' || item.filetype=='png' || item.filetype=='PNG' || item.filetype=='JPEG' || item.filetype=='jpeg' || item.filetype=='gif' || item.filetype=='GIF'">

                          <div
                            *ngIf="item.tagfiletype=='image' || item.tagfiletype=='JPG' || item.tagfiletype=='jpg' || item.tagfiletype=='png' || item.tagfiletype=='PNG' || item.tagfiletype=='JPEG' || item.tagfiletype=='jpeg' || item.tagfiletype=='gif' || item.tagfiletype=='GIF'">
                            <img src="{{item.tagmessage}}">
                          </div>
                          <br />
                        </div>
                        <!--Any document-->

                        <div>

                          <a
                            *ngIf="item.tagfiletype=='dotx' ||item.tagfiletype=='doc' || item.tagfiletype=='dot' || item.tagfiletype=='docx'">

                            <p text-wrap class="fileexten">{{item.tagfileextension}}</p>
                          </a>
                          <a
                            *ngIf="item.tagfiletype=='xls' || item.tagfiletype=='xlsx' || item.tagfiletype=='xlt'|| item.tagfiletype=='xla' ">

                            <p text-wrap class="fileexten">{{item.tagfileextension}}</p>
                          </a>

                          <a *ngIf="item.tagfiletype=='txt' || item.tagfiletype=='TXT'">

                            <p text-wrap class="fileexten">{{item.tagfileextension}}</p>
                          </a>

                          <a *ngIf="item.tagfiletype=='pdf' || item.tagfiletype=='PDF'">

                            <p text-wrap class="fileexten">{{item.tagfileextension}}</p>
                          </a>
                          <a
                            *ngIf="item.tagfiletype=='pps' || item.tagfiletype=='ppa'  || item.tagfiletype=='pptx' || item.tagfiletype=='potx'">

                            <p text-wrap class="fileexten">{{item.tagfileextension}}</p>
                          </a>

                        </div>


                        <!--Location-->
                        <a *ngIf="item.Taglocation=='true'">
                          <img
                            src="{{getMap}}center={{item.latitude}}&zoom=18&size=300x300&markers=color:red%7Clabel:S%7C{{item.latitude}}">
                        </a>

                        <!--Audio file-->
                        <audio *ngIf="item.tagfiletype=='audio' || item.tagfiletype=='mp3'" controls
                          controlsList="nodownload">
                          <source [src]="sanitizer.bypassSecurityTrustUrl(item.tagmessage)" type="audio/ogg">
                          <source [src]="sanitizer.bypassSecurityTrustUrl(item.tagmessage)" type="audio/mpeg">
                        </audio>
                        <!--Video file-->
                        <video *ngIf="item.tagfiletype=='mp4' || item.tagfiletype=='avi' || item.tagfiletype=='flv'"
                          width="200" preload="none" height="125" controls controlsList="nodownload">
                          <source [src]="sanitizer.bypassSecurityTrustUrl(item.tagmessage)" type="video/mp4">
                          <source [src]="sanitizer.bypassSecurityTrustUrl(item.tagmessage)" type="video/ogg">
                        </video>

                        <p class="stable singleTick">{{item.tagtime | date: "hh:mm a"  }} </p>
                        <!--| lowercase-->
                        <h6></h6>
                      </span>
                      <div>
                        <!-- [hidden]="selfdestruct" -->

                        <!-- <span *ngIf="!item.showMore"> -->



                        <span
                          *ngIf=" item.message!=null &&  !item.showMore && item.filetype=='text' && item.message!=''"
                          style="max-width: 100%;white-space: pre-line !important;color: black;margin-right: 15px;"
                          text-wrap [innerHTML]="trimString(item.message,150)| highlightPipe:searchTerms"></span>

                        <!-- </div> -->
                        <!-- <div *ngIf="item.showMore"> -->

                        <span *ngIf="item.showMore &&item.filetype=='text' && item.message!='' && hidetext(item)"
                          style="max-width: 100%;white-space: pre-line !important;color: black;" text-wrap
                          [innerHTML]="item.message| highlightPipe:searchTerms"></span>

                        <!-- </div> -->
                        <a *ngIf="item.message.length>150&&item.filetype=='text' "
                          style="max-width: 100%;color: #039be5;cursor: pointer;font-size: 14px;"
                          (click)="item.showMore = !item.showMore">Read<span
                            [innerHtml]="item.showMore ? 'less' : 'More'">
                          </span>
                        </a>



                        <div
                          *ngIf="item.filetype=='image' || item.filetype=='JPG' || item.filetype=='jpg' || item.filetype=='png' || item.filetype=='PNG' || item.filetype=='JPEG' || item.filetype=='jpeg' || item.filetype=='gif' || item.filetype=='GIF'">

                          <img style="object-fit: cover;width:245px;height:245px;margin-bottom: 10px;"
                            [src]="sanitizer.bypassSecurityTrustUrl(item.message)"
                            *ngIf="item.filetype=='image' || item.filetype=='JPG' || item.filetype=='jpg' || item.filetype=='png' || item.filetype=='PNG' || item.filetype=='JPEG' || item.filetype=='jpeg' || item.filetype=='gif' || item.filetype=='GIF'"
                            (click)="ZoomFile(item.message)">
                          <br />
                        </div>
                        <!--Doc format-->
                        <a *ngIf="item.filetype=='dotx' ||item.filetype=='doc' || item.filetype=='dot' || item.filetype=='docx'"
                          (click)="getPermission(item.message,item.fileextension,item.filetype)">
                          <img style="height:35px;" src="assets/imgs/wordDoc.png">
                          <ion-icon class="downloadarrowdropdown" name="arrow-down-circle-outline"></ion-icon>
                          <h6 text-wrap class="fileexten">{{item.fileextension}}</h6>
                        </a>

                        <!--XLS format-->
                        <div
                          *ngIf="item.filetype=='xls' || item.filetype=='xlsx' || item.filetype=='xlt'|| item.filetype=='xla'"
                          (click)="getPermission(item.message,item.fileextension,item.filetype)">
                          <img style="height:35px;" src="assets/imgs/excelDoc.png">
                          <ion-icon class="downloadarrowdropdown" name="arrow-down-circle-outline"></ion-icon>
                          <h6 text-wrap class="fileexten">{{item.fileextension}}</h6>
                        </div>
                        <!--PDF Format-->
                        <div *ngIf="item.filetype=='pdf' || item.filetype=='PDF'"
                          (click)="getPermission(item.message,item.fileextension,item.filetype)">
                          <img style="height:35px;" src="assets/imgs/pdfDoc.png">
                          <ion-icon class="downloadarrowdropdown" name="arrow-down-circle-outline"></ion-icon>
                          <h6 text-wrap class="fileexten">{{item.fileextension}}</h6>
                        </div>

                        <!--Txt Format-->
                        <a *ngIf="item.filetype=='txt' || item.filetype=='TXT'"
                          (click)="getPermission(item.message,item.fileextension,item.filetype)">
                          <img style="height:35px;" src="assets/imgs/txtFormat.png">
                          <ion-icon class="downloadarrowdropdown" name="arrow-down-circle-outline"></ion-icon>
                          <span text-wrap class="fileexten">{{item.fileextension}}</span>
                        </a>

                        <!--PPT format-->
                        <a *ngIf="item.filetype=='pps' || item.filetype=='ppa'  || item.filetype=='pptx' || item.filetype=='potx'"
                          (click)="getPermission(item.message,item.fileextension,item.filetype)">
                          <img style="height:35px;" src="assets/imgs/ppt.png">
                          <ion-icon class="downloadarrowdropdown" name="arrow-down-circle-outline"></ion-icon>
                          <h6 text-wrap class="fileexten">{{item.fileextension}}</h6>
                        </a>

                        <!--google location file-->
                        <a *ngIf="item.filetype=='map'" (click)='Mappopover(item.message)'>
                          <img
                            src="{{getMap}}center={{latitude}}&zoom=18&size=300x300&markers=color:red%7Clabel:S%7C{{item.message}}">
                        </a>

                        <!-- <a *ngIf="item.filetype=='map live'">
                          <img style="width: 100% !important;"
                            src="{{getMap}}center={{latitude}}&zoom=18&size=300x300&markers=color:red%7Clabel:S%7C{{item.message}}">
                            
                        </a> -->
                        <p *ngIf="item.filetype=='map live'"
                          (click)="liveLocation(item.message,item.timestamp,item.sentby)">
                          <img style="width: 100% !important;"
                            src="{{getMap}}center={{latitude}}&zoom=18&size=300x300&markers=color:red%7Clabel:S%7C{{item.message}}">

                        </p>
                        <!-- <p *ngIf="item.livelocation!='undefined' &&(item.livelocation=='false' || item.livelocation==false)"
                          style="font-size: 14px;text-align:center;height: 0px;color: #b3aea8;">Live Location Ended</p> -->

                        <!-- <button
                          *ngIf="item.filetype=='map live' && item.livelocation=='true' || item.livelocation==true"
                          style="border-radius: 10px;width: 100%;background: #ff656c !important;
                        color: #000;" ion-button full (click)="liveLocation(item.message,item.timestamp,item.sentby)">
                          <ion-icon style="position: relative;
                          top: 3px;" name="navigate-outline"></ion-icon>&nbsp;live location
                        </button> -->

                        <!-- <br/> -->

                        <!--Audio file-->
                        <audio *ngIf="item.filetype=='audio' || item.filetype=='mp3'" controls
                          controlsList="nodownload">

                          <source [src]="sanitizer.bypassSecurityTrustUrl(item.message)" type="audio/ogg">
                          <source [src]="sanitizer.bypassSecurityTrustUrl(item.message)" type="audio/mpeg">
                        </audio>


                        <!--Video file-->
                        <video *ngIf="item.filetype=='mp4' || item.filetype=='avi' || item.filetype=='flv'" width="200"
                          height="125" preload="none" controls controlsList="nodownload">
                          <source [src]="sanitizer.bypassSecurityTrustUrl(item.message)" type="video/mp4">
                          <source [src]="sanitizer.bypassSecurityTrustUrl(item.message)" type="video/ogg">

                        </video>

                        <span *ngIf=" !item.showMore && item.attachtext!='null' && item.attachtext!=null && item.attachtext!=''"
                          style="max-width: 100%;white-space: pre-line !important;color: black;margin-right: 15px;"
                          text-wrap [innerHTML]="trimString(item.attachtext,150)| highlightPipe:searchTerms"></span>

                        <!-- </div> -->
                        <!-- <div *ngIf="item.showMore"> -->

                        <span *ngIf="item.showMore && item.attachtext!='null' && item.attachtext!=null && item.attachtext!='' && hidetext(item)"
                          style="max-width: 100%;white-space: pre-line !important;color: black;" text-wrap
                          [innerHTML]="item.attachtext| highlightPipe:searchTerms"></span>

                        <!-- </div> -->
                        <a *ngIf="item.attachtext!=null && item.attachtext!='null'  && item.attachtext.length>150 "
                          style="max-width: 100%;color: #039be5;cursor: pointer;font-size: 14px;"
                          (click)="item.showMore = !item.showMore">Read<span
                            [innerHtml]="item.showMore ? 'less' : 'More'">
                          </span>
                        </a>


                        <!-- <div> -->
                        <span class="time" text-right style="margin-top: 8px;">
                          {{item.timestamp | date: "hh:mm a"  }}
                        </span>
                        <!-- </div> -->


                      </div>
                      <!-- Event message -->
                      <div *ngIf="item.filetype=='event'">
                        <p class="chatbubble-left" style="max-width: 100%;">
                          <span style="margin: 0 auto;display: block;">
                            <ion-icon class="calendar" name="calendar"></ion-icon> <br>
                          </span>
                          <span class="eventmsg">{{ item.message }}</span><br>
                          <!-- <span *ngIf="item.status == '1'" class="invitebtn"
                            (click)="save_event(item.message,item)">Accept & Save</span> -->
                          <ion-button expand="block" style="--background:#00bfa5 " (click)="save_event(item.message,item)">Accept
                          </ion-button>
                        </p>
                      </div>
                      <ion-icon class="favouriteicon" *ngIf="item.favourite==1" name="star"></ion-icon>
                    </div>

                  </ion-col>


                  <!--me-->
                  <ion-col offset="3" size="9"
                    *ngIf="item.sentby === currentUser&& item.filetype!='title' &&  item.filetype!='video text' && item.filetype!='call text'"
                    class="message my-message">
                    <div class="chatbubble-right">
                      <div>
                        <span style="display: none;" id=singlechat{{i}}>{{ item.message }}</span>
                        <i style="float: right;" (click)="singlechatcopyPopover($event,i);$event.stopPropagation()"
                          class="fa fa-angle-down recentdropdown1" aria-hidden="true">
                        </i>
                      </div>


                      <div
                        *ngIf="item.forwardmsg!=null && item.forwardmsg!='null' && item.forwardmsg!='undefined' && item.forwardmsg!=currentUser"
                        style="    font-size: 13px;
                        font-style: italic;
                    color: lightgray;">
                        <i class="fa fa-share" aria-hidden="true"></i> Forwarded

                      </div>

                      <!--Reply Tag text-->
                      <span *ngIf="item.filetype == 'mom'" [innerHTML]="item.message | highlightPipe:searchTerms"></span>

                      <span
                        *ngIf="item.tagmessage!='' && item.tagmessage!=null && item.tagmessage!='undefined' && item.tagmessage!='null'"
                        style="max-width: 100%;color: #E91E63; background-color: #cfe9ba;
                          width: 100%;">

                        <span *ngIf="item.tagfiletype=='text'" style="white-space: pre-line !important;max-width: 100%;"
                          text-wrap [innerHTML]="item.tagmessage | highlightPipe:searchTerms"></span>

                        <!--Image file-->
                        <div
                          *ngIf="item.tagfiletype=='image' || item.tagfiletype=='JPG' || item.tagfiletype=='jpg' || item.tagfiletype=='png' || item.tagfiletype=='PNG' || item.tagfiletype=='JPEG' || item.tagfiletype=='jpeg' || item.tagfiletype=='gif' || item.tagfiletype=='GIF'">
                          <img src="{{item.tagmessage}}">
                          <br />
                        </div>
                        <!--Any document-->

                        <div>

                          <a
                            *ngIf="item.tagfiletype=='dotx' ||item.tagfiletype=='doc' || item.tagfiletype=='dot' || item.tagfiletype=='docx'">

                            <p text-wrap class="fileexten">{{item.tagfileextension}}</p>
                          </a>
                          <a
                            *ngIf="item.tagfiletype=='xls' || item.tagfiletype=='xlsx' || item.tagfiletype=='xlt'|| item.tagfiletype=='xla' ">

                            <p text-wrap class="fileexten">{{item.tagfileextension}}</p>
                          </a>

                          <a *ngIf="item.tagfiletype=='txt' || item.tagfiletype=='TXT'">

                            <p text-wrap class="fileexten">{{item.tagfileextension}}</p>
                          </a>

                          <a *ngIf="item.tagfiletype=='pdf' || item.tagfiletype=='PDF'">

                            <p text-wrap class="fileexten">{{item.tagfileextension}}</p>
                          </a>
                          <a
                            *ngIf="item.tagfiletype=='pps' || item.tagfiletype=='ppa'  || item.tagfiletype=='pptx' || item.tagfiletype=='potx'">

                            <p text-wrap class="fileexten">{{item.tagfileextension}}</p>
                          </a>

                        </div>


                        <!--Location-->
                        <a *ngIf="item.Taglocation=='true'">
                          <img
                            src="{{getMap}}center={{item.latitude}}&zoom=18&size=300x300&markers=color:red%7Clabel:S%7C{{item.latitude}}">
                        </a>

                        <!--Audio file-->
                        <audio *ngIf="item.tagfiletype=='audio' || item.tagfiletype=='mp3'" controls
                          controlsList="nodownload">
                          <source [src]="sanitizer.bypassSecurityTrustUrl(item.tagmessage)" type="audio/ogg">
                          <source [src]="sanitizer.bypassSecurityTrustUrl(item.tagmessage)" type="audio/mpeg">
                        </audio>
                        <!--Video file-->
                        <video *ngIf="item.tagfiletype=='mp4' || item.tagfiletype=='avi' || item.tagfiletype=='flv'"
                          width="200" preload="none" height="125" controls controlsList="nodownload">
                          <source [src]="sanitizer.bypassSecurityTrustUrl(item.tagmessage)" type="video/mp4">
                          <source [src]="sanitizer.bypassSecurityTrustUrl(item.tagmessage)" type="video/ogg">
                        </video>

                        <p class="stable singleTick">{{item.tagtime | date: "hh:mm a"  }} </p>
                        <h6></h6>
                      </span>





                      <!-- {{ item.message }} -->

                      <div>
                        <!-- <span *ngIf="item.filetype=='text' && item.message!='' && hidetext(item)"
                            style="white-space: pre-line !important;color: black;" text-wrap
                            [innerHTML]="item.message | highlightPipe:searchTerms"></span> -->



                        <div *ngIf="!item.showMore">

                          <span *ngIf="item.filetype=='text' && item.message!='' && hidetext(item)"
                            style="max-width: 100%;white-space: pre-line !important;color: black;" text-wrap
                            [innerHTML]="trimString(item.message,200)| highlightPipe:searchTerms"></span>
                        </div>

                        <div *ngIf="item.showMore">

                          <span *ngIf="item.filetype=='text' && item.message!='' && hidetext(item)"
                            style="max-width: 100%;white-space: pre-line !important;color: black;" text-wrap
                            [innerHTML]="item.message| highlightPipe:searchTerms"></span>

                        </div>

                        <a *ngIf="item.message.length>150 && item.filetype=='text'"
                          style="max-width: 100%;color: #039be5;cursor: pointer;font-size: 14px;"
                          (click)="item.showMore = !item.showMore">Read <span
                            [innerHtml]="item.showMore ? 'less' : 'More'">
                          </span>
                        </a>

                        <!-- <span *ngIf="item.filetype=='text' && item.message!='' && hidetext(item)"
                            style="white-space: pre-line !important;color: black;" text-wrap >{{item.message}}</span>
                          -->
                        <!-- 
                        <div *ngIf="item.filetype=='text' && item.message!=''">
                          <span *ngIf="hidetext(item)" [hidden]="selfdestruct"
                            style="white-space: pre-line !important;color: black;margin-right: 15px;" text-wrap
                            [innerHTML]="item.message"></span>
                        </div> -->


                        <div
                          *ngIf="item.filetype=='image' || item.filetype=='JPG' || item.filetype=='jpg' || item.filetype=='png' || item.filetype=='PNG' || item.filetype=='JPEG' || item.filetype=='jpeg' || item.filetype=='gif' || item.filetype=='GIF'">
                          <img style="object-fit: cover;width:245px;height:245px;margin-bottom: 10px;"
                            [src]="sanitizer.bypassSecurityTrustUrl(item.message)"
                            *ngIf="item.filetype=='image' || item.filetype=='JPG' || item.filetype=='jpg' || item.filetype=='png' || item.filetype=='PNG' || item.filetype=='JPEG' || item.filetype=='jpeg' || item.filetype=='gif' || item.filetype=='GIF'"
                            (click)="ZoomFile(item.message)">
                          <br />
                        </div>


                        <!--Doc format-->
                        <a *ngIf="item.filetype=='dotx' ||item.filetype=='doc' || item.filetype=='dot' || item.filetype=='docx'"
                          (click)="getPermission(item.message,item.fileextension,item.filetype)">
                          <img style="height:35px;" src="assets/imgs/wordDoc.png">
                          <ion-icon class="downloadarrowdropdown" name="arrow-down-circle-outline"></ion-icon>
                          <h6 text-wrap class="fileexten">{{item.fileextension}}</h6>
                        </a>

                        <!--XLS format-->
                        <div
                          *ngIf="item.filetype=='xls' || item.filetype=='xlsx' || item.filetype=='xlt'|| item.filetype=='xla'"
                          (click)="getPermission(item.message,item.fileextension,item.filetype)">
                          <img style="height:35px;" src="assets/imgs/excelDoc.png">
                          <ion-icon class="downloadarrowdropdown" name="arrow-down-circle-outline"></ion-icon>
                          <h6 text-wrap class="fileexten">{{item.fileextension}}</h6>
                        </div>
                        <!--PDF Format-->
                        <div *ngIf="item.filetype=='pdf' || item.filetype=='PDF'"
                          (click)="getPermission(item.message,item.fileextension,item.filetype)">
                          <img style="height:35px;" src="assets/imgs/pdfDoc.png">
                          <ion-icon class="downloadarrowdropdown" name="arrow-down-circle-outline"></ion-icon>
                          <h6 text-wrap class="fileexten">{{item.fileextension}}</h6>
                        </div>

                        <!--Txt Format-->
                        <a *ngIf="item.filetype=='txt' || item.filetype=='TXT'"
                          (click)="getPermission(item.message,item.fileextension,item.filetype)">
                          <img style="height:35px;" src="assets/imgs/txtFormat.png">
                          <ion-icon class="downloadarrowdropdown" name="arrow-down-circle-outline"></ion-icon>
                          <span text-wrap class="fileexten">{{item.fileextension}}</span>
                        </a>

                        <!--PPT format-->
                        <a *ngIf="item.filetype=='pps' || item.filetype=='ppa'  || item.filetype=='pptx' || item.filetype=='potx'"
                          (click)="getPermission(item.message,item.fileextension,item.filetype)">
                          <img style="height:35px;" src="assets/imgs/ppt.png">
                          <ion-icon class="downloadarrowdropdown" name="arrow-down-circle-outline"></ion-icon>
                          <h6 text-wrap class="fileexten">{{item.fileextension}}</h6>
                        </a>

                        <!--google location file-->
                        <a *ngIf="item.filetype=='map'" (click)='Mappopover(item.message)'>
                          <img style="width: 100% !important;"
                            src="{{getMap}}center={{latitude}}&zoom=18&size=300x300&markers=color:red%7Clabel:S%7C{{item.message}}">
                        </a>
                        <p *ngIf="item.filetype=='map live'"
                          (click)="liveLocation(item.message,item.timestamp,item.sentby)">
                          <img style="width: 100% !important;"
                            src="{{getMap}}center={{latitude}}&zoom=18&size=300x300&markers=color:red%7Clabel:S%7C{{item.message}}">
                        </p>

                        <!-- <p *ngIf="item.livelocation!='undefined' &&(item.livelocation=='false' || item.livelocation==false)"
                          style="font-size: 14px;text-align:center;height: 0px;color: #b3aea8;">Live Location Ended</p> -->

                        <div
                          *ngIf="item.filetype=='map live' && (item.livelocation=='true' || item.livelocation==true)">
                          <!-- <button style="width: 50%;min-height: 25px;border-radius: 10px;background: #ff656c !important;
                          color: #000;" ion-button full (click)="stopLocation(item.message,item.timestamp)">
                            <ion-icon style="position: relative;
                            top: 3px;" name="stop-circle-outline"></ion-icon>&nbsp;Stop Live
                          </button> -->

                          <button *ngIf="item.filetype=='map live'" style="    border-radius: 10px;
                          width: 47%;min-height: 25px;
                          background: #0c84b4 !important;
                          color: #000;
                          margin-left: 5px;" ion-button full
                            (click)="liveLocation(item.message,item.timestamp,item.sentby)">
                            <ion-icon style="position: relative;
                            top: 3px;" name="navigate-outline"></ion-icon>&nbsp;View Live
                          </button>
                          <br />
                        </div>


                        <!-- <br/> -->

                        <!--Audio file-->
                        <audio *ngIf="item.filetype=='audio' || item.filetype=='mp3'" controls
                          controlsList="nodownload">

                          <source [src]="sanitizer.bypassSecurityTrustUrl(item.message)" type="audio/ogg">
                          <source [src]="sanitizer.bypassSecurityTrustUrl(item.message)" type="audio/mpeg">
                        </audio>


                        <!--Video file-->
                        <video *ngIf="item.filetype=='mp4' || item.filetype=='avi' || item.filetype=='flv'" width="200"
                          height="125" preload="none" controls controlsList="nodownload">
                          <source [src]="sanitizer.bypassSecurityTrustUrl(item.message)" type="video/mp4">
                          <source [src]="sanitizer.bypassSecurityTrustUrl(item.message)" type="video/ogg">

                        </video>

                        <span *ngIf="!item.showMore">

                          <span *ngIf="item.attachtext!='null' && item.attachtext!=null && hidetext(item)"
                            style="max-width: 100%;white-space: pre-line !important;color: black;" text-wrap
                            [innerHTML]="trimString(item.attachtext,200)| highlightPipe:searchTerms"></span>
                        </span>

                        <span *ngIf="item.showMore">

                          <span *ngIf="item.attachtext!='null' && item.attachtext!=null && hidetext(item)"
                            style="max-width: 100%;white-space: pre-line !important;color: black;" text-wrap
                            [innerHTML]="item.attachtext| highlightPipe:searchTerms"></span>

                        </span>

                        <a *ngIf="item.attachtext!='null' && item.attachtext!=null && item.attachtext.length>150 "
                          style="max-width: 100%;color: #039be5;cursor: pointer;font-size: 14px;"
                          (click)="item.showMore = !item.showMore">Read <span
                            [innerHtml]="item.showMore ? 'less' : 'More'">
                          </span>
                        </a>

                        <!--Document's-->
                        <span class="time" text-right style="float:right;right:7px;"
                          *ngIf="item.status=='0' && item.message!='' && (item.filetype=='pptx' || item.filetype=='ppa' || item.filetype=='pps' || item.filetype=='xlsx' || item.filetype=='xls' || item.filetype=='PDF' || item.filetype=='pdf' || item.filetype=='dotx' ||item.filetype=='doc' || item.filetype=='dot' || item.filetype=='docx')"
                          class="stable singleTick">{{item.timestamp | date: "hh:mm a"  }}<span
                            style="color: gray !important;">
                            <span data-testid="msg-time" aria-label=" Pending " data-icon="msg-time" class="">
                              <img style="width:10px;height:10px;" src="assets/imgs/graybullet.png">
                              <img style="width:10px;height:10px;" src="assets/imgs/graybullet.png">
                            </span>

                          </span></span>
                        <span class="time" text-right style="float:right;right:7px;"
                          *ngIf=" item.filetype!='video text' && item.filetype!='call text' && item.status=='1' && item.message!='' && (item.filetype=='pptx' || item.filetype=='ppa' || item.filetype=='pps' || item.filetype=='xlsx' || item.filetype=='xls' || item.filetype=='PDF' || item.filetype=='pdf' || item.filetype=='dotx' ||item.filetype=='doc' || item.filetype=='dot' || item.filetype=='docx')"
                          class="stable singleTick">{{item.timestamp | date: "hh:mm a"  }} <span
                            style="color: gray !important;">
                            <span data-testid="msg-check" aria-label=" Sent " data-icon="msg-check" class="">
                              <img style="width:10px;height:10px;" src="assets/imgs/blackbullet.png">
                      <img style="width:10px;height:10px;" src="assets/imgs/blackbullet.png">
                            </span>
                          </span></span>
                        <span class="time" text-right style="float:right;right:7px;"
                          *ngIf=" item.filetype!='video text' && item.filetype!='call text' && item.status=='2' && item.message!='' && (item.filetype=='pptx' || item.filetype=='ppa' || item.filetype=='pps' || item.filetype=='xlsx' || item.filetype=='xls' || item.filetype=='PDF' || item.filetype=='pdf' || item.filetype=='dotx' ||item.filetype=='doc' || item.filetype=='dot' || item.filetype=='docx')"
                          class="stable singleTick">{{item.timestamp | date: "hh:mm a"  }} <span
                            style="color: #4fc3f7 !important; ">
                            <span data-testid="msg-dblcheck" aria-label=" Read " data-icon="msg-dblcheck"
                              class="_3xkAl">
                              <img style="width:10px;height:10px;" src="assets/imgs/greenbullet.png">
                              <img style="width:10px;height:10px;" src="assets/imgs/greenbullet.png">
                            </span>

                          </span></span>

                        <!--Chat status tick-->

                        <span class="time" text-right style="float:right;right:7px;"
                          *ngIf="item.filetype!='video text' && item.filetype!='call text' && item.status=='0' && item.message!='' && (item.filetype=='mp4' || item.filetype=='avi' || item.filetype=='flv' || item.filetype=='mp3' || item.filetype=='audio' || item.location=='true' || item.livelocation=='true' || item.filetype=='image' || item.filetype=='JPG' || item.filetype=='jpg' || item.filetype=='png' || item.filetype=='PNG' || item.filetype=='JPEG' || item.filetype=='jpeg' || item.filetype=='gif' || item.filetype=='GIF')"
                          class="stable singleTick">{{item.timestamp | date: "hh:mm a"  }} <span
                            style="color: gray !important;">
                            <span data-testid="msg-time" aria-label=" Pending " data-icon="msg-time" class="">
                              <img style="width:10px;height:10px;" src="assets/imgs/graybullet.png">
                              <img style="width:10px;height:10px;" src="assets/imgs/graybullet.png">
                            </span>

                          </span></span>
                        <span class="time" text-right style="float:right;right:7px;"
                          *ngIf="item.filetype!='video text' && item.filetype!='call text' && item.status=='1' && item.message!='' && (item.filetype=='mp4' || item.filetype=='avi' || item.filetype=='flv' ||  item.filetype=='mp3' || item.filetype=='audio' || item.location=='true' || item.livelocation=='true'  || item.filetype=='image' || item.filetype=='JPG' || item.filetype=='jpg' || item.filetype=='png' || item.filetype=='PNG' || item.filetype=='JPEG' || item.filetype=='jpeg' || item.filetype=='gif' || item.filetype=='GIF')"
                          class="stable singleTick">{{item.timestamp | date: "hh:mm a"  }} <span
                            style="color: gray !important;">
                            <span data-testid="msg-check" aria-label=" Sent " data-icon="msg-check" class="">
                              <img style="width:10px;height:10px;" src="assets/imgs/blackbullet.png">
                      <img style="width:10px;height:10px;" src="assets/imgs/blackbullet.png">
                            </span>
                          </span></span>
                        <span class="time" text-right style="float:right;right:7px;"
                          *ngIf="item.filetype!='video text' && item.filetype!='call text' && item.status=='2' && item.message!='' && (item.filetype=='mp4' || item.filetype=='avi' || item.filetype=='flv' || item.filetype=='mp3' || item.filetype=='audio' || item.location=='true' || item.livelocation=='true'   || item.filetype=='image' || item.filetype=='JPG' || item.filetype=='jpg' || item.filetype=='png' || item.filetype=='PNG' || item.filetype=='JPEG' || item.filetype=='jpeg' || item.filetype=='gif' || item.filetype=='GIF')"
                          class="stable singleTick">{{item.timestamp | date: "hh:mm a"  }} <span
                            style="color: #4fc3f7 !important; ">
                            <span data-testid="msg-dblcheck" aria-label=" Read " data-icon="msg-dblcheck"
                              class="_3xkAl">
                              <img style="width:10px;height:10px;" src="assets/imgs/greenbullet.png">
                              <img style="width:10px;height:10px;" src="assets/imgs/greenbullet.png">
                            </span>
                          </span></span>

                        <!--Text ststus-->
                        <span class="time" text-right style="float:right"
                          *ngIf="item.filetype!='video text' && item.filetype!='call text' && item.status=='0' && item.message!='' && item.filetype!='mp4' && item.filetype!='avi' && item.filetype!='flv' && item.filetype!='mp3'  && item.filetype!='audio' && item.location!='true' && item.livelocation!='true'  && item.filetype!='pptx' && item.filetype!='ppa' && item.filetype!='pps' && item.filetype!='xlsx' && item.filetype!='xls' && item.filetype!='PDF' && item.filetype!='pdf' && item.filetype!='dotx' && item.filetype!='doc' && item.filetype!='dot' && item.filetype!='docx' && item.filetype!='image' && item.filetype!='JPG' && item.filetype!='jpg' && item.filetype!='png' && item.filetype!='PNG' && item.filetype!='JPEG' && item.filetype!='jpeg' && item.filetype!='gif' && item.filetype!='GIF'"
                          class="stable singleTick">{{item.timestamp | date: "hh:mm a"  }}
                          <span data-testid="msg-time" aria-label=" Pending " data-icon="msg-time" class="">
                            <img style="width:10px;height:10px;" src="assets/imgs/graybullet.png">
                            <img style="width:10px;height:10px;" src="assets/imgs/graybullet.png">
                          </span>
                        </span>
                        <span text-right
                          *ngIf="item.filetype!='video text' && item.filetype!='call text' && item.status=='1' && item.message!='' && item.filetype!='mp4' && item.filetype!='avi' && item.filetype!='flv' &&  item.filetype!='mp3' && item.filetype!='audio' && item.location!='true' && item.livelocation!='true' && item.filetype!='pptx' && item.filetype!='ppa' && item.filetype!='pps' && item.filetype!='xlsx' && item.filetype!='xls' && item.filetype!='PDF' && item.filetype!='pdf' && item.filetype!='dotx' && item.filetype!='doc' && item.filetype!='dot' && item.filetype!='docx' && item.filetype!='image' && item.filetype!='JPG' && item.filetype!='jpg' && item.filetype!='png' && item.filetype!='PNG' && item.filetype!='JPEG' && item.filetype!='jpeg' && item.filetype!='gif' && item.filetype!='GIF'"
                          class="stable singleTick">{{item.timestamp | date: "hh:mm a"  }} <span
                            style="color: gray !important;">
                            <span data-testid="msg-check" aria-label=" Sent " data-icon="msg-check" class="">
                              <img style="width:10px;height:10px;" src="assets/imgs/blackbullet.png">
                              <img style="width:10px;height:10px;" src="assets/imgs/blackbullet.png">
                            </span>
                          </span></span>
                        <span class="time" text-right style="float:right"
                          *ngIf="item.filetype!='video text' && item.filetype!='call text' && item.status=='2' && item.message!='' && item.filetype!='mp4' && item.filetype!='avi' && item.filetype!='flv' && item.filetype!='mp3' && item.filetype!='audio' && item.location!='true' && item.livelocation!='true' && item.filetype!='pptx' && item.filetype!='ppa' && item.filetype!='pps' && item.filetype!='xlsx' && item.filetype!='xls' && item.filetype!='PDF' && item.filetype!='pdf' && item.filetype!='dotx' && item.filetype!='doc' && item.filetype!='dot' && item.filetype!='docx' && item.filetype!='image' && item.filetype!='JPG' && item.filetype!='jpg' && item.filetype!='png' && item.filetype!='PNG' && item.filetype!='JPEG' && item.filetype!='jpeg' && item.filetype!='gif' && item.filetype!='GIF'"
                          class="stable singleTick">{{item.timestamp | date: "hh:mm a"  }}
                          <span style="color: #4fc3f7 !important;">
                            <span data-testid="msg-dblcheck" aria-label=" Read " data-icon="msg-dblcheck"
                              class="_3xkAl">
                              <img style="width:10px;height:10px;" src="assets/imgs/greenbullet.png">
                              <img style="width:10px;height:10px;" src="assets/imgs/greenbullet.png">
                            </span>

                          </span></span>
                      </div>
                      <!-- Event Message -->
                      <div *ngIf="item.filetype=='event'">
                        <p class="chatbubble-right">
                          <span style="margin: 0 auto;display: block;">
                            <ion-icon class="calendar" name="calendar"></ion-icon> <br>
                          </span>
                          <span class="eventmsg">{{item.message}}</span>
                          <!-- <span class="time" text-right><br>{{ item.timestamp | date:'shortTime' }}</span> -->
                        </p>
                      </div>
                      <ion-icon class="favouriteicon" *ngIf="item.favourite==1" name="star"></ion-icon>
                    </div>
                  </ion-col>


                  <!-- <ion-col size="9" *ngIf="item.sentby !== currentUser&&item.filetype=='event'" class="message my-message">
                    <p class="chatbubble-left">
                      <span style="margin: 0 auto;display: block;">
                        <ion-icon class="calendar" name="calendar"></ion-icon> <br>
                      </span>
                      <span class="eventmsg">{{ item.message }}</span><br> <span class="invitebtn"
                        (click)="save_event(item.message)">Accept & Save</span><span class="time"
                        text-right><br>{{ item.timestamp | date:'shortTime' }}</span></p>
                  </ion-col>
          
                  <ion-col offset="3" size="9" *ngIf="item.sentby === currentUser&&item.filetype=='event'"
                    style="margin-left: 0 !important;" class="message my-message">
                    <p class="chatbubble-right">
                      <span style="margin: 0 auto;display: block;">
                        <ion-icon class="calendar" name="calendar"></ion-icon> <br>
                      </span>
                      <span class="eventmsg">{{ item.message }}</span> <span class="time"
                        text-right><br>{{ item.timestamp | date:'shortTime' }}</span></p>
                  </ion-col> -->
                </ion-row>
              </div>
            </ion-grid>

          </div>
        </div>
        <ion-footer *ngIf="!buddyblocked && !myblocked" class="ion-no-border">
          <input type="file" id="imgupload2" style="display: none" (change)="onUploadChange($event)" />
          <input type="file" id="imgupload" style="display: none" (change)="onUploadChange($event)" />

          <div *ngIf="showpopSingle==true" class="popoverdiv">
            <ion-row style="float: right;" (click)="closePopover()">
              <ion-icon name="close-circle" class="popclose"></ion-icon>

              <!-- <img src="assets/closeIcon.png" style="height:22px;position:absolute;right:57px;" (click)="closePopover()"> -->
            </ion-row>
            <ion-row>
              <ion-col col-3>
                <!-- <img src='assets/imgs/camera.png' *ngIf="!mobileicon" class="chatpop" (click)="webcamera()" /> -->
                <img src='assets/imgs/camera.png' class="chatpop" (click)="webcamera()" />
                <!-- sendPicCamera  takeCamera-->
              </ion-col>
              <ion-col col-3>

                <input type="file" id="imgupload2" style="display: none" (change)="onUploadChange($event)" />

              </ion-col>
              <ion-col col-3>
                <input type="file" id="imgupload" style="display: none" (change)="onUploadChange($event)" />

              </ion-col>
              <ion-col col-3>
                <img src='assets/imgs/location.png' class="chatpop" (click)="addMarker()" />

              </ion-col>
            </ion-row>
          </div>
          <div [class.show]="maptitleStyle" *ngIf="mapshowpop=='true'" class="popoverdiv">
            <ion-row style="float: right;">
              <ion-icon name="close-circle" class="popclose" (click)="closePopover()"></ion-icon>
            </ion-row>
            <ion-row>
              <ion-col col-6>
                <ion-icon name="logo-chrome" style="font-size: 2.2em !important" (click)="openLocation(0)"
                  class="chatpop">
                </ion-icon>
              </ion-col>

              <ion-col col-6>
                <img src='assets/imgs/location.png' class="chatpop" (click)="openLocation(1)" />
              </ion-col>
            </ion-row>
          </div>
          <div *ngIf="addmessagehide" class="tagdiv">
            <div class="tagmessage">
              <ion-icon name="close" class="loginicon" title="Close" (click)="Replycancel()"></ion-icon>
              <div
                *ngIf="filetype!='image' && filetype!='JPG' && filetype!='jpg' && filetype!='png' && filetype!='PNG' && filetype!='JPEG' && filetype!='jpeg' && filetype!='gif' && filetype!='GIF' && filetype!='application' && filetype!='mp4' && filetype!='avi' && filetype!='flv' && location!=true && latitude!=true && filetype!='dotx' && filetype!='doc' && filetype!='dot' && filetype!='docx' && filetype!='xls' && filetype!='xlsx' && filetype!='xlt' && filetype!='xla' && filetype!='pdf' && filetype!='PDF' && filetype!='pps' && filetype!='ppa'  && filetype!='pptx' && filetype!='potx'"
                text-wrap>
                {{tagmessage}}</div>
              <div
                *ngIf="filetype=='image' || filetype=='JPG' || filetype=='jpg' || filetype=='png' || filetype=='PNG' || filetype=='JPEG' || filetype=='jpeg' || filetype=='gif' || filetype=='GIF'">

                <img style="width:75px;height: 64px;" [src]="sanitizer.bypassSecurityTrustUrl(tagmessage)"
                  *ngIf="filetype=='image' || filetype=='JPG' || filetype=='jpg' || filetype=='png' || filetype=='PNG' || filetype=='JPEG' || filetype=='jpeg' || filetype=='gif' || filetype=='GIF'">
                <br /></div>
              <!--Any document-->
              <img style="height:30px" src="assets/Fileticon.png" *ngIf="filetype=='application'">


              <!--Location-->
              <a *ngIf="filetype=='map'" (click)='Mappopover(message)'>
                <img src="{{getMap}}center={{latitude}}&zoom=18&size=300x300&markers=color:red%7Clabel:S%7C{{message}}">
              </a>

              <!--Audio file-->
              <audio *ngIf="filetype=='audio' ||  filetype=='mp3'" controls>
                <source [src]="sanitizer.bypassSecurityTrustUrl(tagmessage)" type="audio/ogg">
                <source [src]="sanitizer.bypassSecurityTrustUrl(tagmessage)" type="audio/mpeg">
              </audio>
              <!--Video file-->
              <video *ngIf="filetype=='mp4' || filetype=='avi' || filetype=='flv'" width="100" height="70" controls
                preload="none">
                <source [src]="sanitizer.bypassSecurityTrustUrl(tagmessage)" type="video/mp4">
                <source [src]="sanitizer.bypassSecurityTrustUrl(tagmessage)" type="video/ogg">
              </video>

              <span
                *ngIf="filetype=='dotx' || filetype=='doc' || filetype=='dot' || filetype=='docx' || filetype=='xls' || filetype=='xlsx' || filetype=='xlt'|| filetype=='xla'|| filetype=='pdf' || filetype=='PDF' || filetype=='pps' || filetype=='ppa'  || filetype=='pptx' || filetype=='potx' || filetype=='txt' || filetype=='TXT'"
                text-wrap>{{tagfileextension}}</span>



              <!-- <div class="stable">{{tagtime | date: "hh:mm a"  }}</div> -->
            </div>
          </div>
          <ion-toolbar>

            <div *ngIf="!newMsgBtn">
              <div class="messagediv" style="height:50px;width:98%">

                <ion-grid>
                  <ion-row>
                    <ion-col size="2">
                      <img end *ngIf="!newMsgBtn" src="assets/audio_icon.gif"
                        style="height: 45px;float: left;margin-top: -9px;">

                    </ion-col>
                    <ion-col size="6">
                      <label class="listening">Listening...</label>

                    </ion-col>
                    <ion-col size="2">
                      <button class="voicecancel" end *ngIf="!newMsgBtn" ion-button clear icon-only item-right
                        (click)="stopRecording1()">
                        Cancel
                      </button>
                    </ion-col>
                    <ion-col size="2">

                      <button class="voicesend" end *ngIf="!newMsgBtn" ion-button clear icon-only item-right
                        (click)="stopRecording1()">
                        Send
                      </button>
                    </ion-col>
                  </ion-row>
                </ion-grid>





              </div>

            </div>

            <div style="display: flex;">

              <div class="messagediv" *ngIf="newMsgBtn">
                <!-- <ion-icon class="attachementicon" *ngIf="newMsgBtn" (click)="popover()" name="attach"></ion-icon> -->
                
                  <ion-icon name="happy-outline" title="Emoji" class="attachementicon" width="30px"
                  (click)="switchEmojiPicker()"></ion-icon>
                  <ion-icon name="attach-outline" title="Attach" class="attachicon" style=" margin-top: 12px;   height: 30px !important;
                  border: 0;
                  width: auto;    
                  margin-right: 10px;" width="30px" (click)="popover($event,item);$event.stopPropagation()"></ion-icon>


                <textarea autofocus #textarea1 id="message" rows="1" (paste)="onPaste($event)" (focus)="updateScroll()"
                  [(ngModel)]="message" placeholder="Type a message" minlength="1" msd-elastic=""
                  (ngModelChange)="StyleChange(message)"
                  class="ng-valid-minlength ng-valid-maxlength ng-dirty ng-touched ng-empty ng-invalid ng-invalid-required"
                  style="color: black;
                      border-radius: 29px;
                      display: initial;
                      overflow: auto;
                      overflow-wrap: break-word;
                      padding: 9px 32px 0px 25px;
                      margin-left: 6.3%;
                      background-color: white;
                      height: 45px;
                      /* margin-top: -4px; */
                      width: 100% !important;
                      border: none;
                      max-height: 130px;" (keyup.enter)="sendMessage()"></textarea>
                <!-- <button style="margin-top: 9px;right: 8%;" ion-button clear icon-only item-right (click)="switchEmojiPicker()">
                      <ion-icon name="md-happy"></ion-icon> -->
                <!-- <img *ngIf="!message" src="assets/attach.png"  width="30px" (click)="popover()"> -->


                <!-- <svg *ngIf="!newmessage" (click)="speechTotext()" style="    margin-top: 7px;
                    height: 35px !important;
            border: 0;
            width: auto;    background: white;
            margin-right: 10px;" width="30px" class="AWbbyf" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24"
                      height="24">
                      <path fill="none" d="M0 0h24v24H0z"></path>
                      <path fill="#4285F4"
                        d="M12 15c1.66 0 2.99-1.34 2.99-3L15 5c0-1.66-1.34-3-3-3S9 3.34 9 5v7c0 1.66 1.34 3 3 3z"></path>
                      <path fill="#34A853" d="M11 18.92h2V22h-2z"></path>
                      <path fill="#F4B400" d="M7 12H5c0 1.93.78 3.68 2.05 4.95l1.41-1.41C7.56 14.63 7 13.38 7 12z"></path>
                      <path fill="#EA4335"
                        d="M12 17c-1.38 0-2.63-.56-3.54-1.47l-1.41 1.41C8.32 18.21 10.07 19 12.01 19c3.87 0 6.98-3.14 6.98-7h-2c0 2.76-2.23 5-4.99 5z">
                      </path>
                    </svg> -->



                <!-- </button> -->
              </div>
              <ion-buttons end *ngIf="newMsgBtn" style="margin: auto;">


                <img *ngIf="message" title="Send" src="assets/sent.png" style="height: 35px !important;width:35px;
                    margin-right: 5px;"  (click)="sendMessage()">

                <!-- <button *ngIf="message" style="margin-bottom:11px;" ion-button clear icon-only item-right
                      [disabled]="message ==undefined || message == ''" (click)="sendMessage()">
                      <ion-icon name="ios-send" ios="ios-send" md="md-send" color="primary"></ion-icon>
                      <br />
                      <p class="gobtn">GO</p>
                    </button> -->
                <img *ngIf="!message" title="Mic" src="assets/mic.png"
                  style="height: 35px !important;width:35px !important;margin-right: 5px;" width="30px"
                  (click)="startRecording()">

                <!-- <button  *ngIf="!message"
                        style="margin-top: 12px;margin-left: 6px;width: 31px;background: #4b86c6;border-radius: 50%;" ion-button clear
                        icon-only item-right (click)="startRecord()">
                        <ion-icon style="color: #000;font-size: 22px;" name="mic" color="primary"></ion-icon>
                      </button> -->

              </ion-buttons>

            </div>


            <div *ngIf='showEmojiPicker'>
              <emoji-picker  [result]="score" (onEmojiSelect)="selectEmoji($event)"></emoji-picker>
            </div>
          </ion-toolbar>

        </ion-footer>
      </div>

    </div>



    <div *ngIf="groupchat" class="rightcontact"  [scrollEvents]="true" (ionScrollEnd)="getUsersListgroup($event)">
      <!-- <ion-infinite-scroll threshold='20%' (ionInfinite)="getUsersListgroup($event)" position="top">
        <ion-infinite-scroll-content
          loadingSpinner="bubbles"
          loadingText="Loading more data..."> -->
 

      <div class="rightdiv" >
        <!-- <div class="holechat"></div> -->
        <div>
          <header class="rightheader">

            <div>


              <div text-left style="width: auto !important;">
                <div *ngIf="searchinput ==false">
                  <img *ngIf="groupImage!='default'" (click)="viewPhoto(groupImage)"
                    [src]="sanitizer.bypassSecurityTrustUrl(groupImage)" class="profileimage">
                  <img *ngIf="groupImage=='default'"  src="assets/imgs/groupIcon.png" class="profileimage">

                  <div style="margin-top: -30px;
                margin-left: 37px;">
                    <span (click)="clickEVent()" class="buddyusername" style="margin-left: 30px;font-size: 14px;">{{groupname}}</span></div>
                  <span (click)="clickEVent()" *ngIf="BuddyTyping==false && !searchinput && groupmembers!=undefined"
                    style="padding-left: 67px;
                    
                    font-size: 12px;" class="buddyusername">{{groupmembers.length}} Members</span>

                  <span *ngIf="BuddyTyping==true && !searchinput"  style="padding-left: 68px;
           
           font-size: 12px;" class="buddyusername">{{BuddyTypingName}}</span>
                </div>

                <!-- <button *ngIf="searchinput ==false" ion-button style="display:-webkit-inline-box !important;    float: right;
                    margin-top: -30px;
                    margin-right: 10px;" (click)="clickEVent()">
                    <ion-icon name="menu" class="ionicon"></ion-icon>
                  </button> -->
                <!-- <button ion-button
                    style="    float: right;display:-webkit-inline-box !important;margin-top: -14px;margin-right: 10px;"
                    (click)="fileFilter()">
                    <ion-icon name="paper" class="ionicon"></ion-icon>
                  </button> -->
                <!-- <img *ngIf="searchinput ==false && forwardFlag==false && deleteFlag==false" style="float: right;display:-webkit-inline-box !important;margin-right: 50px; margin-top: -35px;
                  height: 30px;" src="assets/filefilter.png" (click)="fileFilter()" />
                  
                  <img *ngIf="searchinput==false && forwardFlag==false && deleteFlag==false" style="float: right;display:-webkit-inline-box !important;margin-right:130px; margin-top: -38px;
                  height: 32px;" src="assets/filterIcon.png" (click)="chatfilter()" />
          
                  -->

                <!-- <img *ngIf="searchinput==false && forwardFlag==false && deleteFlag==false" style="float: right;display:-webkit-inline-box !important;margin-right:52px; margin-top: -41px;
                  height: 32px;" src="assets/group_call.png" (click)="group_call()" />
           -->
                <ion-searchbar #inputId1 style='margin-left:25px;width:80%;margin-top: 0px !important;background-color:transparent' *ngIf="searchinput==true"
                  [(ngModel)]="searchTerms"  (keyup)="filteritems1($event)" [showCancelButton]="false" (ionClear)="grouponCancel($event)">
                </ion-searchbar>

                <span *ngIf="searchinput==false && forwardFlag==false && deleteFlag==false && deleteFlag1==false" class="ellipseicongrp">
                  <ion-icon (click)="groupmenuCLick()" title="Menu" name="ellipsis-vertical"></ion-icon>

                </span>
                <!-- <img style="float: right;
          display: -webkit-inline-box !important;
          margin-right: 100px;
          margin-top: -42px;
          height: 32px;
          border-radius: 15px;" title="Search"  src="assets/search.png" (click)="groupsearchshow()" /> -->
<ion-icon style="float: right;
display: -webkit-inline-box !important;
margin-right: 100px;
margin-top: -42px;
height: 32px;
border-radius: 15px;color: #fff;font-size:28px;" title="Search" name="search" (click)="groupsearchshow()"></ion-icon>

                <button *ngIf="forwardFlag==true" ion-button style="float: right;
                    display: -webkit-inline-box !important;
                    margin-right: 22px;
                    margin-top: -47px;
                    height: 28px;
                    border-radius: 15px;background:none" (click)="groupforward()">
                  <ion-icon style="font-size:36px" class="buddyusername" title="Forward" name="return-up-forward-outline"></ion-icon>
                </button>
                <button *ngIf="deleteFlag1==true" ion-button style="float: right;
                display: -webkit-inline-box !important;
                margin-right: 50px;
                margin-top: -40px;
                height: 28px;
                border-radius: 15px;background:none" (click)="groupdeleteFunction1()">
              <ion-icon style="font-size:25px;" class="buddyusername" title="Delete" name="trash-outline"></ion-icon>
              </button>
                <button *ngIf="deleteFlag==true" ion-button style="float: right;
                display: -webkit-inline-box !important;
                margin-right: 50px;
                margin-top: -40px;
                height: 28px;
                border-radius: 15px;background:none" (click)="groupdeleteFunction()">
              <ion-icon style="font-size:25px;" class="buddyusername" title="Delete" name="trash-outline"></ion-icon>
              </button>
               

              </div>
            </div>


          </header>
          <!-- <ion-refresher slot="fixed" disabled="false" (ionRefresh)="getUsersListgroup($event)">
            <ion-refresher-content></ion-refresher-content>
          </ion-refresher> -->

          <div id="messagesContent" #scrollMe (scroll)="getUsersListgroup($event)" >

            <div>

              <!-- 
                <ion-infinite-scroll threshold="100px" position="top" (ionInfinite)="getUsersList($event)" >
                  <ion-infinite-scroll-content
                    loadingSpinner="bubbles"
                    loadingText="Loading more data...">
                  </ion-infinite-scroll-content>
                </ion-infinite-scroll> -->

              <ion-grid>
                <ion-row *ngFor="let item of allgroupmsgs;let i = index;" (press)="onPress1($event,item,i)"
                  (pressup)="onPressUp1($event)" [style.touch-action]="'pan-y'"
                  [ngStyle]="{'background-color': item.selectedColor}">
                  <ion-row style="width: 100%;" *ngIf="item.timeset!=null && item.timeset!=undefined ">
                    <div class="timestampdate">{{item.timeset}}</div><br />
                  </ion-row>
                  <!--Forward selection-->
                  <ion-checkbox color="dark" *ngIf="forwardClick==true || deleteFlag==true || deleteFlag1==true" [(ngModel)]="item.selected"
                    (ionChange)="forwardSelectiongroup(item.selected,item)" item-right checked="false">
                  </ion-checkbox>
                  <ion-row style="width: 100%;" *ngIf="item.unreadMessageCount!=null && item.unreadMessageCount!=''">
                    <div class="timestampdate">{{item.unreadMessageCount}}</div><br />
                  </ion-row>
                  <div *ngIf="item.filetype=='title'" class="timestampdate">{{item.message}}</div><br />

                  <!--friend-->
                  <ion-col size="9" *ngIf="item.sentby !== Uid && item.filetype!='title'" class="message other-message">
                    <div class="chatbubble-left">
                      <!-- MOM -->

                      <div>
                        <span style="display: none;" id=groupchat{{i}}>{{ item.message }}</span>
                        <i style="float: right;" (click)="groupcopyPopover($event,i);$event.stopPropagation()"
                          class="fa fa-angle-down recentdropdown2" aria-hidden="true">
                        </i>
                      </div>
                      <div
                      *ngIf="item.forwardmsg!=null && item.forwardmsg!='null' && item.forwardmsg!='undefined' && item.forwardmsg!=currentUser"
                      style="    font-size: 13px;
                    font-style: italic;
                color: lightgray;">
                      <i class="fa fa-share" aria-hidden="true"></i> Forwarded
          
                    </div>
                      <!--Reply Tag text-->
                      <span
                        *ngIf="item.tagmessage!='' && item.tagmessage!=null && item.tagmessage!='undefined' && item.tagmessage!='null'"
                        style=" max-width: 100%; background-color: #cfe9ba;
                          width: 100%;">

                        <!-- <ion-row style="width: 100%;" > -->
                        <span *ngIf="item.replydisplayname!=null && item.replydisplayname!=undefined "
                          style="font-size: 12px;color: mediumvioletred;text-transform: capitalize"
                          [innerHTML]="item.replydisplayname | highlightPipe:searchTerms"></span>
                        <br />


                        <!-- </ion-row> -->
                        <span *ngIf="item.tagfiletype=='text'" style="max-width: 100%;white-space: pre-line !important;"
                          text-wrap [innerHTML]="item.tagmessage | highlightPipe:searchTerms"></span>


                        <!--Image file-->
                        <div
                          *ngIf="item.tagfiletype=='image' || item.tagfiletype=='JPG' || item.tagfiletype=='jpg' || item.tagfiletype=='png' || item.tagfiletype=='PNG' || item.tagfiletype=='JPEG' || item.tagfiletype=='jpeg' || item.tagfiletype=='gif' || item.tagfiletype=='GIF'">
                          <img src="{{item.tagmessage}}">
                          <br />
                        </div>
                        <!--Any document-->

                        <div>

                          <a
                            *ngIf="item.tagfiletype=='dotx' ||item.tagfiletype=='doc' || item.tagfiletype=='dot' || item.tagfiletype=='docx'">

                            <p text-wrap class="fileexten">{{item.tagfileextension}}</p>
                          </a>
                          <a
                            *ngIf="item.tagfiletype=='xls' || item.tagfiletype=='xlsx' || item.tagfiletype=='xlt'|| item.tagfiletype=='xla' ">

                            <p text-wrap class="fileexten">{{item.tagfileextension}}</p>
                          </a>

                          <a *ngIf="item.tagfiletype=='txt' || item.tagfiletype=='TXT'">

                            <p text-wrap class="fileexten">{{item.tagfileextension}}</p>
                          </a>

                          <a *ngIf="item.tagfiletype=='pdf' || item.tagfiletype=='PDF'">

                            <p text-wrap class="fileexten">{{item.tagfileextension}}</p>
                          </a>
                          <a
                            *ngIf="item.tagfiletype=='pps' || item.tagfiletype=='ppa'  || item.tagfiletype=='pptx' || item.tagfiletype=='potx'">

                            <p text-wrap class="fileexten">{{item.tagfileextension}}</p>
                          </a>

                        </div>


                        <!--Location-->
                        <a *ngIf="item.Taglocation=='true'">
                          <img
                            src="{{getMap}}center={{item.latitude}}&zoom=18&size=300x300&markers=color:red%7Clabel:S%7C{{item.latitude}}">
                        </a>

                        <!--Audio file-->
                        <audio *ngIf="item.tagfiletype=='audio' || item.tagfiletype=='mp3'" controls
                          controlsList="nodownload">
                          <source [src]="sanitizer.bypassSecurityTrustUrl(item.tagmessage)" type="audio/ogg">
                          <source [src]="sanitizer.bypassSecurityTrustUrl(item.tagmessage)" type="audio/mpeg">
                        </audio>
                        <!--Video file-->
                        <video *ngIf="item.tagfiletype=='mp4' || item.tagfiletype=='avi' || item.tagfiletype=='flv'"
                          width="200" preload="none" height="125" controls controlsList="nodownload">
                          <source [src]="sanitizer.bypassSecurityTrustUrl(item.tagmessage)" type="video/mp4">
                          <source [src]="sanitizer.bypassSecurityTrustUrl(item.tagmessage)" type="video/ogg">
                        </video>

                        <p class="stable singleTick" style="margin-bottom: 10px;margin-top: -12px;">
                          {{item.tagtime | date: "hh:mm a"  }} </p>

                      </span>
                      <div>
                        <ion-row style="width: 100%;" *ngIf="item.sendername!=null && item.sendername!=undefined ">
                          <span style="color: mediumvioletred;text-transform: capitalize;font-size: 12px;"
                            [innerHTML]="item.sendername | highlightPipe:searchTerms"></span>
                        </ion-row>

                        <!-- <span *ngIf="item.filetype=='text' && item.message!=''"
                            style="white-space: pre-line !important;color: black;margin-right: 15px;" text-wrap
                            [innerHTML]="item.message | highlightPipe:searchTerms"></span> -->

                        <span id=groupfrendtext{{i}} *ngIf="!item.showMore && item.filetype=='text' && item.message!=''"
                          style="max-width: 100%;white-space: pre-line !important;color: black;margin-right: 15px;"
                          text-wrap [innerHTML]="trimString(item.message,150)| highlightPipe:searchTerms"></span>

                        <!-- </div> -->
                        <!-- <div *ngIf="item.showMore"> -->

                        <span *ngIf=" item.showMore && item.filetype=='text' && item.message!=''"
                          style="max-width: 100%;white-space: pre-line !important;color: black;margin-right: 15px;"
                          text-wrap [innerHTML]="item.message | highlightPipe:searchTerms"></span>

                        <!-- </div> -->
                        <a *ngIf="item.message.length>150  &&item.filetype=='text'"
                          style="max-width: 100%;color: #039be5;cursor: pointer;font-size: 14px;"
                          (click)="item.showMore = !item.showMore">Read <span
                            [innerHtml]="item.showMore ? 'less' : 'More'">
                          </span>
                        </a>


                        <!-- mom -->
                        <span style="max-width: 100%;" *ngIf="item.filetype == 'mom'"
                          [innerHTML]="item.message | highlightPipe:searchTerms"></span>

                        <div
                          *ngIf="item.filetype=='image' || item.filetype=='JPG' || item.filetype=='jpg' || item.filetype=='png' || item.filetype=='PNG' || item.filetype=='JPEG' || item.filetype=='jpeg' || item.filetype=='gif' || item.filetype=='GIF'">

                          <img style="object-fit: cover;width:245px;height:245px;margin-bottom: 10px;"
                            [src]="sanitizer.bypassSecurityTrustUrl(item.message)"
                            *ngIf="item.filetype=='image' || item.filetype=='JPG' || item.filetype=='jpg' || item.filetype=='png' || item.filetype=='PNG' || item.filetype=='JPEG' || item.filetype=='jpeg' || item.filetype=='gif' || item.filetype=='GIF'"
                            (click)="groupZoomFile(item.message)">

                          <br />
                        </div>
                        <!--Doc format-->
                        <a *ngIf="item.filetype=='dotx' ||item.filetype=='doc' || item.filetype=='dot' || item.filetype=='docx'"
                          (click)="groupgetPermission(item.message,item.fileextension,item.filetype)">
                          <img style="height:35px;" src="assets/imgs/wordDoc.png">
                          <ion-icon class="downloadarrowdropdown" name="arrow-down-circle-outline"></ion-icon>
                          <h6 text-wrap class="fileexten">{{item.fileextension}}</h6>
                        </a>

                        <!--XLS format-->
                        <div
                          *ngIf="item.filetype=='xls' || item.filetype=='xlsx' || item.filetype=='xlt'|| item.filetype=='xla'"
                          (click)="groupgetPermission(item.message,item.fileextension,item.filetype)">
                          <img style="height:35px;" src="assets/imgs/excelDoc.png">
                          <ion-icon class="downloadarrowdropdown" name="arrow-down-circle-outline"></ion-icon>
                          <h6 text-wrap class="fileexten">{{item.fileextension}}</h6>
                        </div>
                        <!--PDF Format-->
                        <div *ngIf="item.filetype=='pdf' || item.filetype=='PDF'"
                          (click)="groupgetPermission(item.message,item.fileextension,item.filetype)">
                          <img style="height:35px;" src="assets/imgs/pdfDoc.png">
                          <ion-icon class="downloadarrowdropdown" name="arrow-down-circle-outline"></ion-icon>
                          <h6 text-wrap class="fileexten">{{item.fileextension}}</h6>
                        </div>

                        <!--Txt Format-->
                        <a *ngIf="item.filetype=='txt' || item.filetype=='TXT'"
                          (click)="groupgetPermission(item.message,item.fileextension,item.filetype)">
                          <img style="height:35px;" src="assets/imgs/txtFormat.png">
                          <ion-icon class="downloadarrowdropdown" name="arrow-down-circle-outline"></ion-icon>
                          <span text-wrap class="fileexten">{{item.fileextension}}</span>
                        </a>

                        <!--PPT format-->
                        <a *ngIf="item.filetype=='pps' || item.filetype=='ppa'  || item.filetype=='pptx' || item.filetype=='potx'"
                          (click)="groupgetPermission(item.message,item.fileextension,item.filetype)">
                          <img style="height:35px;" src="assets/imgs/ppt.png">
                          <ion-icon class="downloadarrowdropdown" name="arrow-down-circle-outline"></ion-icon>
                          <h6 text-wrap class="fileexten">{{item.fileextension}}</h6>
                        </a>

                        <!--google location file-->
                        <a *ngIf="item.filetype=='map'" (click)='groupMappopover(item.message)'>
                          <img
                            src="{{getMap}}center={{latitude}}&zoom=18&size=300x300&markers=color:red%7Clabel:S%7C{{item.message}}">
                        </a>

                        <p *ngIf="item.filetype=='map live'"
                          (click)="groupliveLocation(item.groupkey,item.groupkey,item.sendername)">
                          <img style="width: 100% !important;"
                            src="{{getMap}}center={{latitude}}&zoom=18&size=300x300&markers=color:red%7Clabel:S%7C{{item.message}}">

                        </p>
                        <!-- <p *ngIf="item.livelocation=='false' || item.livelocation==false"
                          style="font-size: 14px;text-align:center;height: 0px;color: #b3aea8;">Live Location Ended</p> -->

                        <!-- <button
                          *ngIf="item.filetype=='map live' && item.livelocation=='true' || item.livelocation==true"
                          style="width: 100%;background: #ff656c !important;
                          color: white;" ion-button full
                          (click)="groupliveLocation(item.groupkey,item.groupkey,item.sendername)">
                          <ion-icon style="position: relative;
                            top: 3px;" name="navigate-outline"></ion-icon>&nbsp;live location
                        </button> -->



                        <!-- <br/> -->

                        <!--Audio file-->
                        <audio *ngIf="item.filetype=='audio' || item.filetype=='mp3'" controls
                          controlsList="nodownload">

                          <source [src]="sanitizer.bypassSecurityTrustUrl(item.message)" type="audio/ogg">
                          <source [src]="sanitizer.bypassSecurityTrustUrl(item.message)" type="audio/mpeg">
                        </audio>


                        <!--Video file-->
                        <div></div>
                        <video *ngIf="item.filetype=='mp4' || item.filetype=='avi' || item.filetype=='flv'" width="200"
                          height="125" preload="none" controls controlsList="nodownload">
                          <source [src]="sanitizer.bypassSecurityTrustUrl(item.message)" type="video/mp4">
                          <source [src]="sanitizer.bypassSecurityTrustUrl(item.message)" type="video/ogg">

                        </video>

                        <span *ngIf=" !item.showMore  &&  item.attachtext!='null' && item.attachtext!=null && item.attachtext!=''"
                          style="max-width: 100%;white-space: pre-line !important;color: black;margin-right: 15px;"
                          text-wrap [innerHTML]="trimString(item.attachtext,150)| highlightPipe:searchTerms"></span>

                        <!-- </div> -->
                        <!-- <div *ngIf="item.showMore"> -->

                        <span *ngIf="item.showMore && item.attachtext!='null' && item.attachtext!=null && item.attachtext!='' && hidetext(item)"
                          style="max-width: 100%;white-space: pre-line !important;color: black;" text-wrap
                          [innerHTML]="item.attachtext| highlightPipe:searchTerms"></span>

                        <!-- </div> -->
                        <a *ngIf="item.attachtext!=null && item.attachtext!='null'  && item.attachtext.length>150 "
                          style="max-width: 100%;color: #039be5;cursor: pointer;font-size: 14px;"
                          (click)="item.showMore = !item.showMore">Read<span
                            [innerHtml]="item.showMore ? 'less' : 'More'">
                          </span>
                        </a>

                        <div>
                          <span class="time" text-right>
                            {{item.timestamp | date: "hh:mm a"  }}
                            <!--| lowercase-->
                          </span>
                        </div>

                      </div>
                    </div>
                  </ion-col>
                  <!--me-->
                  <ion-col offset="3" size="9" *ngIf="item.sentby === Uid && item.filetype!='title'"
                    class="message my-message">
                    <div class="chatbubble-right">
                      <!-- {{ item.message }} -->

                      <div>
                        <span style="display: none;" id=groupchat{{i}}>{{ item.message }}</span>
                        <i style="float: right;" (click)="groupcopyPopover($event,i);$event.stopPropagation()"
                          class="fa fa-angle-down recentdropdown1" aria-hidden="true">
                        </i>
                      </div>

                      <!-- <span style="color: mediumvioletred;text-transform: capitalize">{{item.sendername}}</span> -->
                      <span *ngIf="item.filetype == 'mom'"
                        [innerHTML]="item.message | highlightPipe:searchTerms"></span>

                        <div
                        *ngIf="item.forwardmsg!=null && item.forwardmsg!='null' && item.forwardmsg!='undefined' && item.forwardmsg!=currentUser"
                        style="    font-size: 13px;
                      font-style: italic;
                  color: lightgray;">
                        <i class="fa fa-share" aria-hidden="true"></i> Forwarded
            
                      </div>
                      
                      <!--Reply Tag text-->
                      <span
                        *ngIf="item.tagmessage!='' && item.tagmessage!=null && item.tagmessage!='undefined' && item.tagmessage!='null'"
                        style=" background-color: #cfe9ba;
                          width: 100%;">

                        <span style="color: mediumvioletred;text-transform: capitalize"
                          [innerHTML]="item.replydisplayname | highlightPipe:searchTerms"></span><br />

                        <span *ngIf="item.tagfiletype=='text'" style="max-width: 100%;white-space: pre-line !important;"
                          text-wrap [innerHTML]="item.tagmessage | highlightPipe:searchTerms"></span>

                        <!--Image file-->
                        <div
                          *ngIf="item.tagfiletype=='image' || item.tagfiletype=='JPG' || item.tagfiletype=='jpg' || item.tagfiletype=='png' || item.tagfiletype=='PNG' || item.tagfiletype=='JPEG' || item.tagfiletype=='jpeg' || item.tagfiletype=='gif' || item.tagfiletype=='GIF'">
                          <img src="{{item.tagmessage}}">
                          <br />
                        </div>
                        <!--Any document-->

                        <div>

                          <a
                            *ngIf="item.tagfiletype=='dotx' ||item.tagfiletype=='doc' || item.tagfiletype=='dot' || item.tagfiletype=='docx'">

                            <p text-wrap class="fileexten">{{item.tagfileextension}}</p>
                          </a>
                          <a
                            *ngIf="item.tagfiletype=='xls' || item.tagfiletype=='xlsx' || item.tagfiletype=='xlt'|| item.tagfiletype=='xla' ">

                            <p text-wrap class="fileexten">{{item.tagfileextension}}</p>
                          </a>

                          <a *ngIf="item.tagfiletype=='txt' || item.tagfiletype=='TXT'">

                            <p text-wrap class="fileexten">{{item.tagfileextension}}</p>
                          </a>

                          <a *ngIf="item.tagfiletype=='pdf' || item.tagfiletype=='PDF'">

                            <p text-wrap class="fileexten">{{item.tagfileextension}}</p>
                          </a>
                          <a
                            *ngIf="item.tagfiletype=='pps' || item.tagfiletype=='ppa'  || item.tagfiletype=='pptx' || item.tagfiletype=='potx'">

                            <p text-wrap class="fileexten">{{item.tagfileextension}}</p>
                          </a>

                        </div>


                        <!--Location-->
                        <a *ngIf="item.Taglocation=='true'">
                          <img
                            src="{{getMap}}center={{item.latitude}}&zoom=18&size=300x300&markers=color:red%7Clabel:S%7C{{item.latitude}}">
                        </a>

                        <!--Audio file-->
                        <audio *ngIf="item.tagfiletype=='audio' || item.tagfiletype=='mp3'" controls
                          controlsList="nodownload">
                          <source [src]="sanitizer.bypassSecurityTrustUrl(item.tagmessage)" type="audio/ogg">
                          <source [src]="sanitizer.bypassSecurityTrustUrl(item.tagmessage)" type="audio/mpeg">
                        </audio>
                        <!--Video file-->
                        <video *ngIf="item.tagfiletype=='mp4' || item.tagfiletype=='avi' || item.tagfiletype=='flv'"
                          width="200" preload="none" height="125" controls controlsList="nodownload">
                          <source [src]="sanitizer.bypassSecurityTrustUrl(item.tagmessage)" type="video/mp4">
                          <source [src]="sanitizer.bypassSecurityTrustUrl(item.tagmessage)" type="video/ogg">
                        </video>

                        <p class="stable singleTick">{{item.tagtime | date: "hh:mm a"  }} </p>
                        <h6></h6>
                      </span>
                      <div>


                        <!-- <span *ngIf="item.filetype=='text' && item.message!=''"
                            style="white-space: pre-line !important;color: black;" text-wrap
                            [innerHTML]="item.message | highlightPipe:searchTerms"></span> -->

                        <!-- {{item.message}} -->
                        <span id=groupmytext{{i}} *ngIf="!item.showMore && item.filetype=='text' && item.message!=''"
                          style="max-width: 100%;white-space: pre-line !important;color: black;margin-right: 15px;"
                          text-wrap [innerHTML]="trimString(item.message,150)| highlightPipe:searchTerms"></span>


                        <!-- </div> -->
                        <!-- <div *ngIf="item.showMore"> -->

                        <span *ngIf="item.showMore && item.filetype=='text' && item.message!=''"
                          style="max-width: 100%;white-space: pre-line !important;color: black;" text-wrap
                          [innerHTML]="item.message | highlightPipe:searchTerms"></span>


                        <!-- </div> -->
                        <a *ngIf="item.message.length>150  && item.filetype=='text'"
                          style="max-width: 100%;color: #039be5;cursor: pointer;font-size: 14px;"
                          (click)="item.showMore = !item.showMore">Read<span
                            [innerHtml]="item.showMore ? 'less' : 'More'">
                          </span>
                        </a>

                        <div
                          *ngIf="item.filetype=='image' || item.filetype=='JPG' || item.filetype=='jpg' || item.filetype=='png' || item.filetype=='PNG' || item.filetype=='JPEG' || item.filetype=='jpeg' || item.filetype=='gif' || item.filetype=='GIF'">

                          <img style="object-fit: cover;width:245px;height:245px;margin-bottom: 10px;"
                            [src]="sanitizer.bypassSecurityTrustUrl(item.message)"
                            *ngIf="item.filetype=='image' || item.filetype=='JPG' || item.filetype=='jpg' || item.filetype=='png' || item.filetype=='PNG' || item.filetype=='JPEG' || item.filetype=='jpeg' || item.filetype=='gif' || item.filetype=='GIF'"
                            (click)="groupZoomFile(item.message)">
                          <br />
                        </div>

                        <!--Doc format-->
                        <a *ngIf="item.filetype=='dotx' ||item.filetype=='doc' || item.filetype=='dot' || item.filetype=='docx'"
                          (click)="groupgetPermission(item.message,item.fileextension,item.filetype)">
                          <img style="height:35px;" src="assets/imgs/wordDoc.png">
                          <ion-icon class="downloadarrowdropdown" name="arrow-down-circle-outline"></ion-icon>
                          <h6 text-wrap class="fileexten">{{item.fileextension}}</h6>
                        </a>

                        <!--XLS format-->
                        <div
                          *ngIf="item.filetype=='xls' || item.filetype=='xlsx' || item.filetype=='xlt'|| item.filetype=='xla'"
                          (click)="groupgetPermission(item.message,item.fileextension,item.filetype)">
                          <img style="height:35px;" src="assets/imgs/excelDoc.png">
                          <ion-icon class="downloadarrowdropdown" name="arrow-down-circle-outline"></ion-icon>
                          <h6 text-wrap class="fileexten">{{item.fileextension}}</h6>
                        </div>
                        <!--PDF Format-->
                        <div *ngIf="item.filetype=='pdf' || item.filetype=='PDF'"
                          (click)="groupgetPermission(item.message,item.fileextension,item.filetype)">
                          <img style="height:35px;" src="assets/imgs/pdfDoc.png">
                          <ion-icon class="downloadarrowdropdown" name="arrow-down-circle-outline"></ion-icon>
                          <h6 text-wrap class="fileexten">{{item.fileextension}}</h6>
                        </div>

                        <!--Txt Format-->
                        <a *ngIf="item.filetype=='txt' || item.filetype=='TXT'"
                          (click)="groupgetPermission(item.message,item.fileextension,item.filetype)">
                          <img style="height:35px;" src="assets/imgs/txtFormat.png">
                          <ion-icon class="downloadarrowdropdown" name="arrow-down-circle-outline"></ion-icon>
                          <span text-wrap class="fileexten">{{item.fileextension}}</span>
                        </a>

                        <!--PPT format-->
                        <a *ngIf="item.filetype=='pps' || item.filetype=='ppa'  || item.filetype=='pptx' || item.filetype=='potx'"
                          (click)="groupgetPermission(item.message,item.fileextension,item.filetype)">
                          <img style="height:35px;" src="assets/imgs/ppt.png">
                          <ion-icon class="downloadarrowdropdown" name="arrow-down-circle-outline"></ion-icon>
                          <h6 text-wrap class="fileexten">{{item.fileextension}}</h6>
                        </a>

                        <!--google location file-->
                        <!-- <a *ngIf="item.filetype=='map'" (click)='Mappopover(item.message)'>
                            <img
                              src="{{getMap}}center={{latitude}}&zoom=18&size=300x300&markers=color:red%7Clabel:S%7C{{item.message}}">
                          </a> -->
                        <!--google location file-->
                        <a *ngIf="item.filetype=='map'" (click)='groupMappopover(item.message)'>
                          <img style="width: 100% !important;"
                            src="{{getMap}}center={{latitude}}&zoom=18&size=300x300&markers=color:red%7Clabel:S%7C{{item.message}}">
                        </a>
                        <p *ngIf="item.filetype=='map live'"
                          (click)="groupliveLocation(item.groupkey,item.groupkey,item.sendername)">
                          <img style="width: 100% !important;"
                            src="{{getMap}}center={{latitude}}&zoom=18&size=300x300&markers=color:red%7Clabel:S%7C{{item.message}}">

                        </p>
                        <!-- <p *ngIf="item.livelocation=='false' || item.livelocation==false"
                          style="font-size: 14px;text-align:center;height: 0px;color: #b3aea8;">Live Location Ended</p> -->

                        <div *ngIf="item.filetype=='map live' && item.livelocation=='true' || item.livelocation==true">
                          <!-- <button style="width: 50%;min-height: 25px;border-radius: 10px;background: #ff656c !important;
                              color: white;" ion-button full
                            (click)="groupstopLocation(item.message,item.timestamp,item.sentby)">
                            <ion-icon style="position: relative;
                                top: 3px;" name="stop-circle-outline"></ion-icon>&nbsp;Stop Live
                          </button> -->
                          <!-- <button *ngIf="item.filetype=='map live'" style="    border-radius: 10px;
                              width: 47%;min-height: 25px;
                              background: #0c84b4 !important;
                              color: white;
                              margin-left: 5px;" ion-button full
                            (click)="groupliveLocation(item.groupkey,item.groupkey,item.sendername)">
                            <ion-icon style="position: relative;
                                top: 3px;" name="navigate-outline"></ion-icon>&nbsp;View Live
                          </button> -->
                          <br />
                        </div>

                        <!-- <br/> -->

                        <!--Audio file-->
                        <audio *ngIf="item.filetype=='audio' || item.filetype=='mp3'" controls
                          controlsList="nodownload">

                          <source [src]="sanitizer.bypassSecurityTrustUrl(item.message)" type="audio/ogg">
                          <source [src]="sanitizer.bypassSecurityTrustUrl(item.message)" type="audio/mpeg">
                        </audio>


                        <!--Video file-->
                        <video *ngIf="item.filetype=='mp4' || item.filetype=='avi' || item.filetype=='flv'" width="200"
                          height="125" preload="none" controls controlsList="nodownload">
                          <source [src]="sanitizer.bypassSecurityTrustUrl(item.message)" type="video/mp4">
                          <source [src]="sanitizer.bypassSecurityTrustUrl(item.message)" type="video/ogg">

                        </video>


                        <span *ngIf=" !item.showMore && item.attachtext!='null' && item.attachtext!=null && item.attachtext!=''"
                          style="max-width: 100%;white-space: pre-line !important;color: black;margin-right: 15px;"
                          text-wrap [innerHTML]="trimString(item.attachtext,150)| highlightPipe:searchTerms"></span>

                        <!-- </div> -->
                        <!-- <div *ngIf="item.showMore"> -->

                        <span *ngIf="item.showMore && item.attachtext!='null' && item.attachtext!=null && item.attachtext!='' && hidetext(item)"
                          style="max-width: 100%;white-space: pre-line !important;color: black;" text-wrap
                          [innerHTML]="item.attachtext| highlightPipe:searchTerms"></span>

                        <!-- </div> -->
                        <a *ngIf="item.attachtext!=null && item.attachtext!='null' && item.attachtext.length>150 "
                          style="max-width: 100%;color: #039be5;cursor: pointer;font-size: 14px;"
                          (click)="item.showMore = !item.showMore">Read<span
                            [innerHtml]="item.showMore ? 'less' : 'More'">
                          </span>
                        </a>


                        <!-- <span class="time" text-right><br> -->
                        <!-- <ion-icon name="code" class="task-assigned" *ngIf='item.message_details.taskstatus=="1"'></ion-icon>
                          <ion-icon name="code" class="task-reopened" *ngIf='item.message_details.taskstatus=="2"'></ion-icon>
                          <ion-icon name="code" class="task-completed" *ngIf='item.message_details.taskstatus=="4"'></ion-icon>
                          <ion-icon name="checkmark" class="task-completed" *ngIf='item.message_details.taskstatus=="5"'></ion-icon>
                          <ion-icon name="code" class="task-accepted" *ngIf='item.message_details.taskstatus=="3"'></ion-icon> -->
                        <!-- {{ item.timestamp | date:'shortTime' }} -->

                        <!--Document's-->

                        <span class="time" text-right style="float:right;right:7px;"
                          *ngIf="item.status=='0' && item.message!='' && (item.filetype=='pptx' || item.filetype=='ppa' || item.filetype=='pps' || item.filetype=='xlsx' || item.filetype=='xls' || item.filetype=='PDF' || item.filetype=='pdf' || item.filetype=='dotx' ||item.filetype=='doc' || item.filetype=='dot' || item.filetype=='docx')"
                          class="stable singleTick">{{item.timestamp | date: "hh:mm a"  }}<span
                            style="color: gray !important;">
                            <span data-testid="msg-time" aria-label=" Pending " data-icon="msg-time" class="">
                              <img style="width:10px;height:10px;" src="assets/imgs/graybullet.png">
                              <img style="width:10px;height:10px;" src="assets/imgs/graybullet.png">
                            </span>

                          </span></span>
                        <span class="time" text-right style="float:right;right:7px;"
                          *ngIf="item.status=='1' && item.message!='' && (item.filetype=='pptx' || item.filetype=='ppa' || item.filetype=='pps' || item.filetype=='xlsx' || item.filetype=='xls' || item.filetype=='PDF' || item.filetype=='pdf' || item.filetype=='dotx' ||item.filetype=='doc' || item.filetype=='dot' || item.filetype=='docx')"
                          class="stable singleTick">{{item.timestamp | date: "hh:mm a"  }} <span
                            style="color: gray !important;">
                            <span data-testid="msg-check" aria-label=" Sent " data-icon="msg-check" class="">
                              <img style="width:10px;height:10px;" src="assets/imgs/blackbullet.png">
                              <img style="width:10px;height:10px;" src="assets/imgs/blackbullet.png">
                            </span>

                          </span></span>
                        <span class="time" text-right style="float:right;right:7px;"
                          *ngIf="item.status=='2' && item.message!='' && (item.filetype=='pptx' || item.filetype=='ppa' || item.filetype=='pps' || item.filetype=='xlsx' || item.filetype=='xls' || item.filetype=='PDF' || item.filetype=='pdf' || item.filetype=='dotx' ||item.filetype=='doc' || item.filetype=='dot' || item.filetype=='docx')"
                          class="stable singleTick">{{item.timestamp | date: "hh:mm a"  }} <span
                            style="color: #4fc3f7 !important; ">
                            <span data-testid="msg-dblcheck" aria-label=" Read " data-icon="msg-dblcheck"
                              class="_3xkAl">
                              <img style="width:10px;height:10px;" src="assets/imgs/greenbullet.png">
                              <img style="width:10px;height:10px;" src="assets/imgs/greenbullet.png">
                            </span>

                          </span></span>

                        <!--Chat status tick-->

                        <span class="time" text-right style="float:right;right:7px;"
                          *ngIf="item.status=='0' && item.message!='' && (item.filetype=='mp4' || item.filetype=='avi' || item.filetype=='flv' || item.filetype=='mp3' || item.filetype=='audio' || item.location=='true' || item.filetype=='image' || item.filetype=='JPG' || item.filetype=='jpg' || item.filetype=='png' || item.filetype=='PNG' || item.filetype=='JPEG' || item.filetype=='jpeg' || item.filetype=='gif' || item.filetype=='GIF')"
                          class="stable singleTick">{{item.timestamp | date: "hh:mm a"  }} <span
                            style="color: gray !important;">
                            <span data-testid="msg-time" aria-label=" Pending " data-icon="msg-time" class="">
                              <img style="width:10px;height:10px;" src="assets/imgs/graybullet.png">
                              <img style="width:10px;height:10px;" src="assets/imgs/graybullet.png">
                            </span>

                          </span></span>
                        <span class="time" text-right style="float:right;right:7px;"
                          *ngIf="item.status=='1' && item.message!='' && (item.filetype=='mp4' || item.filetype=='avi' || item.filetype=='flv' ||  item.filetype=='mp3' || item.filetype=='audio' || item.location=='true' || item.filetype=='image' || item.filetype=='JPG' || item.filetype=='jpg' || item.filetype=='png' || item.filetype=='PNG' || item.filetype=='JPEG' || item.filetype=='jpeg' || item.filetype=='gif' || item.filetype=='GIF')"
                          class="stable singleTick">{{item.timestamp | date: "hh:mm a"  }} <span
                            style="color: gray !important;">
                            <span data-testid="msg-check" aria-label=" Sent " data-icon="msg-check" class="">
                              <img style="width:10px;height:10px;" src="assets/imgs/blackbullet.png">
                              <img style="width:10px;height:10px;" src="assets/imgs/blackbullet.png">
                            </span>

                          </span></span>
                        <span class="time" text-right style="float:right;right:7px;"
                          *ngIf="item.status=='2' && item.message!='' && (item.filetype=='mp4' || item.filetype=='avi' || item.filetype=='flv' || item.filetype=='mp3' || item.filetype=='audio' || item.location=='true'  || item.filetype=='image' || item.filetype=='JPG' || item.filetype=='jpg' || item.filetype=='png' || item.filetype=='PNG' || item.filetype=='JPEG' || item.filetype=='jpeg' || item.filetype=='gif' || item.filetype=='GIF')"
                          class="stable singleTick">{{item.timestamp | date: "hh:mm a"  }} <span
                            style="color: #4fc3f7 !important; ">
                            <span data-testid="msg-dblcheck" aria-label=" Read " data-icon="msg-dblcheck"
                              class="_3xkAl">
                              <img style="width:10px;height:10px;" src="assets/imgs/greenbullet.png">
                              <img style="width:10px;height:10px;" src="assets/imgs/greenbullet.png">
                            </span>

                          </span></span>

                        <!--Text ststus-->
                        <span class="time" text-right style="float:right"
                          *ngIf="item.status=='0' && item.message!='' && item.filetype!='mp4' && item.filetype!='avi' && item.filetype!='flv' && item.filetype!='mp3'  && item.filetype!='audio' && item.location!='true' && item.livelocation!='true' && item.filetype!='pptx' && item.filetype!='ppa' && item.filetype!='pps' && item.filetype!='xlsx' && item.filetype!='xls' && item.filetype!='PDF' && item.filetype!='pdf' && item.filetype!='dotx' && item.filetype!='doc' && item.filetype!='dot' && item.filetype!='docx' && item.filetype!='image' && item.filetype!='JPG' && item.filetype!='jpg' && item.filetype!='png' && item.filetype!='PNG' && item.filetype!='JPEG' && item.filetype!='jpeg' && item.filetype!='gif' && item.filetype!='GIF'"
                          class="stable singleTick">{{item.timestamp | date: "hh:mm a"  }}
                          <span data-testid="msg-time" aria-label=" Pending " data-icon="msg-time" class="">
                            <img style="width:10px;height:10px;" src="assets/imgs/graybullet.png">
                            <img style="width:10px;height:10px;" src="assets/imgs/graybullet.png">
                          </span>

                        </span>
                        <span text-right
                          *ngIf="item.status=='1' && item.message!='' && item.filetype!='mp4' && item.filetype!='avi' && item.filetype!='flv' &&  item.filetype!='mp3' && item.filetype!='audio' && item.location!='true' && item.livelocation!='true' && item.filetype!='pptx' && item.filetype!='ppa' && item.filetype!='pps' && item.filetype!='xlsx' && item.filetype!='xls' && item.filetype!='PDF' && item.filetype!='pdf' && item.filetype!='dotx' && item.filetype!='doc' && item.filetype!='dot' && item.filetype!='docx' && item.filetype!='image' && item.filetype!='JPG' && item.filetype!='jpg' && item.filetype!='png' && item.filetype!='PNG' && item.filetype!='JPEG' && item.filetype!='jpeg' && item.filetype!='gif' && item.filetype!='GIF'"
                          class="stable singleTick">{{item.timestamp | date: "hh:mm a"  }} <span
                            style="color: gray !important;">
                            <span data-testid="msg-check" aria-label=" Sent " data-icon="msg-check" class="">
                              <img style="width:10px;height:10px;" src="assets/imgs/blackbullet.png">
                              <img style="width:10px;height:10px;" src="assets/imgs/blackbullet.png">
                            </span>

                          </span></span>
                        <span class="time" text-right style="float:right"
                          *ngIf="item.status=='2' && item.message!='' && item.filetype!='mp4' && item.filetype!='avi' && item.filetype!='flv' && item.filetype!='mp3' && item.filetype!='audio' && item.location!='true' && item.livelocation!='true' && item.filetype!='pptx' && item.filetype!='ppa' && item.filetype!='pps' && item.filetype!='xlsx' && item.filetype!='xls' && item.filetype!='PDF' && item.filetype!='pdf' && item.filetype!='dotx' && item.filetype!='doc' && item.filetype!='dot' && item.filetype!='docx' && item.filetype!='image' && item.filetype!='JPG' && item.filetype!='jpg' && item.filetype!='png' && item.filetype!='PNG' && item.filetype!='JPEG' && item.filetype!='jpeg' && item.filetype!='gif' && item.filetype!='GIF'"
                          class="stable singleTick">{{item.timestamp | date: "hh:mm a"  }}
                          <span style="color: #4fc3f7 !important;">
                            <span data-testid="msg-dblcheck" aria-label=" Read " data-icon="msg-dblcheck"
                              class="_3xkAl">
                              <img style="width:10px;height:10px;" src="assets/imgs/greenbullet.png">
                              <img style="width:10px;height:10px;" src="assets/imgs/greenbullet.png">
                            </span>

                          </span></span>
                      </div>
                      
                    </div>
                   
                  </ion-col>


                  <ion-col size="9" *ngIf="item.sentby !== Uid&&item.messagetype=='event'" class="message my-message">
                    <p class="chatbubble-left">
                      <span>
                        <ion-icon class="calendar" name="calendar"></ion-icon> <br>
                      </span>


                      <span class="eventmsg">{{ item.message }}</span><br> <span class="invitebtn"
                        (click)="save_event(item.message,item)">Accept & Save</span><span class="time"
                        text-right><br>{{ item.timestamp | date:'shortTime' }}</span></p>
                  </ion-col>

                  <ion-col offset="3" size="9" *ngIf="item.sentby === Uid&&item.messagetype=='event'"
                    style="margin-left: 0 !important;" class="message my-message">
                    <p class="chatbubble-right">
                      <span>
                        <ion-icon class="calendar" name="calendar"></ion-icon> <br>
                      </span>
                      <span class="eventmsg">{{ item.message }}</span> <span class="time"
                        text-right><br>{{ item.timestamp | date:'shortTime' }}</span></p>
                  </ion-col>

                </ion-row>
              </ion-grid>
            </div>

          </div>
        </div>
        <ion-footer *ngIf="!isRemoved" class="ion-no-border">
          <!-- {{showpopGroup1}} -->
          <input type="file" id="imguploadgal" style="display:none" (change)="grouponUploadChange($event)" />

          <input type="file" id="imgupload1" style="display:none" (change)="grouponUploadChange($event)" />
          <div *ngIf="groupmembersinlist" style="position:relative;width:99.2%;overflow:auto;">

            <ion-searchbar       id="stay-cancel"
            (input)="searchuser1($event)"   (ionCancel)="onCancel4($event)" (ionClear)="onCancel4($event)"  placeholder="Search">
            </ion-searchbar>

            <ion-list no-lines style="--background:#eeeeee !important;padding-top:0px;padding-bottom:0px;bottom:0;width: 100%;height:200px;overflow:auto;" lines="none">

              <ion-item class="grouplist" (click)="grouplistclick(item.username)" *ngFor="let item of groupmembers2"
                style="--background:#eeeeee;opacity:0.7;" lines="none">
                <ion-avatar slot="start">
                  <img *ngIf="item.photourl!='default'" src={{item.photourl}}>
                  <img *ngIf="item.photourl=='default'" src='assets/imgs/chatterplace.png'>
                </ion-avatar>
                <ion-label style="font-size:14px">
                  <h2 style="text-transform: capitalize" [ngStyle]="{'color': colorCode}">{{item.username}}</h2>
                  <!-- <h3 style="text-transform: capitalize;font-size: 12px;">{{item.designation}}</h3> -->

                </ion-label>



              </ion-item>
            </ion-list>



          </div>
          <div [class.show]="titleStyle" *ngIf="showpopGroup1==true" class="popoverdiv">
            <ion-row style="float: right;" (click)="groupclosePopover()">
              <ion-icon name="close-circle" class="popclose"></ion-icon>

              <!-- <img src="assets/closeIcon.png" style="height:22px;position:absolute;right:57px;" (click)="closePopover()"> -->
            </ion-row>
            <ion-row>
              <ion-col col-3>
                <!-- <img src='assets/imgs/camera.png' *ngIf="!mobileicon" class="chatpop" (click)="webcamera()" /> -->
                <img src='assets/imgs/camera.png' title="Camera" class="chatpop" (click)="webcameragroup()" />

              </ion-col>
              <ion-col col-3>
                <input type="file" id="imguploadgal" style="display:none" (change)="grouponUploadChange($event)" />
                <img src='assets/imgs/gallery.jpg' class="chatpop"
                  onclick="$('#imguploadgal').trigger('click'); return false;" />

              </ion-col>
              <ion-col col-3>
                <input type="file" id="imgupload1" style="display:none" (change)="grouponUploadChange($event)" />
                <img src='assets/imgs/document.png' class="chatpop"
                  onclick="$('#imgupload1').trigger('click'); return false;" />

                <!-- sendPicMsg galleryPicMsg -->
              </ion-col>
              <ion-col col-3>
                <img src='assets/imgs/location.png' class="chatpop" (click)="groupaddMarker()" />

              </ion-col>
            </ion-row>
          </div>
          <div [class.show]="maptitleStyle" *ngIf="mapshowpop=='true'" class="popoverdiv">
            <ion-row style="float: right;">
              <ion-icon name="close-circle" class="popclose" (click)="groupclosePopover()"></ion-icon>
            </ion-row>
            <ion-row>
              <ion-col col-6>
                <ion-icon name="logo-chrome" style="font-size: 2.2em !important" (click)="groupopenLocation(0)"
                  class="chatpop">
                </ion-icon>
              </ion-col>

              <ion-col col-6>
                <img src='assets/imgs/location.png' class="chatpop" (click)="groupopenLocation(1)" />
              </ion-col>
            </ion-row>
          </div>
          <div *ngIf="addmessagehide" class="tagdiv">
            <div class="tagmessage">
              <ion-icon name="close" class="loginicon" title="Close" (click)="Replycancel()"></ion-icon>
              <div
                *ngIf="filetype!='image' && filetype!='JPG' && filetype!='jpg' && filetype!='png' && filetype!='PNG' && filetype!='JPEG' && filetype!='jpeg' && filetype!='gif' && filetype!='GIF' && filetype!='application' && filetype!='mp4' && filetype!='avi' && filetype!='flv' && location!=true && latitude!=true && filetype!='dotx' && filetype!='doc' && filetype!='dot' && filetype!='docx' && filetype!='xls' && filetype!='xlsx' && filetype!='xlt' && filetype!='xla' && filetype!='pdf' && filetype!='PDF' && filetype!='pps' && filetype!='ppa'  && filetype!='pptx' && filetype!='potx'"
                text-wrap>
                {{tagmessage}}</div>

              <div
                *ngIf="filetype=='image' || filetype=='JPG' || filetype=='jpg' || filetype=='png' || filetype=='PNG' || filetype=='JPEG' || filetype=='jpeg' || filetype=='gif' || filetype=='GIF'">

                <img style="width:75px;height: 64px;" [src]="sanitizer.bypassSecurityTrustUrl(tagmessage)"
                  *ngIf="filetype=='image' || filetype=='JPG' || filetype=='jpg' || filetype=='png' || filetype=='PNG' || filetype=='JPEG' || filetype=='jpeg' || filetype=='gif' || filetype=='GIF'">
                <br /></div>
              <!--Any document-->
              <img style="height:30px" src="assets/Fileticon.png" *ngIf="filetype=='application'">


              <!--Location-->
              <a *ngIf="filetype=='map'" (click)='groupMappopover(message)'>
                <img src="{{getMap}}center={{latitude}}&zoom=18&size=300x300&markers=color:red%7Clabel:S%7C{{message}}">
              </a>

              <!--Audio file-->
              <audio *ngIf="filetype=='audio' ||  filetype=='mp3'" controls>
                <source [src]="sanitizer.bypassSecurityTrustUrl(tagmessage)" type="audio/ogg">
                <source [src]="sanitizer.bypassSecurityTrustUrl(tagmessage)" type="audio/mpeg">
              </audio>
              <!--Video file-->
              <video *ngIf="filetype=='mp4' || filetype=='avi' || filetype=='flv'" width="100" height="70" controls
                preload="none">
                <source [src]="sanitizer.bypassSecurityTrustUrl(tagmessage)" type="video/mp4">
                <source [src]="sanitizer.bypassSecurityTrustUrl(tagmessage)" type="video/ogg">
              </video>

              <span
                *ngIf="filetype=='dotx' || filetype=='doc' || filetype=='dot' || filetype=='docx' || filetype=='xls' || filetype=='xlsx' || filetype=='xlt'|| filetype=='xla'|| filetype=='pdf' || filetype=='PDF' || filetype=='pps' || filetype=='ppa'  || filetype=='pptx' || filetype=='potx' || filetype=='txt' || filetype=='TXT'"
                text-wrap>{{tagfileextension}}</span>



              <!-- <div class="stable">{{tagtime | date: "hh:mm a"  }}</div> -->
            </div>
          </div>
          <ion-toolbar>

            <!-- <ion-grid>
                <ion-row>
                  <ion-col size="2" style="margin: auto;text-align: center;">
                    <ion-button (click)="popover()">
                      <ion-icon class="attachementicon" *ngIf="newMsgBtn"  name="attach"></ion-icon>
                    </ion-button>
                  </ion-col>
                  <ion-col size="8" style="padding: 0;">
                    <ion-textarea style="height: 50px;width: 100%;background: white;border-radius:5px;color:black;" [(ngModel)]="message"
                      autosize [minRows]="tarea_size_min" [maxRows]="tarea_size"></ion-textarea>
          
                      <button style="margin-top: 9px;right: 8%;" ion-button clear icon-only item-right (click)="switchEmojiPicker()">
                        <ion-icon name="md-happy"></ion-icon>
                      </button>
                      
                  </ion-col>
                  <ion-col size="2" style="margin: auto;text-align: center;">
                    <ion-button [disabled]="message === ''" class="msg-btn" (click)="sendMessage()">
                      <ion-icon slot="icon-only" class="send" name="send"></ion-icon>
                    </ion-button>
                  </ion-col>
                </ion-row>
              </ion-grid> -->

            <div *ngIf="!newMsgBtn">
              <div class="messagediv" style="height:50px;width:98%">

                <ion-grid>
                  <ion-row>
                    <ion-col size="2">
                      <img end *ngIf="!newMsgBtn" src="assets/audio_icon.gif"
                        style="height: 45px;float: left;margin-top: -9px;">

                    </ion-col>
                    <ion-col size="6">
                      <label class="listening">Listening...</label>

                    </ion-col>
                    <ion-col size="2">
                      <button class="voicecancel" end *ngIf="!newMsgBtn" ion-button clear icon-only item-right
                        (click)="groupcancelRecord()">
                        Cancel
                      </button>
                    </ion-col>
                    <ion-col size="2">

                      <button class="voicesend" end *ngIf="!newMsgBtn" ion-button clear icon-only item-right
                        (click)="groupstopRecord()">
                        Send
                      </button>
                    </ion-col>
                  </ion-row>
                </ion-grid>





              </div>

            </div>

            <div style="display: flex;">

              <div class="messagediv" *ngIf="newMsgBtn">
                <!-- <ion-icon class="attachementicon" *ngIf="newMsgBtn" (click)="popover()" name="attach"></ion-icon> -->
               
                  <ion-icon title="Emoji" class="attachementicon" width="30px"
                  (click)="switchEmojiPicker()" name="happy-outline"></ion-icon>
                  <ion-icon name="attach-outline" title="Attach" class="attachicon" style=" margin-top: 12px;   height: 30px !important;
                  border: 0;
                  width: auto;    
                  margin-right: 10px;" width="30px" (click)="grouppopover($event,item);$event.stopPropagation()"></ion-icon>
                
                <textarea #textarea2 id="newmessage" rows="1" (focus)="updateScroll()" [(ngModel)]="newmessage"
                  placeholder="Type a message" minlength="1" msd-elastic=""
                  (ngModelChange)="groupStyleChange(newmessage)"
                  class="ng-valid-minlength ng-valid-maxlength ng-dirty ng-touched ng-empty ng-invalid ng-invalid-required"
                  style="color: black;
                    border-radius: 29px;
                    display: initial;
                    overflow: auto;
                    overflow-wrap: break-word;
                    padding: 9px 32px 0px 25px;
                    margin-left: 6.3%;
                    background-color: white;
                    height: 45px;
                    /* margin-top: -4px; */
                    width: 87% !important;
                    border: none;
                    max-height: 130px;" (paste)="onPaste1($event)" (keypress)="onEnterKeyPress($event,$event.target.value)"
                  (keyup.enter)="groupsendMessage()"></textarea>

              </div>
              <ion-buttons end *ngIf="newMsgBtn" style="margin: auto;">


                <img *ngIf="newmessage" src="assets/sent.png" style="height: 35px !important;
                  margin-right: 5px;width:35px !important" title="Send"
                  (click)="groupsendMessage()">


                <img *ngIf="!newmessage" title="Mic" src="assets/mic.png"
                  style="height: 35px !important;width:35px !important;margin-right: 5px;" width="30px"
                  (click)="groupstartRecord()">

                <!-- <button  *ngIf="!newmessage"
                      style="margin-top: 12px;margin-left: 6px;width: 31px;background: #4b86c6;border-radius: 50%;" ion-button clear
                      icon-only item-right (click)="startRecord()">
                      <ion-icon style="color: white;font-size: 22px;" name="mic" color="primary"></ion-icon>
                    </button> -->

              </ion-buttons>

            </div>


            <div *ngIf="showEmojiPicker==true">
              <emoji-picker [result]="score" (onEmojiSelect)="selectEmoji1($event)"></emoji-picker>
            </div>
          </ion-toolbar>

        </ion-footer>
      </div>


    <!-- </ion-infinite-scroll-content>
  </ion-infinite-scroll> -->

    </div>



    <div *ngIf="rightmember" class="leftcontact rightalign">
      <div class="leftside">
        <header class="leftheader">
          <ion-title text-left>
            <ion-icon name="close" title="Close" class="buddyusername" (click)="closebutton()"></ion-icon>

            <span class="buddyusername" style="text-transform: capitalize; margin-left: 35px;font-size: 16px;position: relative;">Group
              Members</span><br>

          </ion-title>

        </header>


        <div class="webscreen fireboxweb">

          <ion-list no-lines>

            <ion-item *ngFor="let item of groupmembers" style="border-bottom: 1px solid lightgrey;" (click)="changeadmin($event,item,i)">
              <ion-avatar slot="start">
                <img *ngIf="item.photourl!='default'" src={{item.photourl}}>
                <img *ngIf="item.photourl=='default'" src='assets/imgs/chatterplace.png'>
              </ion-avatar>
              <ion-label>
                <h2 style="text-transform: capitalize" [ngStyle]="{'color': colorCode}">{{item.username}}</h2>
                <h3 style="text-transform: capitalize;font-size: 12px;">{{item.designation}}</h3>
                <p *ngIf="item.owner!='undefined'" style="color: lightgreen;float: right;margin-top: -19px;">Group Admin
                </p>
                <p *ngIf="group_call1 ==false && item.owner=='undefined' && owener==true">
                  <ion-icon name="close-circle" class="removeicon" style="margin-top: -19px;"
                    (click)="Deletemember(item)"></ion-icon>
                </p>
              </ion-label>


              <ion-checkbox *ngIf="group_call1 ==true" color="dark" id={{item.uid}} (ionChange)="change(item)"
                [(ngModel)]="item.selected" item-right>
              </ion-checkbox>



            </ion-item>
          </ion-list>

        </div>
      </div>
    </div>




  </div>

</ion-content>